!function n(a,i,o){function s(e,t){if(!i[e]){if(!a[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(u)return u(e,!0);throw(r=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",r}r=i[e]={exports:{}},a[e][0].call(r.exports,function(t){return s(a[e][1][t]||t)},r,r.exports,n,a,i,o)}return i[e].exports}for(var u="function"==typeof require&&require,t=0;t<o.length;t++)s(o[t]);return s}({1:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setMatrixArrayType=function(t){r.ARRAY_TYPE=a=t},r.toRadian=function(t){return t*o},r.equals=function(t,e){return Math.abs(t-e)<=n*Math.max(1,Math.abs(t),Math.abs(e))},r.RANDOM=r.ARRAY_TYPE=r.EPSILON=void 0;var n=1e-6;r.EPSILON=n;var a="undefined"!=typeof Float32Array?Float32Array:Array;r.ARRAY_TYPE=a;var i=Math.random;r.RANDOM=i;var o=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},{}],2:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.vec4=r.vec3=r.vec2=r.quat2=r.quat=r.mat4=r.mat3=r.mat2d=r.mat2=r.glMatrix=void 0;var n=a(t("./common.js"));r.glMatrix=n;n=a(t("./mat2.js"));r.mat2=n;n=a(t("./mat2d.js"));r.mat2d=n;n=a(t("./mat3.js"));r.mat3=n;n=a(t("./mat4.js"));r.mat4=n;n=a(t("./quat.js"));r.quat=n;n=a(t("./quat2.js"));r.quat2=n;n=a(t("./vec2.js"));r.vec2=n;n=a(t("./vec3.js"));r.vec3=n;t=a(t("./vec4.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function a(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n,a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&((n=i?Object.getOwnPropertyDescriptor(t,r):null)&&(n.get||n.set)?Object.defineProperty(a,r,n):a[r]=t[r]);return a.default=t,e&&e.set(t,a),a}r.vec4=t},{"./common.js":1,"./mat2.js":3,"./mat2d.js":4,"./mat3.js":5,"./mat4.js":6,"./quat.js":7,"./quat2.js":8,"./vec2.js":9,"./vec3.js":10,"./vec4.js":11}],3:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new u.ARRAY_TYPE(4);u.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0);return t[0]=1,t[3]=1,t},r.clone=function(t){var e=new u.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.fromValues=function(t,e,r,n){var a=new u.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a},r.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},r.transpose=function(t,e){{var r;t===e?(r=e[1],t[1]=e[2],t[2]=r):(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3])}return t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],e=r*i-a*n;return e?(e=1/e,t[0]=i*e,t[1]=-n*e,t[2]=-a*e,t[3]=r*e,t):null},r.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=n,r.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r+i*e,t[1]=a*r+o*e,t[2]=n*-e+i*r,t[3]=a*-e+o*r,t},r.scale=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],e=r[0],r=r[1];return t[0]=n*e,t[1]=a*e,t[2]=i*r,t[3]=o*r,t},r.fromRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},r.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},r.subtract=a,r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=e[0],s=e[1],t=e[2],e=e[3];return Math.abs(r-o)<=u.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=u.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-t)<=u.EPSILON*Math.max(1,Math.abs(a),Math.abs(t))&&Math.abs(i-e)<=u.EPSILON*Math.max(1,Math.abs(i),Math.abs(e))},r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},r.sub=r.mul=void 0;var u=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var i;Object.prototype.hasOwnProperty.call(t,r)&&((i=a?Object.getOwnPropertyDescriptor(t,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],e=r[2],r=r[3];return t[0]=n*s+i*u,t[1]=a*s+o*u,t[2]=n*e+i*r,t[3]=a*e+o*r,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}r.mul=n,r.sub=a},{"./common.js":1}],4:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new f.ARRAY_TYPE(6);f.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0);return t[0]=1,t[3]=1,t},r.clone=function(t){var e=new f.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.fromValues=function(t,e,r,n,a,i){var o=new f.ARRAY_TYPE(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o[4]=a,o[5]=i,o},r.set=function(t,e,r,n,a,i,o){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],e=r*i-n*a;return e?(e=1/e,t[0]=i*e,t[1]=-n*e,t[2]=-a*e,t[3]=r*e,t[4]=(a*s-i*o)*e,t[5]=(n*o-r*s)*e,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=n,r.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r+i*e,t[1]=a*r+o*e,t[2]=n*-e+i*r,t[3]=a*-e+o*r,t[4]=s,t[5]=u,t},r.scale=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],e=r[0],r=r[1];return t[0]=n*e,t[1]=a*e,t[2]=i*r,t[3]=o*r,t[4]=s,t[5]=u,t},r.translate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],e=r[0],r=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=n*e+i*r+s,t[5]=a*e+o*r+u,t},r.fromRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},r.subtract=a,r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=e[0],c=e[1],h=e[2],l=e[3],t=e[4],e=e[5];return Math.abs(r-u)<=f.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=f.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-h)<=f.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(i-l)<=f.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-t)<=f.EPSILON*Math.max(1,Math.abs(o),Math.abs(t))&&Math.abs(s-e)<=f.EPSILON*Math.max(1,Math.abs(s),Math.abs(e))},r.sub=r.mul=void 0;var f=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var i;Object.prototype.hasOwnProperty.call(t,r)&&((i=a?Object.getOwnPropertyDescriptor(t,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=r[0],h=r[1],l=r[2],f=r[3],e=r[4],r=r[5];return t[0]=n*c+i*h,t[1]=a*c+o*h,t[2]=n*l+i*f,t[3]=a*l+o*f,t[4]=n*e+i*r+s,t[5]=a*e+o*r+u,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}r.mul=n,r.sub=a},{"./common.js":1}],5:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new g.ARRAY_TYPE(9);g.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0);return t[0]=1,t[4]=1,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new g.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromValues=function(t,e,r,n,a,i,o,s,u){var c=new g.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=a,c[5]=i,c[6]=o,c[7]=s,c[8]=u,c},r.set=function(t,e,r,n,a,i,o,s,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){{var r,n,a;t===e?(r=e[1],n=e[2],a=e[5],t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a):(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8])}return t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],l=h*o-s*c,f=-h*i+s*u,d=c*i-o*u,e=r*l+n*f+a*d;return e?(e=1/e,t[0]=l*e,t[1]=(-h*n+a*c)*e,t[2]=(s*n-a*o)*e,t[3]=f*e,t[4]=(h*r-a*u)*e,t[5]=(-s*r+a*i)*e,t[6]=d*e,t[7]=(-c*r+n*u)*e,t[8]=(o*r-n*i)*e,t):null},r.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],e=e[8];return t[0]=o*e-s*c,t[1]=a*c-n*e,t[2]=n*s-a*o,t[3]=s*u-i*e,t[4]=r*e-a*u,t[5]=a*i-r*s,t[6]=i*c-o*u,t[7]=n*u-r*c,t[8]=r*o-n*i,t},r.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],t=t[8];return e*(t*i-o*u)+r*(-t*a+o*s)+n*(u*a-i*s)},r.multiply=n,r.translate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],e=r[0],r=r[1];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=e*n+r*o+c,t[7]=e*a+r*s+h,t[8]=e*i+r*u+l,t},r.rotate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],e=Math.sin(r),r=Math.cos(r);return t[0]=r*n+e*o,t[1]=r*a+e*s,t[2]=r*i+e*u,t[3]=r*o-e*n,t[4]=r*s-e*a,t[5]=r*u-e*i,t[6]=c,t[7]=h,t[8]=l,t},r.scale=function(t,e,r){var n=r[0],r=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,s=n+n,u=a+a,c=r*o,h=n*o,e=n*s,r=a*o,n=a*s,a=a*u,o=i*o,s=i*s,u=i*u;return t[0]=1-e-a,t[3]=h-u,t[6]=r+s,t[1]=h+u,t[4]=1-c-a,t[7]=n-o,t[2]=r-s,t[5]=n+o,t[8]=1-c-e,t},r.normalFromMat4=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],l=e[9],f=e[10],d=e[11],_=e[12],m=e[13],v=e[14],p=e[15],g=r*s-n*o,M=r*u-a*o,b=r*c-i*o,y=n*u-a*s,x=n*c-i*s,P=a*c-i*u,w=h*m-l*_,E=h*v-f*_,e=h*p-d*_,h=l*v-f*m,l=l*p-d*m,f=f*p-d*v,d=g*f-M*l+b*h+y*e-x*E+P*w;return d?(d=1/d,t[0]=(s*f-u*l+c*h)*d,t[1]=(u*e-o*f-c*E)*d,t[2]=(o*l-s*e+c*w)*d,t[3]=(a*l-n*f-i*h)*d,t[4]=(r*f-a*e+i*E)*d,t[5]=(n*e-r*l-i*w)*d,t[6]=(m*P-v*x+p*y)*d,t[7]=(v*b-_*P-p*M)*d,t[8]=(_*x-m*b+p*g)*d,t):null},r.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},r.subtract=a,r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=t[8],l=e[0],f=e[1],d=e[2],_=e[3],m=e[4],v=e[5],p=e[6],t=e[7],e=e[8];return Math.abs(r-l)<=g.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-f)<=g.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(a-d)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(i-_)<=g.EPSILON*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-m)<=g.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-v)<=g.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-p)<=g.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(c-t)<=g.EPSILON*Math.max(1,Math.abs(c),Math.abs(t))&&Math.abs(h-e)<=g.EPSILON*Math.max(1,Math.abs(h),Math.abs(e))},r.sub=r.mul=void 0;var g=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var i;Object.prototype.hasOwnProperty.call(t,r)&&((i=a?Object.getOwnPropertyDescriptor(t,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=r[0],d=r[1],_=r[2],m=r[3],v=r[4],p=r[5],g=r[6],e=r[7],r=r[8];return t[0]=f*n+d*o+_*c,t[1]=f*a+d*s+_*h,t[2]=f*i+d*u+_*l,t[3]=m*n+v*o+p*c,t[4]=m*a+v*s+p*h,t[5]=m*i+v*u+p*l,t[6]=g*n+e*o+r*c,t[7]=g*a+e*s+r*h,t[8]=g*i+e*u+r*l,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}r.mul=n,r.sub=a},{"./common.js":1}],6:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new T.ARRAY_TYPE(16);T.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},r.clone=function(t){var e=new T.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.fromValues=function(t,e,r,n,a,i,o,s,u,c,h,l,f,d,_,m){var v=new T.ARRAY_TYPE(16);return v[0]=t,v[1]=e,v[2]=r,v[3]=n,v[4]=a,v[5]=i,v[6]=o,v[7]=s,v[8]=u,v[9]=c,v[10]=h,v[11]=l,v[12]=f,v[13]=d,v[14]=_,v[15]=m,v},r.set=function(t,e,r,n,a,i,o,s,u,c,h,l,f,d,_,m,v){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t[8]=c,t[9]=h,t[10]=l,t[11]=f,t[12]=d,t[13]=_,t[14]=m,t[15]=v,t},r.identity=_,r.transpose=function(t,e){{var r,n,a,i,o,s;t===e?(r=e[1],n=e[2],a=e[3],i=e[6],o=e[7],s=e[11],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=i,t[11]=e[14],t[12]=a,t[13]=o,t[14]=s):(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15])}return t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],l=e[9],f=e[10],d=e[11],_=e[12],m=e[13],v=e[14],p=e[15],g=r*s-n*o,M=r*u-a*o,b=r*c-i*o,y=n*u-a*s,x=n*c-i*s,P=a*c-i*u,w=h*m-l*_,E=h*v-f*_,R=h*p-d*_,A=l*v-f*m,k=l*p-d*m,C=f*p-d*v,e=g*C-M*k+b*A+y*R-x*E+P*w;return e?(e=1/e,t[0]=(s*C-u*k+c*A)*e,t[1]=(a*k-n*C-i*A)*e,t[2]=(m*P-v*x+p*y)*e,t[3]=(f*x-l*P-d*y)*e,t[4]=(u*R-o*C-c*E)*e,t[5]=(r*C-a*R+i*E)*e,t[6]=(v*b-_*P-p*M)*e,t[7]=(h*P-f*b+d*M)*e,t[8]=(o*k-s*R+c*w)*e,t[9]=(n*R-r*k-i*w)*e,t[10]=(_*x-m*b+p*g)*e,t[11]=(l*b-h*x-d*g)*e,t[12]=(s*E-o*A-u*w)*e,t[13]=(r*A-n*E+a*w)*e,t[14]=(m*M-_*y-v*g)*e,t[15]=(h*y-l*M+f*g)*e,t):null},r.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=e[4],s=e[5],u=e[6],c=e[7],h=e[8],l=e[9],f=e[10],d=e[11],_=e[12],m=e[13],v=e[14],e=e[15];return t[0]=s*(f*e-d*v)-l*(u*e-c*v)+m*(u*d-c*f),t[1]=-(n*(f*e-d*v)-l*(a*e-i*v)+m*(a*d-i*f)),t[2]=n*(u*e-c*v)-s*(a*e-i*v)+m*(a*c-i*u),t[3]=-(n*(u*d-c*f)-s*(a*d-i*f)+l*(a*c-i*u)),t[4]=-(o*(f*e-d*v)-h*(u*e-c*v)+_*(u*d-c*f)),t[5]=r*(f*e-d*v)-h*(a*e-i*v)+_*(a*d-i*f),t[6]=-(r*(u*e-c*v)-o*(a*e-i*v)+_*(a*c-i*u)),t[7]=r*(u*d-c*f)-o*(a*d-i*f)+h*(a*c-i*u),t[8]=o*(l*e-d*m)-h*(s*e-c*m)+_*(s*d-c*l),t[9]=-(r*(l*e-d*m)-h*(n*e-i*m)+_*(n*d-i*l)),t[10]=r*(s*e-c*m)-o*(n*e-i*m)+_*(n*c-i*s),t[11]=-(r*(s*d-c*l)-o*(n*d-i*l)+h*(n*c-i*s)),t[12]=-(o*(l*v-f*m)-h*(s*v-u*m)+_*(s*f-u*l)),t[13]=r*(l*v-f*m)-h*(n*v-a*m)+_*(n*f-a*l),t[14]=-(r*(s*v-u*m)-o*(n*v-a*m)+_*(n*u-a*s)),t[15]=r*(s*f-u*l)-o*(n*f-a*l)+h*(n*u-a*s),t},r.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],i=t[4],o=t[5],s=t[6],u=t[7],c=t[8],h=t[9],l=t[10],f=t[11],d=t[12],_=t[13],m=t[14],t=t[15];return(e*o-r*i)*(l*t-f*m)-(e*s-n*i)*(h*t-f*_)+(e*u-a*i)*(h*m-l*_)+(r*s-n*o)*(c*t-f*d)-(r*u-a*o)*(c*m-l*d)+(n*u-a*s)*(c*_-h*d)},r.multiply=n,r.translate=function(t,e,r){var n,a,i,o,s,u,c,h,l,f,d,_=r[0],m=r[1],v=r[2];e===t?(t[12]=e[0]*_+e[4]*m+e[8]*v+e[12],t[13]=e[1]*_+e[5]*m+e[9]*v+e[13],t[14]=e[2]*_+e[6]*m+e[10]*v+e[14],t[15]=e[3]*_+e[7]*m+e[11]*v+e[15]):(n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=e[9],d=e[10],r=e[11],t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=l,t[9]=f,t[10]=d,t[11]=r,t[12]=n*_+s*m+l*v+e[12],t[13]=a*_+u*m+f*v+e[13],t[14]=i*_+c*m+d*v+e[14],t[15]=o*_+h*m+r*v+e[15]);return t},r.scale=function(t,e,r){var n=r[0],a=r[1],r=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.rotate=function(t,e,r,n){var a,i,o,s,u,c,h,l,f,d,_,m,v,p,g,M,b,y,x,P=n[0],w=n[1],E=n[2],R=Math.hypot(P,w,E);if(R<T.EPSILON)return null;P*=R=1/R,w*=R,E*=R,y=Math.sin(r),x=Math.cos(r),a=1-x,i=e[0],o=e[1],s=e[2],u=e[3],c=e[4],h=e[5],l=e[6],f=e[7],d=e[8],_=e[9],m=e[10],v=e[11],p=P*P*a+x,g=w*P*a+E*y,M=E*P*a-w*y,b=P*w*a-E*y,n=w*w*a+x,R=E*w*a+P*y,r=P*E*a+w*y,y=w*E*a-P*y,x=E*E*a+x,t[0]=i*p+c*g+d*M,t[1]=o*p+h*g+_*M,t[2]=s*p+l*g+m*M,t[3]=u*p+f*g+v*M,t[4]=i*b+c*n+d*R,t[5]=o*b+h*n+_*R,t[6]=s*b+l*n+m*R,t[7]=u*b+f*n+v*R,t[8]=i*r+c*y+d*x,t[9]=o*r+h*y+_*x,t[10]=s*r+l*y+m*x,t[11]=u*r+f*y+v*x,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},r.rotateX=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[4],o=e[5],s=e[6],u=e[7],c=e[8],h=e[9],l=e[10],r=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=i*a+c*n,t[5]=o*a+h*n,t[6]=s*a+l*n,t[7]=u*a+r*n,t[8]=c*a-i*n,t[9]=h*a-o*n,t[10]=l*a-s*n,t[11]=r*a-u*n,t},r.rotateY=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],u=e[3],c=e[8],h=e[9],l=e[10],r=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=i*a-c*n,t[1]=o*a-h*n,t[2]=s*a-l*n,t[3]=u*a-r*n,t[8]=i*n+c*a,t[9]=o*n+h*a,t[10]=s*n+l*a,t[11]=u*n+r*a,t},r.rotateZ=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),i=e[0],o=e[1],s=e[2],u=e[3],c=e[4],h=e[5],l=e[6],r=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=i*a+c*n,t[1]=o*a+h*n,t[2]=s*a+l*n,t[3]=u*a+r*n,t[4]=c*a-i*n,t[5]=h*a-o*n,t[6]=l*a-s*n,t[7]=r*a-u*n,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,r){var n=r[0],a=r[1],i=r[2],o=Math.hypot(n,a,i);if(o<T.EPSILON)return null;return n*=o=1/o,a*=o,i*=o,r=Math.sin(e),o=Math.cos(e),e=1-o,t[0]=n*n*e+o,t[1]=a*n*e+i*r,t[2]=i*n*e-a*r,t[3]=0,t[4]=n*a*e-i*r,t[5]=a*a*e+o,t[6]=i*a*e+n*r,t[7]=0,t[8]=n*i*e+a*r,t[9]=a*i*e-n*r,t[10]=i*i*e+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromXRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=f,r.fromQuat2=function(t,e){var r=new T.ARRAY_TYPE(3),n=-e[0],a=-e[1],i=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=n*n+a*a+i*i+o*o;0<l?(r[0]=2*(s*o+h*n+u*i-c*a)/l,r[1]=2*(u*o+h*a+c*n-s*i)/l,r[2]=2*(c*o+h*i+s*a-u*n)/l):(r[0]=2*(s*o+h*n+u*i-c*a),r[1]=2*(u*o+h*a+c*n-s*i),r[2]=2*(c*o+h*i+s*a-u*n));return f(t,e,r),t},r.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},r.getScaling=d,r.getRotation=function(t,e){var r=new T.ARRAY_TYPE(3);d(r,e);var n=1/r[0],a=1/r[1],i=1/r[2],o=e[0]*n,s=e[1]*a,u=e[2]*i,c=e[4]*n,h=e[5]*a,l=e[6]*i,r=e[8]*n,n=e[9]*a,a=e[10]*i,e=o+h+a,i=0;0<e?(i=2*Math.sqrt(1+e),t[3]=.25*i,t[0]=(l-n)/i,t[1]=(r-u)/i,t[2]=(s-c)/i):h<o&&a<o?(i=2*Math.sqrt(1+o-h-a),t[3]=(l-n)/i,t[0]=.25*i,t[1]=(s+c)/i,t[2]=(r+u)/i):a<h?(i=2*Math.sqrt(1+h-o-a),t[3]=(r-u)/i,t[0]=(s+c)/i,t[1]=.25*i,t[2]=(l+n)/i):(i=2*Math.sqrt(1+a-o-h),t[3]=(s-c)/i,t[0]=(r+u)/i,t[1]=(l+n)/i,t[2]=.25*i);return t},r.fromRotationTranslationScale=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=e[3],u=a+a,c=i+i,h=o+o,l=a*u,f=a*c,d=a*h,e=i*c,a=i*h,i=o*h,o=s*u,u=s*c,c=s*h,s=n[0],h=n[1],n=n[2];return t[0]=(1-(e+i))*s,t[1]=(f+c)*s,t[2]=(d-u)*s,t[3]=0,t[4]=(f-c)*h,t[5]=(1-(l+i))*h,t[6]=(a+o)*h,t[7]=0,t[8]=(d+u)*n,t[9]=(a-o)*n,t[10]=(1-(l+e))*n,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,r,n,a){var i=e[0],o=e[1],s=e[2],u=e[3],c=i+i,h=o+o,l=s+s,f=i*c,d=i*h,_=i*l,m=o*h,v=o*l,p=s*l,g=u*c,e=u*h,i=u*l,o=n[0],s=n[1],c=n[2],h=a[0],u=a[1],l=a[2],n=(1-(m+p))*o,a=(d+i)*o,o=(_-e)*o,i=(d-i)*s,p=(1-(f+p))*s,s=(v+g)*s,e=(_+e)*c,g=(v-g)*c,c=(1-(f+m))*c;return t[0]=n,t[1]=a,t[2]=o,t[3]=0,t[4]=i,t[5]=p,t[6]=s,t[7]=0,t[8]=e,t[9]=g,t[10]=c,t[11]=0,t[12]=r[0]+h-(n*h+i*u+e*l),t[13]=r[1]+u-(a*h+p*u+g*l),t[14]=r[2]+l-(o*h+s*u+c*l),t[15]=1,t},r.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=r+r,s=n+n,u=a+a,c=r*o,h=n*o,e=n*s,r=a*o,n=a*s,a=a*u,o=i*o,s=i*s,u=i*u;return t[0]=1-e-a,t[1]=h+u,t[2]=r-s,t[3]=0,t[4]=h-u,t[5]=1-c-a,t[6]=n+o,t[7]=0,t[8]=r+s,t[9]=n-o,t[10]=1-c-e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,r,n,a,i,o){var s=1/(r-e),u=1/(a-n),c=1/(i-o);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(a+n)*u,t[10]=(o+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*c,t[15]=0,t},r.perspective=function(t,e,r,n,a){e=1/Math.tan(e/2);t[0]=e/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(e=1/(n-a),t[10]=(a+n)*e,t[14]=2*a*n*e):(t[10]=-1,t[14]=-2*n);return t},r.perspectiveFromFieldOfView=function(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(o+s),e=2/(a+i);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=-(o-s)*u*.5,t[9]=(a-i)*e*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},r.ortho=function(t,e,r,n,a,i,o){var s=1/(e-r),u=1/(n-a),c=1/(i-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(a+n)*u,t[14]=(o+i)*c,t[15]=1,t},r.lookAt=function(t,e,r,n){var a,i=e[0],o=e[1],s=e[2],u=n[0],c=n[1],h=n[2],l=r[0],f=r[1],d=r[2];if(Math.abs(i-l)<T.EPSILON&&Math.abs(o-f)<T.EPSILON&&Math.abs(s-d)<T.EPSILON)return _(t);a=i-l,e=o-f,n=s-d,r=1/Math.hypot(a,e,n),l=c*(n*=r)-h*(e*=r),f=h*(a*=r)-u*n,d=u*e-c*a,(r=Math.hypot(l,f,d))?(l*=r=1/r,f*=r,d*=r):d=f=l=0;h=e*d-n*f,u=n*l-a*d,c=a*f-e*l,(r=Math.hypot(h,u,c))?(h*=r=1/r,u*=r,c*=r):c=u=h=0;return t[0]=l,t[1]=h,t[2]=a,t[3]=0,t[4]=f,t[5]=u,t[6]=e,t[7]=0,t[8]=d,t[9]=c,t[10]=n,t[11]=0,t[12]=-(l*i+f*o+d*s),t[13]=-(h*i+u*o+c*s),t[14]=-(a*i+e*o+n*s),t[15]=1,t},r.targetTo=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],s=n[0],u=n[1],c=n[2],h=a-r[0],l=i-r[1],e=o-r[2],n=h*h+l*l+e*e;0<n&&(n=1/Math.sqrt(n),h*=n,l*=n,e*=n);r=u*e-c*l,c=c*h-s*e,u=s*l-u*h;0<(n=r*r+c*c+u*u)&&(n=1/Math.sqrt(n),r*=n,c*=n,u*=n);return t[0]=r,t[1]=c,t[2]=u,t[3]=0,t[4]=l*u-e*c,t[5]=e*r-h*u,t[6]=h*c-l*r,t[7]=0,t[8]=h,t[9]=l,t[10]=e,t[11]=0,t[12]=a,t[13]=i,t[14]=o,t[15]=1,t},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},r.subtract=a,r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=t[8],l=t[9],f=t[10],d=t[11],_=t[12],m=t[13],v=t[14],p=t[15],g=e[0],M=e[1],b=e[2],y=e[3],x=e[4],P=e[5],w=e[6],E=e[7],R=e[8],A=e[9],k=e[10],C=e[11],S=e[12],O=e[13],t=e[14],e=e[15];return Math.abs(r-g)<=T.EPSILON*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-M)<=T.EPSILON*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(a-b)<=T.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(i-y)<=T.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(o-x)<=T.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-P)<=T.EPSILON*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(u-w)<=T.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(c-E)<=T.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(h-R)<=T.EPSILON*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(l-A)<=T.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(f-k)<=T.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(d-C)<=T.EPSILON*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(_-S)<=T.EPSILON*Math.max(1,Math.abs(_),Math.abs(S))&&Math.abs(m-O)<=T.EPSILON*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(v-t)<=T.EPSILON*Math.max(1,Math.abs(v),Math.abs(t))&&Math.abs(p-e)<=T.EPSILON*Math.max(1,Math.abs(p),Math.abs(e))},r.sub=r.mul=void 0;var T=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var i;Object.prototype.hasOwnProperty.call(t,r)&&((i=a?Object.getOwnPropertyDescriptor(t,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function _(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function n(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=e[9],d=e[10],_=e[11],m=e[12],v=e[13],p=e[14],g=e[15],M=r[0],b=r[1],y=r[2],e=r[3];return t[0]=M*n+b*s+y*l+e*m,t[1]=M*a+b*u+y*f+e*v,t[2]=M*i+b*c+y*d+e*p,t[3]=M*o+b*h+y*_+e*g,M=r[4],b=r[5],y=r[6],e=r[7],t[4]=M*n+b*s+y*l+e*m,t[5]=M*a+b*u+y*f+e*v,t[6]=M*i+b*c+y*d+e*p,t[7]=M*o+b*h+y*_+e*g,M=r[8],b=r[9],y=r[10],e=r[11],t[8]=M*n+b*s+y*l+e*m,t[9]=M*a+b*u+y*f+e*v,t[10]=M*i+b*c+y*d+e*p,t[11]=M*o+b*h+y*_+e*g,M=r[12],b=r[13],y=r[14],e=r[15],t[12]=M*n+b*s+y*l+e*m,t[13]=M*a+b*u+y*f+e*v,t[14]=M*i+b*c+y*d+e*p,t[15]=M*o+b*h+y*_+e*g,t}function f(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=n+n,u=a+a,c=i+i,h=n*s,l=n*u,e=n*c,n=a*u,a=a*c,i=i*c,s=o*s,u=o*u,c=o*c;return t[0]=1-(n+i),t[1]=l+c,t[2]=e-u,t[3]=0,t[4]=l-c,t[5]=1-(h+i),t[6]=a+s,t[7]=0,t[8]=e+u,t[9]=a-s,t[10]=1-(h+n),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function d(t,e){var r=e[0],n=e[1],a=e[2],i=e[4],o=e[5],s=e[6],u=e[8],c=e[9],e=e[10];return t[0]=Math.hypot(r,n,a),t[1]=Math.hypot(i,o,s),t[2]=Math.hypot(u,c,e),t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}r.mul=n,r.sub=a},{"./common.js":1}],7:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=c,r.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},r.setAxisAngle=h,r.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);n>d.EPSILON?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0);return r},r.getAngle=function(t,e){e=g(t,e);return Math.acos(2*e*e-1)},r.multiply=l,r.rotateX=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r+o*e,t[1]=a*r+i*e,t[2]=i*r-a*e,t[3]=o*r-n*e,t},r.rotateY=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r-i*e,t[1]=a*r+o*e,t[2]=i*r+n*e,t[3]=o*r-a*e,t},r.rotateZ=function(t,e,r){r*=.5;var n=e[0],a=e[1],i=e[2],o=e[3],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r+a*e,t[1]=a*r-n*e,t[2]=i*r+o*e,t[3]=o*r-i*e,t},r.calculateW=function(t,e){var r=e[0],n=e[1],e=e[2];return t[0]=r,t[1]=n,t[2]=e,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-e*e)),t},r.exp=f,r.ln=_,r.pow=function(t,e,r){return _(t,e),p(t,t,r),f(t,t),t},r.slerp=m,r.random=function(t){var e=d.RANDOM(),r=d.RANDOM(),n=d.RANDOM(),a=Math.sqrt(1-e),e=Math.sqrt(e);return t[0]=a*Math.sin(2*Math.PI*r),t[1]=a*Math.cos(2*Math.PI*r),t[2]=e*Math.sin(2*Math.PI*n),t[3]=e*Math.cos(2*Math.PI*n),t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],e=r*r+n*n+a*a+i*i,e=e?1/e:0;return t[0]=-r*e,t[1]=-n*e,t[2]=-a*e,t[3]=i*e,t},r.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},r.fromMat3=v,r.fromEuler=function(t,e,r,n){var a=.5*Math.PI/180;e*=a,r*=a,n*=a;var i=Math.sin(e),o=Math.cos(e),a=Math.sin(r),e=Math.cos(r),r=Math.sin(n),n=Math.cos(n);return t[0]=i*e*n-o*a*r,t[1]=o*a*n+i*e*r,t[2]=o*e*r-i*a*n,t[3]=o*e*n+i*a*r,t},r.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.setAxes=r.sqlerp=r.rotationTo=r.equals=r.exactEquals=r.normalize=r.sqrLen=r.squaredLength=r.len=r.length=r.lerp=r.dot=r.scale=r.mul=r.add=r.set=r.copy=r.fromValues=r.clone=void 0;var d=u(t("./common.js")),n=u(t("./mat3.js")),a=u(t("./vec3.js")),i=u(t("./vec4.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function u(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n,a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&((n=i?Object.getOwnPropertyDescriptor(t,r):null)&&(n.get||n.set)?Object.defineProperty(a,r,n):a[r]=t[r]);return a.default=t,e&&e.set(t,a),a}function c(){var t=new d.ARRAY_TYPE(4);return d.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function h(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function l(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],e=r[2],r=r[3];return t[0]=n*r+o*s+a*e-i*u,t[1]=a*r+o*u+i*s-n*e,t[2]=i*r+o*e+n*u-a*s,t[3]=o*r-n*s-a*u-i*e,t}function f(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],o=Math.sqrt(r*r+n*n+a*a),e=Math.exp(i),i=0<o?e*Math.sin(o)/o:0;return t[0]=r*i,t[1]=n*i,t[2]=a*i,t[3]=e*Math.cos(o),t}function _(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],e=Math.sqrt(r*r+n*n+a*a),e=0<e?Math.atan2(e,i)/e:0;return t[0]=r*e,t[1]=n*e,t[2]=a*e,t[3]=.5*Math.log(r*r+n*n+a*a+i*i),t}function m(t,e,r,n){var a,i=e[0],o=e[1],s=e[2],u=e[3],c=r[0],h=r[1],l=r[2],f=r[3],e=i*c+o*h+s*l+u*f;return e<0&&(e=-e,c=-c,h=-h,l=-l,f=-f),n=1-e>d.EPSILON?(r=Math.acos(e),e=Math.sin(r),a=Math.sin((1-n)*r)/e,Math.sin(n*r)/e):(a=1-n,n),t[0]=a*i+n*c,t[1]=a*o+n*h,t[2]=a*s+n*l,t[3]=a*u+n*f,t}function v(t,e){var r,n,a,i=e[0]+e[4]+e[8];return 0<i?(a=Math.sqrt(i+1),t[3]=.5*a,t[0]=(e[5]-e[7])*(a=.5/a),t[1]=(e[6]-e[2])*a,t[2]=(e[1]-e[3])*a):(e[4]>e[r=0]&&(r=1),n=((r=e[8]>e[3*r+r]?2:r)+1)%3,i=(r+2)%3,a=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*i+i]+1),t[r]=.5*a,t[3]=(e[3*n+i]-e[3*i+n])*(a=.5/a),t[n]=(e[3*n+r]+e[3*r+n])*a,t[i]=(e[3*i+r]+e[3*r+i])*a),t}t=i.clone;r.clone=t;t=i.fromValues;r.fromValues=t;t=i.copy;r.copy=t;t=i.set;r.set=t;t=i.add;r.add=t,r.mul=l;var p=i.scale;r.scale=p;var g=i.dot;r.dot=g;t=i.lerp;r.lerp=t;t=i.length;r.length=t,r.len=t;t=i.squaredLength;r.squaredLength=t,r.sqrLen=t;var M=i.normalize;r.normalize=M;t=i.exactEquals;r.exactEquals=t;i=i.equals;r.equals=i;var b,y,x,i=(b=a.create(),y=a.fromValues(1,0,0),x=a.fromValues(0,1,0),function(t,e,r){var n=a.dot(e,r);return n<-.999999?(a.cross(b,y,e),a.len(b)<1e-6&&a.cross(b,x,e),a.normalize(b,b),h(t,b,Math.PI),t):.999999<n?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(a.cross(b,e,r),t[0]=b[0],t[1]=b[1],t[2]=b[2],t[3]=1+n,M(t,t))});r.rotationTo=i;var P,w,i=(P=c(),w=c(),function(t,e,r,n,a,i){return m(P,e,a,i),m(w,r,n,i),m(t,P,w,2*i*(1-i)),t});r.sqlerp=i;var E,n=(E=n.create(),function(t,e,r,n){return E[0]=r[0],E[3]=r[1],E[6]=r[2],E[1]=n[0],E[4]=n[1],E[7]=n[2],E[2]=-e[0],E[5]=-e[1],E[8]=-e[2],M(t,v(t,E))});r.setAxes=n},{"./common.js":1,"./mat3.js":5,"./vec3.js":10,"./vec4.js":11}],8:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new v.ARRAY_TYPE(8);v.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0);return t[3]=1,t},r.clone=function(t){var e=new v.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},r.fromValues=function(t,e,r,n,a,i,o,s){var u=new v.ARRAY_TYPE(8);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=a,u[5]=i,u[6]=o,u[7]=s,u},r.fromRotationTranslationValues=function(t,e,r,n,a,i,o){var s=new v.ARRAY_TYPE(8);s[0]=t,s[1]=e,s[2]=r,s[3]=n;a*=.5,i*=.5,o*=.5;return s[4]=a*n+i*r-o*e,s[5]=i*n+o*t-a*r,s[6]=o*n+a*e-i*t,s[7]=-a*t-i*e-o*r,s},r.fromRotationTranslation=i,r.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},r.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},r.fromMat4=function(t,e){var r=_.create();a.getRotation(r,e);var n=new v.ARRAY_TYPE(3);return a.getTranslation(n,e),i(t,r,n),t},r.copy=h,r.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},r.set=function(t,e,r,n,a,i,o,s,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=i,t[5]=o,t[6]=s,t[7]=u,t},r.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},r.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},r.getTranslation=function(t,e){var r=e[4],n=e[5],a=e[6],i=e[7],o=-e[0],s=-e[1],u=-e[2],e=e[3];return t[0]=2*(r*e+i*o+n*u-a*s),t[1]=2*(n*e+i*s+a*o-r*u),t[2]=2*(a*e+i*u+r*s-n*o),t},r.translate=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=.5*r[0],u=.5*r[1],c=.5*r[2],h=e[4],l=e[5],r=e[6],e=e[7];return t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=o*s+a*c-i*u+h,t[5]=o*u+i*s-n*c+l,t[6]=o*c+n*u-a*s+r,t[7]=-n*s-a*u-i*c+e,t},r.rotateX=function(t,e,r){var n=-e[0],a=-e[1],i=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=s*o+h*n+u*i-c*a,f=u*o+h*a+c*n-s*i,d=c*o+h*i+s*a-u*n,c=h*o-s*n-u*a-c*i;return _.rotateX(t,e,r),n=t[0],a=t[1],i=t[2],o=t[3],t[4]=l*o+c*n+f*i-d*a,t[5]=f*o+c*a+d*n-l*i,t[6]=d*o+c*i+l*a-f*n,t[7]=c*o-l*n-f*a-d*i,t},r.rotateY=function(t,e,r){var n=-e[0],a=-e[1],i=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=s*o+h*n+u*i-c*a,f=u*o+h*a+c*n-s*i,d=c*o+h*i+s*a-u*n,c=h*o-s*n-u*a-c*i;return _.rotateY(t,e,r),n=t[0],a=t[1],i=t[2],o=t[3],t[4]=l*o+c*n+f*i-d*a,t[5]=f*o+c*a+d*n-l*i,t[6]=d*o+c*i+l*a-f*n,t[7]=c*o-l*n-f*a-d*i,t},r.rotateZ=function(t,e,r){var n=-e[0],a=-e[1],i=-e[2],o=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=s*o+h*n+u*i-c*a,f=u*o+h*a+c*n-s*i,d=c*o+h*i+s*a-u*n,c=h*o-s*n-u*a-c*i;return _.rotateZ(t,e,r),n=t[0],a=t[1],i=t[2],o=t[3],t[4]=l*o+c*n+f*i-d*a,t[5]=f*o+c*a+d*n-l*i,t[6]=d*o+c*i+l*a-f*n,t[7]=c*o-l*n-f*a-d*i,t},r.rotateByQuatAppend=function(t,e,r){var n=r[0],a=r[1],i=r[2],o=r[3],s=e[0],u=e[1],c=e[2],r=e[3];return t[0]=s*o+r*n+u*i-c*a,t[1]=u*o+r*a+c*n-s*i,t[2]=c*o+r*i+s*a-u*n,t[3]=r*o-s*n-u*a-c*i,s=e[4],u=e[5],c=e[6],r=e[7],t[4]=s*o+r*n+u*i-c*a,t[5]=u*o+r*a+c*n-s*i,t[6]=c*o+r*i+s*a-u*n,t[7]=r*o-s*n-u*a-c*i,t},r.rotateByQuatPrepend=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[0],u=r[1],c=r[2],e=r[3];return t[0]=n*e+o*s+a*c-i*u,t[1]=a*e+o*u+i*s-n*c,t[2]=i*e+o*c+n*u-a*s,t[3]=o*e-n*s-a*u-i*c,s=r[4],u=r[5],c=r[6],e=r[7],t[4]=n*e+o*s+a*c-i*u,t[5]=a*e+o*u+i*s-n*c,t[6]=i*e+o*c+n*u-a*s,t[7]=o*e-n*s-a*u-i*c,t},r.rotateAroundAxis=function(t,e,r,n){if(Math.abs(n)<v.EPSILON)return h(t,e);var a=Math.hypot(r[0],r[1],r[2]);n*=.5;var i=Math.sin(n),o=i*r[0]/a,s=i*r[1]/a,u=i*r[2]/a,c=Math.cos(n),i=e[0],r=e[1],a=e[2],n=e[3];t[0]=i*c+n*o+r*u-a*s,t[1]=r*c+n*s+a*o-i*u,t[2]=a*c+n*u+i*s-r*o,t[3]=n*c-i*o-r*s-a*u;i=e[4],r=e[5],a=e[6],e=e[7];return t[4]=i*c+e*o+r*u-a*s,t[5]=r*c+e*s+a*o-i*u,t[6]=a*c+e*u+i*s-r*o,t[7]=e*c-i*o-r*s-a*u,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t},r.multiply=u,r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t},r.lerp=function(t,e,r,n){var a=1-n;c(e,r)<0&&(n=-n);return t[0]=e[0]*a+r[0]*n,t[1]=e[1]*a+r[1]*n,t[2]=e[2]*a+r[2]*n,t[3]=e[3]*a+r[3]*n,t[4]=e[4]*a+r[4]*n,t[5]=e[5]*a+r[5]*n,t[6]=e[6]*a+r[6]*n,t[7]=e[7]*a+r[7]*n,t},r.invert=function(t,e){var r=l(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t},r.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},r.normalize=function(t,e){var r=l(e);{var n,a,i,o,s,u,c,h;0<r&&(r=Math.sqrt(r),n=e[0]/r,a=e[1]/r,i=e[2]/r,o=e[3]/r,s=e[4],u=e[5],c=e[6],h=e[7],e=n*s+a*u+i*c+o*h,t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=(s-n*e)/r,t[5]=(u-a*e)/r,t[6]=(c-i*e)/r,t[7]=(h-o*e)/r)}return t},r.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],u=t[6],c=t[7],h=e[0],l=e[1],f=e[2],d=e[3],_=e[4],m=e[5],t=e[6],e=e[7];return Math.abs(r-h)<=v.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-l)<=v.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-f)<=v.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(i-d)<=v.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-_)<=v.EPSILON*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-m)<=v.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-t)<=v.EPSILON*Math.max(1,Math.abs(u),Math.abs(t))&&Math.abs(c-e)<=v.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))},r.sqrLen=r.squaredLength=r.len=r.length=r.dot=r.mul=r.setReal=r.getReal=void 0;var v=n(t("./common.js")),_=n(t("./quat.js")),a=n(t("./mat4.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n,a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&((n=i?Object.getOwnPropertyDescriptor(t,r):null)&&(n.get||n.set)?Object.defineProperty(a,r,n):a[r]=t[r]);return a.default=t,e&&e.set(t,a),a}function i(t,e,r){var n=.5*r[0],a=.5*r[1],i=.5*r[2],o=e[0],s=e[1],r=e[2],e=e[3];return t[0]=o,t[1]=s,t[2]=r,t[3]=e,t[4]=n*e+a*r-i*s,t[5]=a*e+i*o-n*r,t[6]=i*e+n*s-a*o,t[7]=-n*o-a*s-i*r,t}function h(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}t=_.copy;r.getReal=t;t=_.copy;function u(t,e,r){var n=e[0],a=e[1],i=e[2],o=e[3],s=r[4],u=r[5],c=r[6],h=r[7],l=e[4],f=e[5],d=e[6],_=e[7],m=r[0],v=r[1],e=r[2],r=r[3];return t[0]=n*r+o*m+a*e-i*v,t[1]=a*r+o*v+i*m-n*e,t[2]=i*r+o*e+n*v-a*m,t[3]=o*r-n*m-a*v-i*e,t[4]=n*h+o*s+a*c-i*u+l*r+_*m+f*e-d*v,t[5]=a*h+o*u+i*s-n*c+f*r+_*v+d*m-l*e,t[6]=i*h+o*c+n*u-a*s+d*r+_*e+l*v-f*m,t[7]=o*h-n*s-a*u-i*c+_*r-l*m-f*v-d*e,t}r.setReal=t,r.mul=u;var c=_.dot;r.dot=c;t=_.length;r.length=t,r.len=t;var l=_.squaredLength;r.squaredLength=l,r.sqrLen=l},{"./common.js":1,"./mat4.js":6,"./quat.js":7}],9:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.clone=function(t){var e=new a.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var r=new a.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,r){return t[0]=e,t[1]=r,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},r.subtract=i,r.multiply=u,r.divide=c,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},r.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},r.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},r.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},r.distance=h,r.squaredDistance=l,r.length=f,r.squaredLength=d,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var r=e[0],n=e[1],n=r*r+n*n;0<n&&(n=1/Math.sqrt(n));return t[0]=e[0]*n,t[1]=e[1]*n,t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,r){r=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=r,t},r.lerp=function(t,e,r,n){var a=e[0],e=e[1];return t[0]=a+n*(r[0]-a),t[1]=e+n*(r[1]-e),t},r.random=function(t,e){e=e||1;var r=2*a.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},r.transformMat2=function(t,e,r){var n=e[0],e=e[1];return t[0]=r[0]*n+r[2]*e,t[1]=r[1]*n+r[3]*e,t},r.transformMat2d=function(t,e,r){var n=e[0],e=e[1];return t[0]=r[0]*n+r[2]*e+r[4],t[1]=r[1]*n+r[3]*e+r[5],t},r.transformMat3=function(t,e,r){var n=e[0],e=e[1];return t[0]=r[0]*n+r[3]*e+r[6],t[1]=r[1]*n+r[4]*e+r[7],t},r.transformMat4=function(t,e,r){var n=e[0],e=e[1];return t[0]=r[0]*n+r[4]*e+r[12],t[1]=r[1]*n+r[5]*e+r[13],t},r.rotate=function(t,e,r,n){var a=e[0]-r[0],i=e[1]-r[1],e=Math.sin(n),n=Math.cos(n);return t[0]=a*n-i*e+r[0],t[1]=a*e+i*n+r[1],t},r.angle=function(t,e){var r=t[0],n=t[1],a=e[0],t=e[1],e=Math.sqrt(r*r+n*n)*Math.sqrt(a*a+t*t),e=e&&(r*a+n*t)/e;return Math.acos(Math.min(Math.max(e,-1),1))},r.zero=function(t){return t[0]=0,t[1]=0,t},r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},r.equals=function(t,e){var r=t[0],n=t[1],t=e[0],e=e[1];return Math.abs(r-t)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(t))&&Math.abs(n-e)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))},r.forEach=r.sqrLen=r.sqrDist=r.dist=r.div=r.mul=r.sub=r.len=void 0;var a=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var i;Object.prototype.hasOwnProperty.call(t,r)&&((i=a?Object.getOwnPropertyDescriptor(t,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(){var t=new a.ARRAY_TYPE(2);return a.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function u(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function c(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function h(t,e){var r=e[0]-t[0],t=e[1]-t[1];return Math.hypot(r,t)}function l(t,e){var r=e[0]-t[0],t=e[1]-t[1];return r*r+t*t}function f(t){var e=t[0],t=t[1];return Math.hypot(e,t)}function d(t){var e=t[0],t=t[1];return e*e+t*t}r.len=f,r.sub=i,r.mul=u,r.div=c,r.dist=h,r.sqrDist=l,r.sqrLen=d;var _,t=(_=n(),function(t,e,r,n,a,i){var o,s;for(e=e||2,r=r||0,s=n?Math.min(n*e+r,t.length):t.length,o=r;o<s;o+=e)_[0]=t[o],_[1]=t[o+1],a(_,_,i),t[o]=_[0],t[o+1]=_[1];return t});r.forEach=t},{"./common.js":1}],10:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.clone=function(t){var e=new s.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.length=a,r.fromValues=function(t,e,r){var n=new s.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},r.subtract=i,r.multiply=c,r.divide=h,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},r.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},r.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},r.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},r.distance=l,r.squaredDistance=f,r.squaredLength=d,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],a=r*r+n*n+a*a;0<a&&(a=1/Math.sqrt(a));return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t},r.dot=_,r.cross=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],e=r[1],r=r[2];return t[0]=a*r-i*e,t[1]=i*o-n*r,t[2]=n*e-a*o,t},r.lerp=function(t,e,r,n){var a=e[0],i=e[1],e=e[2];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=e+n*(r[2]-e),t},r.hermite=function(t,e,r,n,a,i){var o=i*i,s=o*(2*i-3)+1,u=o*(i-2)+i,c=o*(i-1),i=o*(3-2*i);return t[0]=e[0]*s+r[0]*u+n[0]*c+a[0]*i,t[1]=e[1]*s+r[1]*u+n[1]*c+a[1]*i,t[2]=e[2]*s+r[2]*u+n[2]*c+a[2]*i,t},r.bezier=function(t,e,r,n,a,i){var o=1-i,s=o*o,u=i*i,c=s*o,s=3*i*s,o=3*u*o,i=u*i;return t[0]=e[0]*c+r[0]*s+n[0]*o+a[0]*i,t[1]=e[1]*c+r[1]*s+n[1]*o+a[1]*i,t[2]=e[2]*c+r[2]*s+n[2]*o+a[2]*i,t},r.random=function(t,e){e=e||1;var r=2*s.RANDOM()*Math.PI,n=2*s.RANDOM()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t},r.transformMat4=function(t,e,r){var n=e[0],a=e[1],i=e[2],e=r[3]*n+r[7]*a+r[11]*i+r[15];return e=e||1,t[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/e,t[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/e,t[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/e,t},r.transformMat3=function(t,e,r){var n=e[0],a=e[1],e=e[2];return t[0]=n*r[0]+a*r[3]+e*r[6],t[1]=n*r[1]+a*r[4]+e*r[7],t[2]=n*r[2]+a*r[5]+e*r[8],t},r.transformQuat=function(t,e,r){var n=r[0],a=r[1],i=r[2],o=r[3],s=e[0],u=e[1],c=e[2],h=a*c-i*u,l=i*s-n*c,r=n*u-a*s,e=a*r-i*l,i=i*h-n*r,a=n*l-a*h,o=2*o;return h*=o,l*=o,r*=o,e*=2,i*=2,a*=2,t[0]=s+h+e,t[1]=u+l+i,t[2]=c+r+a,t},r.rotateX=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},r.rotateY=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},r.rotateZ=function(t,e,r,n){var a=[],i=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2],t},r.angle=function(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],o=e[1],s=e[2],a=Math.sqrt(r*r+n*n+a*a),s=Math.sqrt(i*i+o*o+s*s),s=a*s,s=s&&_(t,e)/s;return Math.acos(Math.min(Math.max(s,-1),1))},r.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],i=e[0],t=e[1],e=e[2];return Math.abs(r-i)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-t)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(t))&&Math.abs(a-e)<=s.EPSILON*Math.max(1,Math.abs(a),Math.abs(e))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var s=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var r,n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var i;Object.prototype.hasOwnProperty.call(t,r)&&((i=a?Object.getOwnPropertyDescriptor(t,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function n(){var t=new s.ARRAY_TYPE(3);return s.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function a(t){var e=t[0],r=t[1],t=t[2];return Math.hypot(e,r,t)}function i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function c(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function h(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function l(t,e){var r=e[0]-t[0],n=e[1]-t[1],t=e[2]-t[2];return Math.hypot(r,n,t)}function f(t,e){var r=e[0]-t[0],n=e[1]-t[1],t=e[2]-t[2];return r*r+n*n+t*t}function d(t){var e=t[0],r=t[1],t=t[2];return e*e+r*r+t*t}function _(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}r.sub=i,r.mul=c,r.div=h,r.dist=l,r.sqrDist=f,r.len=a,r.sqrLen=d;var m,t=(m=n(),function(t,e,r,n,a,i){var o,s;for(e=e||3,r=r||0,s=n?Math.min(n*e+r,t.length):t.length,o=r;o<s;o+=e)m[0]=t[o],m[1]=t[o+1],m[2]=t[o+2],a(m,m,i),t[o]=m[0],t[o+1]=m[1],t[o+2]=m[2];return t});r.forEach=t},{"./common.js":1}],11:[function(t,e,r){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.clone=function(t){var e=new c.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,r,n){var a=new c.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},r.subtract=a,r.multiply=i,r.divide=u,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},r.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},r.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},r.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},r.distance=h,r.squaredDistance=l,r.length=f,r.squaredLength=d,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],i=e[3],e=r*r+n*n+a*a+i*i;0<e&&(e=1/Math.sqrt(e));return t[0]=r*e,t[1]=n*e,t[2]=a*e,t[3]=i*e,t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.cross=function(t,e,r,n){var a=r[0]*n[1]-r[1]*n[0],i=r[0]*n[2]-r[2]*n[0],o=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],u=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],h=e[0],r=e[1],n=e[2],e=e[3];return t[0]=r*c-n*u+e*s,t[1]=-h*c+n*o-e*i,t[2]=h*u-r*o+e*a,t[3]=-h*s+r*i-n*a,t},r.lerp=function(t,e,r,n){var a=e[0],i=e[1],o=e[2],e=e[3];return t[0]=a+n*(r[0]-a),t[1]=i+n*(r[1]-i),t[2]=o+n*(r[2]-o),t[3]=e+n*(r[3]-e),t},r.random=function(t,e){var r,n,a,i,o,s;e=e||1;for(;r=2*c.RANDOM()-1,n=2*c.RANDOM()-1,o=r*r+n*n,1<=o;);for(;a=2*c.RANDOM()-1,i=2*c.RANDOM()-1,s=a*a+i*i,1<=s;);var u=Math.sqrt((1-o)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*a*u,t[3]=e*i*u,t},r.transformMat4=function(t,e,r){var n=e[0],a=e[1],i=e[2],e=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*e,t[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*e,t[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*e,t[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*e,t},r.transformQuat=function(t,e,r){var n=e[0],a=e[1],i=e[2],o=r[0],s=r[1],u=r[2],c=r[3],h=c*n+s*i-u*a,l=c*a+u*n-o*i,r=c*i+o*a-s*n,i=-o*n-s*a-u*i;return t[0]=h*c+i*-o+l*-u-r*-s,t[1]=l*c+i*-s+r*-o-h*-u,t[2]=r*c+i*-u+h*-s-l*-o,t[3]=e[3],t},r.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],i=t[3],o=e[0],s=e[1],t=e[2],e=e[3];return Math.abs(r-o)<=c.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=c.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-t)<=c.EPSILON*Math.max(1,Math.abs(a),Math.abs(t))&&Math.abs(i-e)<=c.EPSILON*Math.max(1,Math.abs(i),Math.abs(e))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var c=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==o(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var i;Object.prototype.hasOwnProperty.call(t,r)&&((i=a?Object.getOwnPropertyDescriptor(t,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(){var t=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function i(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function u(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function h(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],t=e[3]-t[3];return Math.hypot(r,n,a,t)}function l(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],t=e[3]-t[3];return r*r+n*n+a*a+t*t}function f(t){var e=t[0],r=t[1],n=t[2],t=t[3];return Math.hypot(e,r,n,t)}function d(t){var e=t[0],r=t[1],n=t[2],t=t[3];return e*e+r*r+n*n+t*t}r.sub=a,r.mul=i,r.div=u,r.dist=h,r.sqrDist=l,r.len=f,r.sqrLen=d;var _,t=(_=n(),function(t,e,r,n,a,i){var o,s;for(e=e||4,r=r||0,s=n?Math.min(n*e+r,t.length):t.length,o=r;o<s;o+=e)_[0]=t[o],_[1]=t[o+1],_[2]=t[o+2],_[3]=t[o+3],a(_,_,i),t[o]=_[0],t[o+1]=_[1],t[o+2]=_[2],t[o+3]=_[3];return t});r.forEach=t},{"./common.js":1}],12:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=15},{}],13:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const c=t("../constants"),n=t("./generation/ChunkGenerator"),a=t("./webGLRenderer/WebGLRenderer");r.default=class{constructor(){this._touches=[],this._chunksCreated=0,this._chunksDiscarded=0,this._currFrameTime=-1,this._framesDuration=[];const r=document.getElementById("main-canvas");if(!r)throw new Error("main-canvas not found");this._renderer=new a.default(r),this._chunkGenerator=new n.default({chunkIsVisible:t=>this._renderer.chunkIsVisible(t),pointIsVisible:t=>this._renderer.pointIsVisible(t),addGeometry:t=>this._renderer.addGeometry(t),updateGeometry:(t,e)=>{this._renderer.updateGeometry(t,e)},onChunkCreated:()=>{++this._chunksCreated},onChunkDiscarded:()=>{++this._chunksDiscarded}});var t=t=>{var e=t.targetTouches,r=this._renderer.getSize();for(let t=this._touches.length=0;t<e.length;++t)this._touches.push({id:e[t].identifier,x:e[t].pageX,y:r[1]-e[t].pageY})};r.addEventListener("touchstart",t),r.addEventListener("touchend",t),r.addEventListener("touchmove",t);const e=document.getElementById("gui_fullscreen");if(!e)throw new Error("gui_fullscreen not found");e.addEventListener("click",()=>{r.requestFullscreen?r.requestFullscreen():r.webkitRequestFullscreen?r.webkitRequestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.msRequestFullscreen&&r.msRequestFullscreen()});t=()=>{let t=null,e=null;e=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement?(r.style.position="absolute",t=window.innerWidth,window.innerHeight):(r.style.position="relative",t=800,600),r.style.left="0px",r.style.top="0px",r.width=t,r.height=e,this._renderer.resize(t,e)};document.addEventListener("fullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),document.addEventListener("webkitfullscreenchange",t,!1),document.addEventListener("msfullscreenchange",t,!1),this._running=!1,this._errorGraphicContext=!1,this._renderer.setOnContextLost(()=>{console.log("on_context_lost"),this._errorGraphicContext=!0,this.stop()}),this._renderer.setOnContextRestored(()=>{console.log("on_context_restored"),this._errorGraphicContext=!1,this.start()})}async init(){await this._renderer.init()}start(){this.isRunning()||(this._running=!0,this._chunkGenerator.start(),this._tick())}stop(){this._running=!1,this._chunkGenerator.stop()}isRunning(){return this._running&&!this._errorGraphicContext}_tick(){const t=()=>{this._running&&!this._errorGraphicContext&&(this._main_loop(),window.requestAnimationFrame(t))};t()}_main_loop(){0<this._currFrameTime&&(a=(n=Date.now())-this._currFrameTime,this._currFrameTime=n,this._framesDuration.push(a/1e3));var r=this._renderer.getCameraPosition();this._chunkGenerator.update(r);var n=this._chunkGenerator.getChunks();this._renderer.update(n),this._renderer.renderScene(n);{var a=[Math.floor(r[0]/c.default),Math.floor(r[1]/c.default),Math.floor(r[2]/c.default)];let t=0;for(const s of n)s.visible&&++t;var e=[10,10],i=["Chunks:",`>Generated: ${this._chunksCreated}`,`>Discarded: ${this._chunksDiscarded}`,`>Live:      ${this._chunksCreated-this._chunksDiscarded}`,`>Visible:   ${t}`,"",`Coordinates: ${a[0]}/${a[1]}/${a[2]}`],o=this._renderer.getCharacterSize();for(let t=0;t<i.length;++t)this._renderer.pushText(i[t],[e[0],e[1]+o*(6-t)],1)}r=this._renderer.getFreeFlyCamera().getTimeImmobile();if(3<r){n=5<r?1:(r-3)/2;const t=this._renderer.getSize();t[0]=.75*t[0];const u=["         *---*         ","         |W/Z|         ","         *---*         ","                       ","   *---* *---* *---*   ","   |A/Q| | S | | D |   ","   *---* *---* *---*   ","","        *----*         ","        | UP |         ","        *----*         ","                       "," *----* *----* *-----* "," |LEFT| |DOWN| |RIGHT| "," *----* *----* *-----* ","","   *---------------*   ","   |MOUSE SUPPORTED|   ","   *---------------*   ","","*---------------------*","|TOUCHSCREEN SUPPORTED|","*---------------------*"];let e=0;u.forEach(t=>e=Math.max(e,t.length)),e*=this._renderer.getCharacterSize()*n;a=u.length*this._renderer.getCharacterSize()*n,r=u.join("\n"),a=[.5*t[0]-.5*e,.5*t[1]+.5*a];this._renderer.pushText(r,a,n)}this._renderer.renderHUD(this._chunkGenerator.getChunks(),this._chunkGenerator.getProcessingPositions(),this._touches,this._framesDuration),this._currFrameTime=Date.now(),100<this._framesDuration.length&&this._framesDuration.splice(0,this._framesDuration.length-100)}}},{"../constants":12,"./generation/ChunkGenerator":14,"./webGLRenderer/WebGLRenderer":15}],14:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const u=t("../../constants");var n;(t=n=n||{})[t.available=1]="available",t[t.working=2]="working";r.default=class{constructor(t){this._running=!1,this._chunks=[],this._chunkPositionQueue=[],this._geometriesPool=[],this._savedIndex=[999,999,999],this._workers=[],this._cameraPosition=[0,0,0],this._processingPositions=[],this._def=t;for(let t=0;t<2;++t)this._addWorker()}_addWorker(){const r={instance:new Worker("./dist/worker.js"),float32buffer:new Float32Array(1e6),status:n.available};r.instance.addEventListener("message",t=>{var e=t.data.position;r.float32buffer=t.data.float32buffer,r.status=n.available;for(let t=0;t<this._processingPositions.length;++t)if(this._processingPositions[t][0]===e[0]&&this._processingPositions[t][1]===e[1]&&this._processingPositions[t][2]===e[2]){this._processingPositions.splice(t,1);break}if(this._running){let t=void 0;0==this._geometriesPool.length?t=this._def.addGeometry(r.float32buffer):(t=this._geometriesPool.pop(),t&&this._def.updateGeometry(t,r.float32buffer)),t?(this._chunks.push({position:e,geometry:t,coord2d:null,visible:!1}),this._def.onChunkCreated&&this._def.onChunkCreated(),this._launchWorker()):console.log("worker: processing the result -> invalid geometry")}},!1),this._workers.push(r)}start(){this._running=!0}stop(){this._running&&(this._running=!1,this._chunkPositionQueue.length=0,this._chunks.length=0,this._geometriesPool.length=0)}update(t){if(this._running){this._cameraPosition=t;t=[Math.floor(t[0]/u.default),Math.floor(t[1]/u.default),Math.floor(t[2]/u.default)];if(0==this._chunks.length||t[0]!=this._savedIndex[0]||t[1]!=this._savedIndex[1]||t[2]!=this._savedIndex[2]){this._savedIndex[0]=t[0],this._savedIndex[1]=t[1],this._savedIndex[2]=t[2],this._chunkPositionQueue.length=0;var e=[Math.floor(t[0]-3),Math.floor(t[1]-3),Math.floor(t[2]-3)],a=[Math.floor(t[0]+3),Math.floor(t[1]+3),Math.floor(t[2]+3)];for(let t=0;t<this._chunks.length;++t){var r=[this._chunks[t].position[0]/u.default|0,this._chunks[t].position[1]/u.default|0,this._chunks[t].position[2]/u.default|0];(r[0]<e[0]||a[0]<r[0]||r[1]<e[1]||a[1]<r[1]||r[2]<e[2]||a[2]<r[2])&&(this._geometriesPool.push(this._chunks[t].geometry),this._chunks.splice(t,1),--t,this._def.onChunkDiscarded&&this._def.onChunkDiscarded())}for(let n=e[2];n<=a[2];++n)for(let r=e[1];r<=a[1];++r)for(let t=e[0];t<=a[0];++t){var i=[t*u.default,r*u.default,n*u.default];let e=!1;for(let t=0;t<this._chunks.length;++t)if(this._chunks[t].position[0]===i[0]&&this._chunks[t].position[1]===i[1]&&this._chunks[t].position[2]===i[2]){e=!0;break}e||this._chunkPositionQueue.push(i)}this._launchWorker()}}}_launchWorker(){const e=this._workers.find(t=>t.status==n.available);if(void 0!==e&&0!=this._chunkPositionQueue.length){let t=void 0;if(1==this._chunkPositionQueue.length)t=this._chunkPositionQueue.pop();else{let e=-1,r=999999,n=void 0;for(let t=0;t<this._chunkPositionQueue.length;++t){var a=this._chunkPositionQueue[t];-1!=e&&!this._def.chunkIsVisible(a)||(a=[this._cameraPosition[0]-a[0]-u.default/2,this._cameraPosition[1]-a[1]-u.default/2,this._cameraPosition[2]-a[2]-u.default/2],i=a[0],o=a[1],s=a[2],a=Math.sqrt(i*i+o*o+s*s),r<a||(e=t,r=a,n=this._chunkPositionQueue[e]))}this._chunkPositionQueue.splice(e,1),t=n}var i,o,s;void 0!==t&&(this._processingPositions.push(t),e.status=n.working,e.instance.postMessage({position:t,float32buffer:e.float32buffer},[e.float32buffer.buffer]))}}getChunks(){return this._chunks}getProcessingPositions(){return this._processingPositions}}},{"../../constants":12}],15:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const h=t("../../constants"),R=t("./wrappers/WebGLContext"),l=t("./wrappers/ShaderProgram"),A=t("./wrappers/Texture"),f=t("./wrappers/Geometry"),n=t("./camera/FreeFlyCamera"),a=t("./camera/FrustumCulling"),i=t("./camera/sceneToScreenCoordinates"),d=t("./shaders/index"),_=t("./utils/generateWireframeCubeVertices"),m=t("./utils/generateWireframeFrustumVertices"),k=t("gl-matrix");r.default=class{constructor(t){this.onContextLost=null,this.onContextRestored=null,this._touchesAngle=new Map,R.default.initialise(t),t.addEventListener("webglcontextlost",t=>{t.preventDefault(),console.log("context is lost"),this.onContextLost&&this.onContextLost()},!1),t.addEventListener("webglcontextrestored",()=>{console.log("context is restored"),R.default.initialise(t),this.onContextRestored&&this.onContextRestored()},!1);var e=R.default.getViewportSize();this._freeFlyCamera=new n.default(t),this._freeFlyCamera.activate(),this._freeFlyCamera.setPosition(h.default/4*3,h.default/4*3,0),this._frustumCulling=new a.default,this._projectionMatrix=k.mat4.create(),this._modelviewMatrix=k.mat4.create(),this._aspectRatio=.75*e[0]/e[1],this._initialiseChunkRendering(),this._initialiseWireframeRendering(),this._initialiseTextRendering()}_initialiseChunkRendering(){var t=new l.default({vertexSrc:d.scene.vertex,fragmentSrc:d.scene.fragment,attributes:["a_vertexPosition","a_vertexColor","a_vertexNormal","a_vertexBCenter"],uniforms:["u_modelviewMatrix","u_projMatrix","u_cameraPos","u_sampler"]}),e={vbos:[{attrs:[{name:"a_vertexPosition",type:f.default.AttributeType.vec3f,index:0},{name:"a_vertexColor",type:f.default.AttributeType.vec3f,index:3},{name:"a_vertexNormal",type:f.default.AttributeType.vec3f,index:6},{name:"a_vertexBCenter",type:f.default.AttributeType.vec3f,index:9}],stride:48,instanced:!1}],primitiveType:f.default.PrimitiveType.triangles};this._chunkRendering={texture:new A.default,shader:t,geometryDefinition:e}}_initialiseWireframeRendering(){var t=new l.default({vertexSrc:d.color.vertex,fragmentSrc:d.color.fragment,attributes:["a_vertexPosition","a_vertexColor"],uniforms:["u_modelviewMatrix","u_projMatrix"]}),e={vbos:[{attrs:[{name:"a_vertexPosition",type:f.default.AttributeType.vec3f,index:0},{name:"a_vertexColor",type:f.default.AttributeType.vec3f,index:3}],stride:24,instanced:!1}],primitiveType:f.default.PrimitiveType.lines};let r=[];r.push(0,0,0,1,0,0,20,0,0,1,0,0),r.push(0,0,0,0,1,0,0,20,0,0,1,0),r.push(0,0,0,0,0,1,0,0,20,0,0,1);const n=new f.default.Geometry(t,e);n.updateBuffer(0,r),n.setPrimitiveCount(r.length/6),r.length=0;r.push(-5,0,0,1,1,1),r.push(25,0,0,1,1,1),r.push(0,-5,0,1,1,1),r.push(0,5,0,1,1,1),r.push(0,0,-5,1,1,1),r.push(0,0,5,1,1,1);const a=new f.default.Geometry(t,e);a.updateBuffer(0,r),a.setPrimitiveCount(r.length/6),r=_.default(h.default,[1,0,0]);const i=new f.default.Geometry(t,e);i.updateBuffer(0,r),i.setPrimitiveCount(r.length/6),r=_.default(h.default,[1,1,1]);const o=new f.default.Geometry(t,e);o.updateBuffer(0,r),o.setPrimitiveCount(r.length/6),r=_.default(h.default,[0,1,0]);const s=new f.default.Geometry(t,e);s.updateBuffer(0,r),s.setPrimitiveCount(r.length/6);var u=new f.default.Geometry(t,e);r=m.default(70,this._aspectRatio,.1,40);const c=new f.default.Geometry(t,e);c.updateBuffer(0,r),c.setPrimitiveCount(r.length/6);e={vbos:[{attrs:[{name:"a_vertexPosition",type:f.default.AttributeType.vec3f,index:0},{name:"a_vertexColor",type:f.default.AttributeType.vec3f,index:3}],stride:24,instanced:!1}],primitiveType:f.default.PrimitiveType.triangles},e=new f.default.Geometry(t,e);this._wireframeRendering={shader:t,geometry_frustum:c,geometry_axis:n,geometry_cross:a,geometry_cubeR:i,geometry_cubeW:o,geometry_cubeG:s,geometry_wireframe_stack_rendering:u,geometry_thick_line_stack_rendering:e}}_initialiseTextRendering(){var t=new l.default({vertexSrc:d.text.vertex,fragmentSrc:d.text.fragment,attributes:["a_position","a_texCoord","a_offsetPosition","a_offsetTexCoord","a_offsetScale"],uniforms:["u_modelviewMatrix","u_projectionMatrix","u_texture"]}),e={vbos:[{attrs:[{name:"a_position",type:f.default.AttributeType.vec2f,index:0},{name:"a_texCoord",type:f.default.AttributeType.vec2f,index:2}],stride:16,instanced:!1},{attrs:[{name:"a_offsetPosition",type:f.default.AttributeType.vec2f,index:0},{name:"a_offsetTexCoord",type:f.default.AttributeType.vec2f,index:2},{name:"a_offsetScale",type:f.default.AttributeType.float,index:4}],stride:20,instanced:!0}],primitiveType:f.default.PrimitiveType.triangles};const r=new f.default.Geometry(t,e);var n=[256,256],e=[16,16],e=[n[0]/e[0],n[1]/e[1]],n=[e[0]/n[0],e[1]/n[1]],a=[[[+e[0],0],[n[0],n[1]]],[[0,0],[0,n[1]]],[[+e[0],+e[1]],[n[0],0]],[[0,+e[1]],[0,0]]];const i=[];for(const s of[1,0,2,1,3,2]){var o=a[s];i.push(o[0][0],o[0][1],o[1][0],o[1][1])}r.updateBuffer(0,i),r.setPrimitiveCount(i.length/4);n=new Map([[" ",[0*n[0],0*n[1]]],["!",[+n[0],0*n[1]]],['"',[2*n[0],0*n[1]]],["#",[3*n[0],0*n[1]]],["$",[4*n[0],0*n[1]]],["%",[5*n[0],0*n[1]]],["&",[6*n[0],0*n[1]]],["'",[7*n[0],0*n[1]]],["(",[8*n[0],0*n[1]]],[")",[9*n[0],0*n[1]]],["*",[10*n[0],0*n[1]]],["+",[11*n[0],0*n[1]]],[",",[12*n[0],0*n[1]]],["-",[13*n[0],0*n[1]]],[".",[14*n[0],0*n[1]]],["/",[15*n[0],0*n[1]]],["0",[0*n[0],+n[1]]],["1",[+n[0],+n[1]]],["2",[2*n[0],+n[1]]],["3",[3*n[0],+n[1]]],["4",[4*n[0],+n[1]]],["5",[5*n[0],+n[1]]],["6",[6*n[0],+n[1]]],["7",[7*n[0],+n[1]]],["8",[8*n[0],+n[1]]],["9",[9*n[0],+n[1]]],[":",[10*n[0],+n[1]]],[";",[11*n[0],+n[1]]],["<",[12*n[0],+n[1]]],["=",[13*n[0],+n[1]]],[">",[14*n[0],+n[1]]],["?",[15*n[0],+n[1]]],["@",[0*n[0],2*n[1]]],["A",[+n[0],2*n[1]]],["B",[2*n[0],2*n[1]]],["C",[3*n[0],2*n[1]]],["D",[4*n[0],2*n[1]]],["E",[5*n[0],2*n[1]]],["F",[6*n[0],2*n[1]]],["G",[7*n[0],2*n[1]]],["H",[8*n[0],2*n[1]]],["I",[9*n[0],2*n[1]]],["J",[10*n[0],2*n[1]]],["K",[11*n[0],2*n[1]]],["L",[12*n[0],2*n[1]]],["M",[13*n[0],2*n[1]]],["N",[14*n[0],2*n[1]]],["O",[15*n[0],2*n[1]]],["P",[0*n[0],3*n[1]]],["Q",[+n[0],3*n[1]]],["R",[2*n[0],3*n[1]]],["S",[3*n[0],3*n[1]]],["T",[4*n[0],3*n[1]]],["U",[5*n[0],3*n[1]]],["V",[6*n[0],3*n[1]]],["W",[7*n[0],3*n[1]]],["X",[8*n[0],3*n[1]]],["Y",[9*n[0],3*n[1]]],["Z",[10*n[0],3*n[1]]],["[",[11*n[0],3*n[1]]],["\\",[12*n[0],3*n[1]]],["]",[13*n[0],3*n[1]]],["^",[14*n[0],3*n[1]]],["_",[15*n[0],3*n[1]]],["`",[0*n[0],4*n[1]]],["a",[+n[0],4*n[1]]],["b",[2*n[0],4*n[1]]],["c",[3*n[0],4*n[1]]],["d",[4*n[0],4*n[1]]],["e",[5*n[0],4*n[1]]],["f",[6*n[0],4*n[1]]],["g",[7*n[0],4*n[1]]],["h",[8*n[0],4*n[1]]],["i",[9*n[0],4*n[1]]],["j",[10*n[0],4*n[1]]],["k",[11*n[0],4*n[1]]],["l",[12*n[0],4*n[1]]],["m",[13*n[0],4*n[1]]],["n",[14*n[0],4*n[1]]],["o",[15*n[0],4*n[1]]],["p",[0*n[0],5*n[1]]],["q",[+n[0],5*n[1]]],["r",[2*n[0],5*n[1]]],["s",[3*n[0],5*n[1]]],["t",[4*n[0],5*n[1]]],["u",[5*n[0],5*n[1]]],["v",[6*n[0],5*n[1]]],["w",[7*n[0],5*n[1]]],["x",[8*n[0],5*n[1]]],["y",[9*n[0],5*n[1]]],["z",[10*n[0],5*n[1]]],["{",[11*n[0],5*n[1]]],["|",[12*n[0],5*n[1]]],["}",[13*n[0],5*n[1]]],["~",[14*n[0],5*n[1]]]]);this._textRendering={characterSize:16,texture:new A.default,shader:t,geometry:r,TexCoordMap:n,stack_vertices:[]}}chunkIsVisible(t){var e=.5*h.default;return this._frustumCulling.cubeInFrustum(t[0]+e,t[1]+e,t[2]+e,e)}pointIsVisible(t){return this._frustumCulling.pointInFrustum(t[0],t[1],t[2])}addGeometry(t){const e=new f.default.Geometry(this._chunkRendering.shader,this._chunkRendering.geometryDefinition);return e.updateBuffer(0,t),e.setPrimitiveCount(t.length/12),e}updateGeometry(t,e){t.updateBuffer(0,e)}getCameraPosition(){return this._freeFlyCamera.getPosition()}getFreeFlyCamera(){return this._freeFlyCamera}getCharacterSize(){return this._textRendering.characterSize}resize(t,e){const r=R.default.getViewportSize();r[0]=t,r[1]=e,this._aspectRatio=.75*r[0]/r[1];e=m.default(70,this._aspectRatio,.1,40);this._wireframeRendering.geometry_frustum.updateBuffer(0,e),this._wireframeRendering.geometry_frustum.setPrimitiveCount(e.length/6)}toggleContextLoss(){const t=R.default.getContext(),e=R.default.getExtensionLoseContext();e&&(t.isContextLost()?e.restoreContext():e.loseContext())}contextIsLost(){const t=R.default.getContext();return t.isContextLost()}setOnContextLost(t){this.onContextLost=t}setOnContextRestored(t){this.onContextRestored=t}async init(){const t=R.default.getContext();t.clearColor(0,0,0,1),t.enable(t.DEPTH_TEST),t.activeTexture(t.TEXTURE0),await this._chunkRendering.texture.load("assets/texture.png"),await this._textRendering.texture.load("assets/ascii_font.png")}getSize(){var t=R.default.getViewportSize();return[t[0],t[1]]}update(e){var t=R.default.getViewportSize();this._freeFlyCamera.handleKeys(),this._freeFlyCamera.update(1/60),k.mat4.perspective(this._projectionMatrix,70,this._aspectRatio,.1,70),this._freeFlyCamera.updateViewMatrix(this._modelviewMatrix),this._frustumCulling.calculateFrustum(this._projectionMatrix,this._modelviewMatrix);var r=[0,0,.75*t[0],t[1]];for(let t=0;t<e.length;++t){var n=e[t].position;e[t].visible=this.chunkIsVisible(n),e[t].coord2d=null,!this.pointIsVisible(n)||(n=i.default(n,this._modelviewMatrix,this._projectionMatrix,r))&&(e[t].coord2d=n)}}pushText(t,e,r){var n=[256,256],a=[this._textRendering.characterSize,this._textRendering.characterSize],i=[n[0]/a[0],n[1]/a[1]];const o=[e[0],e[1]];for(const u of t)if("\n"!=u){var s=this._textRendering.TexCoordMap.get(u);if(!s)throw new Error(`fail to find a letter, letter=${u}`);this._textRendering.stack_vertices.push(o[0],o[1],s[0],s[1],r),o[0]+=i[0]*r}else o[0]=e[0],o[1]-=i[1]*r}renderScene(e){const r=R.default.getContext();var t=R.default.getViewportSize();r.viewport(0,0,.75*t[0],t[1]),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),this._chunkRendering.shader.bind(),this._chunkRendering.texture.bind(),r.uniform1i(this._chunkRendering.shader.getUniform("u_sampler"),0),r.uniformMatrix4fv(this._chunkRendering.shader.getUniform("u_modelviewMatrix"),!1,this._modelviewMatrix),r.uniformMatrix4fv(this._chunkRendering.shader.getUniform("u_projMatrix"),!1,this._projectionMatrix);t=this._freeFlyCamera.getPosition();r.uniform3f(this._chunkRendering.shader.getUniform("u_cameraPos"),t[0],t[1],t[2]);for(let t=0;t<e.length;++t)e[t].visible&&e[t].geometry.render();this._wireframeRendering.shader.bind(),r.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_projMatrix"),!1,this._projectionMatrix),r.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,this._modelviewMatrix);var n=k.mat4.create();for(let t=0;t<e.length;++t)e[t].visible&&(k.mat4.translate(n,this._modelviewMatrix,e[t].position),r.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,n),this._wireframeRendering.geometry_cubeW.render());l.default.unbind()}renderHUD(t,e,r,n){const a=R.default.getContext();var i=R.default.getViewportSize();this._wireframeRendering.shader.bind();var o=.25*i[0],s=.75*i[0],i=.33*i[1];a.clear(a.DEPTH_BUFFER_BIT),this._renderMainHud(t,r,n),this._wireframeRendering.shader.bind(),this._renderSideHud(t,e,[s,0*i,o,i],[1,1.2,1],[0,0,1]),this._renderSideHud(t,e,[s,i,o,i],[0,1,0],[0,0,1]),this._renderSideHud(t,e,[s,2*i,o,i],[0,0,1],[0,1,0]),l.default.unbind()}_renderMainHud(t,e,r){const n=R.default.getContext();var a=R.default.getViewportSize(),i=.75*a[0],o=a[1];n.viewport(0,0,i,o);var s=k.mat4.create();k.mat4.ortho(s,.5*-i,.5*i,.5*-o,.5*+o,-200,200);var u=k.mat4.create();k.mat4.lookAt(u,[.5*i,.5*+o,1],[.5*i,.5*+o,0],[0,1,0]),n.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,u),n.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_projMatrix"),!1,s);{const p=[];var c=[100,50],h=[10,a[1]-10-c[1]];p.push(h[0],h[1],0,1,1,1),p.push(h[0]+c[0],h[1],0,1,1,1),p.push(h[0]+c[0],h[1],0,1,1,1),p.push(h[0]+c[0],h[1]+c[1],0,1,1,1),p.push(h[0]+c[0],h[1]+c[1],0,1,1,1),p.push(h[0],h[1]+c[1],0,1,1,1),p.push(h[0],h[1]+c[1],0,1,1,1),p.push(h[0],h[1],0,1,1,1);for(let t=1;t<r.length;++t){var l=(t-1)/r.length,f=t/r.length,d=Math.min(r[t-1],1/30)/(1/30),_=Math.min(r[t],1/30)/(1/30);p.push(h[0]+c[0]*l,h[1]+c[1]*d,0,1,1,1),p.push(h[0]+c[0]*f,h[1]+c[1]*_,0,1,1,1)}{let t=0;for(const M of r)t+=M;t/=r.length;const g=1/t;let e="999";g<999&&(e=g.toFixed(0).padStart(3," ")),this.pushText(`${e}fps`,[h[0],h[1]-this._textRendering.characterSize],1)}this._wireframeRendering.geometry_wireframe_stack_rendering.updateBuffer(0,p),this._wireframeRendering.geometry_wireframe_stack_rendering.setPrimitiveCount(p.length/6),this._wireframeRendering.geometry_wireframe_stack_rendering.render()}{const b=[];{var m=(t,e,r,n,a=[1,1,1])=>{var i;[i,t,r,e=[1,1,1]]=[[t[0]-r*Math.cos(e),t[1]-r*Math.sin(e)],[t[0]+r*Math.cos(e),t[1]+r*Math.sin(e)],n,a],n=Math.atan2(t[1]-i[1],t[0]-i[0])+.5*Math.PI,a=Math.cos(n)*r*.5,r=Math.sin(n)*r*.5,r=[[i[0]-a,i[1]-r],[i[0]+a,i[1]+r],[t[0]-a,t[1]-r],[t[0]+a,t[1]+r]],b.push(r[0][0],r[0][1],0,e[0],e[1],e[2]),b.push(r[3][0],r[3][1],0,e[0],e[1],e[2]),b.push(r[2][0],r[2][1],0,e[0],e[1],e[2]),b.push(r[0][0],r[0][1],0,e[0],e[1],e[2]),b.push(r[1][0],r[1][1],0,e[0],e[1],e[2]),b.push(r[3][0],r[3][1],0,e[0],e[1],e[2])};const y=new Set;for(const P of e){y.add(P.id);let t=this._touchesAngle.get(P.id);void 0===t&&(t=0,this._touchesAngle.set(P.id,t));var v=[1,0,0];const w=[t,t+.5*Math.PI];this._freeFlyCamera.getForceForward()&&(w.push(t+.25*Math.PI),w.push(t+.75*Math.PI));for(const E of w)m([P.x,P.y],E,150,15,v);t+=.1,this._touchesAngle.set(P.id,t)}const x=new Set;this._touchesAngle.forEach((t,e)=>{y.has(e)||x.add(e)}),x.forEach(t=>{this._touchesAngle.delete(t)})}this._wireframeRendering.geometry_thick_line_stack_rendering.updateBuffer(0,b),this._wireframeRendering.geometry_thick_line_stack_rendering.setPrimitiveCount(b.length/6),this._wireframeRendering.geometry_thick_line_stack_rendering.render()}this._textRendering.shader.bind(),this._textRendering.texture.bind(),n.uniformMatrix4fv(this._textRendering.shader.getUniform("u_modelviewMatrix"),!1,u),n.uniformMatrix4fv(this._textRendering.shader.getUniform("u_projectionMatrix"),!1,s),this._textRendering.geometry.updateBuffer(1,this._textRendering.stack_vertices,!0),this._textRendering.geometry.setInstancedCount(this._textRendering.stack_vertices.length/5),this._textRendering.geometry.render(),A.default.unbind(),this._textRendering.stack_vertices.length=0}_renderSideHud(e,r,t,n,a){const i=R.default.getContext();i.viewport(t[0],t[1],t[2],t[3]);var o=k.mat4.create(),t=t[2]/t[3];k.mat4.ortho(o,-65*t,65*t,-65,65,-200,200);var t=this._freeFlyCamera.getPosition(),s=k.mat4.create();k.mat4.lookAt(s,[t[0]+n[0],t[1]+n[1],t[2]+n[2]],t,a),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,s),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_projMatrix"),!1,o),this._wireframeRendering.geometry_axis.render();var u=k.mat4.create();for(let t=0;t<e.length;++t){var c=e[t].position;k.mat4.identity(u),e[t].visible?(k.mat4.translate(u,s,c),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,u),this._wireframeRendering.geometry_cubeW.render()):(c=[c[0]+.15*h.default,c[1]+.15*h.default,c[2]+.15*h.default],k.mat4.translate(u,s,c),k.mat4.scale(u,u,[.7,.7,.7]),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,u),this._wireframeRendering.geometry_cubeR.render())}if(0<r.length)for(let t=0;t<r.length;++t)k.mat4.translate(u,s,[r[t][0]+.2*h.default,r[t][1]+.2*h.default,r[t][2]+.2*h.default]),k.mat4.scale(u,u,[.6,.6,.6]),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,u),this._wireframeRendering.geometry_cubeG.render();k.mat4.translate(s,s,this._freeFlyCamera.getPosition()),k.mat4.rotate(s,s,this._freeFlyCamera.getTheta()*Math.PI/180,[0,0,1]),k.mat4.rotate(s,s,this._freeFlyCamera.getPhi()*Math.PI/180,[0,-1,0]),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,s),this._wireframeRendering.geometry_cross.render(),this._wireframeRendering.geometry_frustum.render()}}},{"../../constants":12,"./camera/FreeFlyCamera":16,"./camera/FrustumCulling":17,"./camera/sceneToScreenCoordinates":20,"./shaders/index":22,"./utils/generateWireframeCubeVertices":25,"./utils/generateWireframeFrustumVertices":26,"./wrappers/Geometry":27,"./wrappers/ShaderProgram":28,"./wrappers/Texture":29,"./wrappers/WebGLContext":30,"gl-matrix":2}],16:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=t("gl-matrix"),i=t("./helpers/KeyboardHandler"),o=t("./helpers/PointerLockSetup");r.default=class{constructor(t){this._phi=0,this._theta=0,this._forward=[1,0,0],this._left=[0,0,0],this._position=[0,0,0],this._target=[0,0,0],this._movement_flag=0,this._keyboard_handler=new i.KeyboardHandler,this._force_forward=!1,this._time_immobile=0,this._last_time=0,this._last_time=Date.now();const e=t=>{var e=t.movementX||t.mozMovementX||t.webkitMovementX||0,t=t.movementY||t.mozMovementY||t.webkitMovementY||0;this._theta-=e/5,this._phi-=t/5,this._time_immobile=0};o.default({target_element:t,cb_enabled:()=>{t.addEventListener("mousemove",e,!1)},cb_disabled:()=>{t.removeEventListener("mousemove",e,!1)}});let n=null,a=null,r=Date.now();t.addEventListener("touchstart",t=>{t.preventDefault(),n=null,a=null;var e=Date.now();1==t.targetTouches.length&&e-r<250&&(this._force_forward=!0),r=e}),t.addEventListener("touchend",t=>{t.preventDefault(),n=null,a=null,this._force_forward=!1}),t.addEventListener("touchmove",t=>{t.preventDefault();var e,r,t=t.targetTouches;0==t.length||2<t.length||(2==t.length?(r=t[0].pageX-t[1].pageX,e=t[0].pageY-t[1].pageY,r=Math.sqrt(r*r+e*e),a&&(r>a?this._movement_flag|=1:this._movement_flag|=2),a=r):(n&&(e=n.pageX-t[0].pageX,r=n.pageY-t[0].pageY,this._theta-=e/3,this._phi-=r/3),n=t[0]),this._time_immobile=0)})}update(e){this.handleKeys();var t=Date.now();this._time_immobile+=e,3e3<t-this._last_time&&(this._time_immobile=10),this._last_time=t,this._force_forward&&(this._time_immobile=0);if(1&this._movement_flag||1==this._force_forward)for(let t=0;t<3;++t)this._position[t]+=this._forward[t]*e*16;else if(2&this._movement_flag)for(let t=0;t<3;++t)this._position[t]-=this._forward[t]*e*16;if(4&this._movement_flag)for(let t=0;t<3;++t)this._position[t]-=this._left[t]*e*16;else if(8&this._movement_flag)for(let t=0;t<3;++t)this._position[t]+=this._left[t]*e*16;this._movement_flag=0;this._phi=Math.min(Math.max(this._phi,-89),89);const r=[0,0,1];t=Math.cos(3.14*(this._phi-90)/180);r[2]=Math.sin(3.14*(this._phi-90)/180),r[0]=t*Math.cos(3.14*this._theta/180),r[1]=t*Math.sin(3.14*this._theta/180);t=Math.cos(3.14*this._phi/180);this._forward[2]=Math.sin(3.14*this._phi/180),this._forward[0]=t*Math.cos(3.14*this._theta/180),this._forward[1]=t*Math.sin(3.14*this._theta/180),this._left[0]=r[1]*this._forward[2]-r[2]*this._forward[1],this._left[1]=r[2]*this._forward[0]-r[0]*this._forward[2],this._left[2]=r[0]*this._forward[1]-r[1]*this._forward[0],this._target[0]=this._position[0]+this._forward[0],this._target[1]=this._position[1]+this._forward[1],this._target[2]=this._position[2]+this._forward[2]}updateViewMatrix(t){n.mat4.lookAt(t,[this._position[0],this._position[1],this._position[2]],[this._target[0],this._target[1],this._target[2]],[0,0,1])}setPosition(t,e,r){this._position[0]=t,this._position[1]=e,this._position[2]=r}getPosition(){return[this._position[0],this._position[1],this._position[2]]}getTheta(){return this._theta}getPhi(){return this._phi}getForceForward(){return this._force_forward}getTimeImmobile(){return this._time_immobile}handleKeys(){(this._keyboard_handler.isPressed(i.keyCodes.KEY_Z)||this._keyboard_handler.isPressed(i.keyCodes.KEY_W))&&(this._movement_flag|=1,this._time_immobile=0),this._keyboard_handler.isPressed(i.keyCodes.KEY_S)&&(this._movement_flag|=2,this._time_immobile=0),(this._keyboard_handler.isPressed(i.keyCodes.KEY_A)||this._keyboard_handler.isPressed(i.keyCodes.KEY_Q))&&(this._movement_flag|=4,this._time_immobile=0),this._keyboard_handler.isPressed(i.keyCodes.KEY_D)&&(this._movement_flag|=8,this._time_immobile=0),this._keyboard_handler.isPressed(i.keyCodes.ARROW_UP)&&(this._phi++,this._time_immobile=0),this._keyboard_handler.isPressed(i.keyCodes.ARROW_DOWN)&&(this._phi--,this._time_immobile=0),this._keyboard_handler.isPressed(i.keyCodes.ARROW_LEFT)&&(this._theta++,this._time_immobile=0),this._keyboard_handler.isPressed(i.keyCodes.ARROW_RIGHT)&&(this._theta--,this._time_immobile=0)}activate(){this._keyboard_handler.activate()}deactivate(){this._keyboard_handler.deactivate()}}},{"./helpers/KeyboardHandler":18,"./helpers/PointerLockSetup":19,"gl-matrix":2}],17:[function(t,e,r){"use strict";var n,o,a;Object.defineProperty(r,"__esModule",{value:!0}),(a=n=n||{})[a.Right=0]="Right",a[a.Left=1]="Left",a[a.Bottom=2]="Bottom",a[a.Top=3]="Top",a[a.Back=4]="Back",a[a.Front=5]="Front",(a=o=o||{})[a.A=0]="A",a[a.B=1]="B",a[a.C=2]="C",a[a.D=3]="D";r.default=class{constructor(){this._Frustum=new Float32Array(24)}normalizePlane(t){var e=4*t,t=Math.sqrt(this._Frustum[e+o.A]*this._Frustum[e+o.A]+this._Frustum[e+o.B]*this._Frustum[e+o.B]+this._Frustum[e+o.C]*this._Frustum[e+o.C]);this._Frustum[e+o.A]/=t,this._Frustum[e+o.B]/=t,this._Frustum[e+o.C]/=t,this._Frustum[e+o.D]/=t}calculateFrustum(t,e){const r=new Float32Array(16);r[0]=e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12],r[1]=e[0]*t[1]+e[1]*t[5]+e[2]*t[9]+e[3]*t[13],r[2]=e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+e[3]*t[14],r[3]=e[0]*t[3]+e[1]*t[7]+e[2]*t[11]+e[3]*t[15],r[4]=e[4]*t[0]+e[5]*t[4]+e[6]*t[8]+e[7]*t[12],r[5]=e[4]*t[1]+e[5]*t[5]+e[6]*t[9]+e[7]*t[13],r[6]=e[4]*t[2]+e[5]*t[6]+e[6]*t[10]+e[7]*t[14],r[7]=e[4]*t[3]+e[5]*t[7]+e[6]*t[11]+e[7]*t[15],r[8]=e[8]*t[0]+e[9]*t[4]+e[10]*t[8]+e[11]*t[12],r[9]=e[8]*t[1]+e[9]*t[5]+e[10]*t[9]+e[11]*t[13],r[10]=e[8]*t[2]+e[9]*t[6]+e[10]*t[10]+e[11]*t[14],r[11]=e[8]*t[3]+e[9]*t[7]+e[10]*t[11]+e[11]*t[15],r[12]=e[12]*t[0]+e[13]*t[4]+e[14]*t[8]+e[15]*t[12],r[13]=e[12]*t[1]+e[13]*t[5]+e[14]*t[9]+e[15]*t[13],r[14]=e[12]*t[2]+e[13]*t[6]+e[14]*t[10]+e[15]*t[14],r[15]=e[12]*t[3]+e[13]*t[7]+e[14]*t[11]+e[15]*t[15];t=4*n.Right;this._Frustum[t+o.A]=r[3]-r[0],this._Frustum[t+o.B]=r[7]-r[4],this._Frustum[t+o.C]=r[11]-r[8],this._Frustum[t+o.D]=r[15]-r[12],this.normalizePlane(n.Right),t=4*n.Left,this._Frustum[t+o.A]=r[3]+r[0],this._Frustum[t+o.B]=r[7]+r[4],this._Frustum[t+o.C]=r[11]+r[8],this._Frustum[t+o.D]=r[15]+r[12],this.normalizePlane(n.Left),t=4*n.Bottom,this._Frustum[t+o.A]=r[3]+r[1],this._Frustum[t+o.B]=r[7]+r[5],this._Frustum[t+o.C]=r[11]+r[9],this._Frustum[t+o.D]=r[15]+r[13],this.normalizePlane(n.Bottom),t=4*n.Top,this._Frustum[t+o.A]=r[3]-r[1],this._Frustum[t+o.B]=r[7]-r[5],this._Frustum[t+o.C]=r[11]-r[9],this._Frustum[t+o.D]=r[15]-r[13],this.normalizePlane(n.Top),t=4*n.Back,this._Frustum[t+o.A]=r[3]-r[2],this._Frustum[t+o.B]=r[7]-r[6],this._Frustum[t+o.C]=r[11]-r[10],this._Frustum[t+o.D]=r[15]-r[14],this.normalizePlane(n.Back),t=4*n.Front,this._Frustum[t+o.A]=r[3]+r[2],this._Frustum[t+o.B]=r[7]+r[6],this._Frustum[t+o.C]=r[11]+r[10],this._Frustum[t+o.D]=r[15]+r[14],this.normalizePlane(n.Front)}sphereInFrustum(e,r,n,a){for(let t=0;t<6;++t)if(this._Frustum[4*t+o.A]*e+this._Frustum[4*t+o.B]*r+this._Frustum[4*t+o.C]*n+this._Frustum[4*t+o.D]<=a)return!1;return!0}pointInFrustum(t,e,r){return this.sphereInFrustum(t,e,r,0)}cubeInFrustum(e,r,n,a){for(let t=0;t<6;++t){var i=4*t;if(!(0<this._Frustum[i+o.A]*(e-a)+this._Frustum[i+o.B]*(r-a)+this._Frustum[i+o.C]*(n-a)+this._Frustum[i+o.D])&&!(0<this._Frustum[i+o.A]*(e+a)+this._Frustum[i+o.B]*(r-a)+this._Frustum[i+o.C]*(n-a)+this._Frustum[i+o.D]||0<this._Frustum[i+o.A]*(e-a)+this._Frustum[i+o.B]*(r+a)+this._Frustum[i+o.C]*(n-a)+this._Frustum[i+o.D]||0<this._Frustum[i+o.A]*(e+a)+this._Frustum[i+o.B]*(r+a)+this._Frustum[i+o.C]*(n-a)+this._Frustum[i+o.D]||0<this._Frustum[i+o.A]*(e-a)+this._Frustum[i+o.B]*(r-a)+this._Frustum[i+o.C]*(n+a)+this._Frustum[i+o.D]||0<this._Frustum[i+o.A]*(e+a)+this._Frustum[i+o.B]*(r-a)+this._Frustum[i+o.C]*(n+a)+this._Frustum[i+o.D]||0<this._Frustum[i+o.A]*(e-a)+this._Frustum[i+o.B]*(r+a)+this._Frustum[i+o.C]*(n+a)+this._Frustum[i+o.D]||0<this._Frustum[i+o.A]*(e+a)+this._Frustum[i+o.B]*(r+a)+this._Frustum[i+o.C]*(n+a)+this._Frustum[i+o.D]))return!1}return!0}}},{}],18:[function(t,e,r){"use strict";var n,a;Object.defineProperty(r,"__esModule",{value:!0}),r.KeyboardHandler=r.keyCodes=void 0,(a=n=n||{}).KEY_Z="z",a.KEY_W="w",a.KEY_S="s",a.KEY_A="a",a.KEY_Q="q",a.KEY_D="d",a.ARROW_LEFT="ArrowLeft",a.ARROW_RIGHT="ArrowRight",a.ARROW_UP="ArrowUp",a.ARROW_DOWN="ArrowDown",r.keyCodes=n;r.KeyboardHandler=class{constructor(){this._pressedKeys=new Map,this._activated=!1;const e=[n.ARROW_LEFT,n.ARROW_RIGHT,n.ARROW_UP,n.ARROW_DOWN];this._activated=!1,this._handleKeyDown=(t=>{-1!=e.indexOf(t.key)&&t.preventDefault(),this._pressedKeys.set(t.key,!0)}).bind(this),this._handleKeyUp=(t=>{-1!=e.indexOf(t.key)&&t.preventDefault(),this._pressedKeys.set(t.key,!1)}).bind(this)}isPressed(t){return this._pressedKeys.get(t)||!1}activate(){this._activated||(document.addEventListener("keydown",this._handleKeyDown),document.addEventListener("keyup",this._handleKeyUp),this._activated=!0)}deactivate(){this._activated&&(document.removeEventListener("keydown",this._handleKeyDown),document.removeEventListener("keyup",this._handleKeyUp),this._activated=!1)}}},{}],19:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=e=>{e.target_element.requestPointerLock=e.target_element.requestPointerLock||e.target_element.mozRequestPointerLock||e.target_element.webkitRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,e.target_element.onclick=()=>{e.target_element.requestPointerLock&&e.target_element.requestPointerLock()};var t=()=>{document.pointerLockElement===e.target_element||document.mozPointerLockElement===e.target_element||document.webkitPointerLockElement===e.target_element?(console.log("The pointer lock status is now locked"),e.cb_enabled()):(console.log("The pointer lock status is now unlocked"),e.cb_disabled())},r=t=>{console.error("Pointer lock failed"),console.error(t),e.cb_error&&e.cb_error(t)};"onpointerlockchange"in document?document.addEventListener("pointerlockchange",t,!1):"onmozpointerlockchange"in document?document.addEventListener("mozpointerlockchange",t,!1):"onwebkitpointerlockchange"in document&&document.addEventListener("webkitpointerlockchange",t,!1),"onpointerlockerror"in document?document.addEventListener("pointerlockerror",r,!1):"onmozpointerlockerror"in document?document.addEventListener("mozpointerlockerror",r,!1):"onwebkitpointerlockerror"in document&&document.addEventListener("webkitpointerlockerror",r,!1)}},{}],20:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=t("gl-matrix");r.default=(t,e,r,n)=>{var a=o.vec4.fromValues(t[0],t[1],t[2],1),t=o.mat4.create();const i=o.vec4.create();return o.mat4.multiply(t,r,e),o.vec4.transformMat4(i,a,t),0===i[3]?null:(i[3]=1/i[3],i[0]*=i[3],i[1]*=i[3],i[2]*=i[3],[(.5*i[0]+.5)*n[2]+n[0],(.5*i[1]+.5)*n[3]+n[1]])}},{"gl-matrix":2}],21:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fragment=r.vertex=void 0;r.vertex=`

attribute vec3 a_vertexPosition;
attribute vec3 a_vertexColor;

varying vec4 v_color;

uniform mat4 u_modelviewMatrix;
uniform mat4 u_projMatrix;

void main(void)
{
    v_color = vec4(a_vertexColor,1.0);

    gl_Position = u_projMatrix * u_modelviewMatrix * vec4(a_vertexPosition, 1.0);
}
`;r.fragment=`

precision mediump float;

varying vec4 v_color;

void main(void)
{
    gl_FragColor = v_color;
}
`},{}],22:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.color=t("./color"),r.scene=t("./scene"),r.text=t("./text")},{"./color":21,"./scene":23,"./text":24}],23:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fragment=r.vertex=void 0;r.vertex=`

attribute vec3 a_vertexPosition;
attribute vec3 a_vertexColor;
attribute vec3 a_vertexNormal;
attribute vec3 a_vertexBCenter;

uniform mat4 u_modelviewMatrix;
uniform mat4 u_projMatrix;
uniform vec3 u_cameraPos;

varying vec3 v_color;
varying vec3 v_baryCenter;

varying vec3 v_normalInterp;
varying vec3 v_vertPos;
varying float v_distanceToCamera;

varying vec3 v_pureVertexPos;
varying vec3 v_pureNormalInterp;

const float k_rangeMin = 20.0;
const float k_rangeMax = 23.0;

void main(void)
{
    vec4 vertPos4 = u_modelviewMatrix * vec4(a_vertexPosition, 1.0);
    v_vertPos = vec3(vertPos4) / vertPos4.w;
    v_normalInterp = vec3(u_modelviewMatrix * vec4(a_vertexNormal, 0.0));

    v_pureVertexPos = a_vertexPosition;
    v_pureNormalInterp = a_vertexNormal;

    float distanceToCamera = length(a_vertexPosition - u_cameraPos);

    v_distanceToCamera = distanceToCamera;

    v_color = a_vertexColor;
    v_baryCenter = a_vertexBCenter;

    if (distanceToCamera < k_rangeMin ||
        distanceToCamera > k_rangeMax)
    {
        gl_Position = u_projMatrix * u_modelviewMatrix * vec4(a_vertexPosition, 1.0);
    }
    else
    {
        // bump effect -> bump in the direction of the normal

        gl_Position = u_projMatrix * u_modelviewMatrix * vec4(a_vertexPosition + a_vertexNormal, 1.0);
    }
}
`;r.fragment=`

precision mediump float;

uniform sampler2D u_sampler;

varying vec3 v_color;
varying vec3 v_baryCenter;

varying vec3 v_normalInterp;
varying vec3 v_vertPos;
varying float v_distanceToCamera;

varying vec3 v_pureVertexPos;
varying vec3 v_pureNormalInterp;

const vec3 k_lightPos = vec3(0.0,0.0,0.0);
const vec3 k_specColor = vec3(1.0, 1.0, 1.0);

const float k_rangeMin = 20.0;
const float k_rangeMax = 23.0;

void main(void)
{

    { // wireframe

        if (gl_FrontFacing)
        {
            // "bumped wireframe" effect on the front facing

            if (v_distanceToCamera > k_rangeMin &&
                v_distanceToCamera < k_rangeMax)
            {

                if (all(greaterThan(v_baryCenter, vec3(0.03))) &&
                    any(lessThan(v_baryCenter, vec3(0.08))))
                {
                    gl_FragColor = vec4(v_color, 1.0);
                    return;
                }

            }

        }
        else
        {
            // normal wireframe effect on the back facing

            if (any(lessThan(v_baryCenter, vec3(0.06))))
            {
                gl_FragColor = vec4(1);
                return;
            }
        }

        // wireframe only for the backface
        if (!gl_FrontFacing)
            discard;

    } // /wireframe

    vec3 currentColor = v_color;

    { // texture

        // current 3d texture coordinate
        vec3 flooredPos = vec3(
            v_pureVertexPos.x - floor(v_pureVertexPos.x),
            v_pureVertexPos.y - floor(v_pureVertexPos.y),
            v_pureVertexPos.z - floor(v_pureVertexPos.z)
        );

        vec3 blend_weights = abs( normalize( v_pureNormalInterp.xyz ) );
        blend_weights = max( ( blend_weights - 0.2 ) * 7.0, 0.0 );
        blend_weights /= ( blend_weights.x + blend_weights.y + blend_weights.z );

        // horizontal texture coordinates -> should be a wall
        vec2 texcoord1 = vec2(flooredPos.y * 0.5 + 0.5, flooredPos.z * 0.5);
        vec2 texcoord2 = vec2(flooredPos.x * 0.5 + 0.5, flooredPos.z * 0.5);

        // vertical texture coord -> should be green grass
        vec2 texcoord3 = vec2(flooredPos.x * 0.5, flooredPos.y * 0.5 + 0.5);

        if (v_pureNormalInterp.z < 0.0)
        {
            // switch the texture Y -> dirt on the ceilling instead of grass
            texcoord3.y -= 0.5;
        }

        // horizontal color
        vec3 texColor1 = texture2D( u_sampler, texcoord1 ).rgb;
        vec3 texColor2 = texture2D( u_sampler, texcoord2 ).rgb;

        // vertical color
        vec3 texColor3 = texture2D( u_sampler, texcoord3 ).rgb;

        currentColor = texColor1 * blend_weights.xxx +
                    texColor2 * blend_weights.yyy +
                    texColor3 * blend_weights.zzz;

    } // texture

    { // lighting

        vec3 normal = normalize(v_normalInterp);
        vec3 lightDir = normalize(k_lightPos - v_vertPos);

        float lambertian = max(dot(lightDir,v_normalInterp.xyz), 0.0);
        float specular = 0.0;

        if (lambertian > 0.0)
        {
            // lighting specular

            vec3 reflectDir = reflect(-lightDir, normal);
            vec3 viewDir = normalize(-v_vertPos);

            float specAngle = max(dot(reflectDir, viewDir), 0.0);
            specular = pow(specAngle, 16.0);
        }

        // lighting output

        vec3 ambiant_color = currentColor.xyz * 0.05;
        vec3 diffuse_color = currentColor.xyz * lambertian;
        vec3 specular_color = k_specColor * specular;

        currentColor = ambiant_color + diffuse_color + specular_color;

    } // lighting

    gl_FragColor = vec4(currentColor, 1.0);
}
`},{}],24:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fragment=r.vertex=void 0;r.vertex=`

precision mediump float;

uniform mat4 u_modelviewMatrix;
uniform mat4 u_projectionMatrix;


attribute vec2 a_position;
attribute vec2 a_texCoord;
attribute vec2 a_offsetPosition;
attribute vec2 a_offsetTexCoord;
attribute float a_offsetScale;

varying vec2 v_texCoord;

void main(void)
{
    vec2 position = a_position * a_offsetScale + a_offsetPosition;

    gl_Position = u_projectionMatrix * u_modelviewMatrix * vec4(position, 0.0, 1.0);

    v_texCoord = a_texCoord + a_offsetTexCoord;
}
`;r.fragment=`

precision mediump float;

uniform sampler2D u_texture;

varying vec2 v_texCoord;

void main(void)
{
    gl_FragColor = texture2D(u_texture, v_texCoord);
}

`},{}],25:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=(t,e,r=!1)=>{var n=t/2,t=t/2.1,a=[n,n,n,-n,n,n,n,-n,n,-n,-n,n,n,n,-n,-n,n,-n,n,-n,-n,-n,-n,-n,t,t,t,-t,t,t,t,-t,t,-t,-t,t,t,t,-t,-t,t,-t,t,-t,-t,-t,-t,-t];const i=[0,1,1,3,3,2,2,0,4,5,5,7,7,6,6,4,0,4,1,5,3,7,2,6,8,9,9,11,11,10,10,8,12,13,13,15,15,14,14,12,8,12,9,13,11,15,10,14];r&&(i.length/=2);const o=[];for(let t=0;t<i.length;++t){var s=3*i[t];for(let t=0;t<3;++t)o.push(a[s+t]+n);for(let t=0;t<3;++t)o.push(e[t])}return o}},{}],26:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=(t,e,r,n)=>{var a=Math.tan(t/360*Math.PI)*r,i=a*e,o=-i,s=+i,i=+a,a=-a,t=n*Math.sin(t*Math.PI/180),e=t*e,u=[r,o,i,r,s,i,r,o,a,r,s,a,n,-e,+t,n,+e,+t,n,-e,-t,n,+e,-t,n,1.66*-e,-t,n,1.66*-e,+t],c=[0,1,1,3,3,2,2,0,0,4,1,5,2,6,3,7,4,5,5,7,7,6,6,4,8,9,7,8,5,9];const h=[];for(let t=0;t<c.length;++t){var l=3*c[t];for(let t=0;t<3;++t)h.push(u[l+t]);h.push(1,1,0)}return h}},{}],27:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const p=t("./WebGLContext");var n;!function(_){_.BytesPerPixel=4;let m;var t;(t=m=_.AttributeType||(_.AttributeType={}))[t.float=0]="float",t[t.vec2f=1]="vec2f",t[t.vec3f=2]="vec3f",t[t.vec4f=3]="vec4f",t[t.mat3f=4]="mat3f",t[t.mat4f=5]="mat4f";let v;(t=v=_.PrimitiveType||(_.PrimitiveType={}))[t.lines=0]="lines",t[t.triangles=1]="triangles";_.Geometry=class{constructor(t,e){this._primitiveStart=0,this._primitiveCount=0,this._instanceCount=0,this._isInstanced=!1;const a=p.default.getContext();if(0===e.vbos.length)throw new Error("empty vbo defintion");for(const n of e.vbos){if(0===n.attrs.length)throw new Error("empty vbo attribute defintion");for(const h of n.attrs)if(!t.hasAttribute(h.name))throw new Error(`attribute not found, name="${h.name}"`)}switch((this._def=e).primitiveType){case v.lines:this._primitiveType=a.LINES;break;case v.triangles:this._primitiveType=a.TRIANGLES;break;default:throw new Error("primitive type not found")}const r=p.default.getExtensionVaoStrict(),i=p.default.getExtensionInstancingStrict();e=r.createVertexArrayOES();if(!e)throw new Error("fail o create a vao unit");this._vao=e,r.bindVertexArrayOES(this._vao),this._vbos=[];for(const l of this._def.vbos){var o=a.createBuffer();if(!o)throw new Error("fail o create a vbo unit");this._vbos.push(o),a.bindBuffer(a.ARRAY_BUFFER,o);let n=l.stride||0;if(!n){for(const f of l.attrs)switch(f.type){case m.float:n+=1;break;case m.vec2f:n+=2;break;case m.vec3f:n+=3;break;case m.vec4f:n+=4;break;case m.mat3f:n+=9;break;case m.mat4f:n+=16}n*=_.BytesPerPixel}for(const d of l.attrs){let e=1,r=1;switch(d.type){case m.float:e=1,r=1;break;case m.vec2f:e=2,r=1;break;case m.vec3f:e=3,r=1;break;case m.vec4f:e=4,r=1;break;case m.mat3f:e=3,r=3;break;case m.mat4f:e=4,r=4}var s=t.getAttribute(d.name);for(let t=0;t<r;++t){var u=s+t,c=(d.index+t*e)*_.BytesPerPixel;a.enableVertexAttribArray(u),a.vertexAttribPointer(u,e,a.FLOAT,!1,n,c),!0===l.instanced&&(i.vertexAttribDivisorANGLE(u,1),this._isInstanced=!0)}}}r.bindVertexArrayOES(null)}dispose(){const e=p.default.getContext(),t=p.default.getExtensionVaoStrict();for(let t=0;t<this._vbos.length;++t)e.deleteBuffer(this._vbos[t]);t.deleteVertexArrayOES(this._vao)}updateBuffer(t,e,r=!1){if(t<0||t>=this._vbos.length)throw new Error("no buffer avaialble to tha index");const n=p.default.getContext();t=this._vbos[t],e=e instanceof Float32Array?e:new Float32Array(e),r=r?n.DYNAMIC_DRAW:n.STATIC_DRAW;n.bindBuffer(n.ARRAY_BUFFER,t),n.bufferData(n.ARRAY_BUFFER,e,r),n.bindBuffer(n.ARRAY_BUFFER,null)}render(){if(!(0==this._primitiveCount||this._isInstanced&&0==this._instanceCount)){const t=p.default.getContext(),e=p.default.getExtensionVaoStrict(),r=p.default.getExtensionInstancingStrict();e.bindVertexArrayOES(this._vao),!0===this._isInstanced?r.drawArraysInstancedANGLE(this._primitiveType,this._primitiveStart,this._primitiveCount,this._instanceCount):t.drawArrays(this._primitiveType,this._primitiveStart,this._primitiveCount),e.bindVertexArrayOES(null)}}setPrimitiveStart(t){this._primitiveStart=t}setPrimitiveCount(t){this._primitiveCount=t}setInstancedCount(t){this._instanceCount=t}}}(n=n||{}),r.default=n},{"./WebGLContext":30}],28:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=t("./WebGLContext");r.default=class{constructor(t){this._attributes=new Map,this._uniforms=new Map;const e=o.default.getContext();var r=this._getShader(t.vertexSrc,e.VERTEX_SHADER),n=this._getShader(t.fragmentSrc,e.FRAGMENT_SHADER);if(this._program=e.createProgram(),!this._program)throw new Error("could not create a shader program");if(e.attachShader(this._program,r),e.attachShader(this._program,n),e.linkProgram(this._program),e.deleteShader(r),e.deleteShader(n),!e.getProgramParameter(this._program,e.LINK_STATUS)){n=e.getProgramInfoLog(this._program);throw new Error("Failed to initialised shaders, Error linking:"+n)}this._getAttribAndLocation(t.attributes,t.uniforms)}bind(){const t=o.default.getContext();t.useProgram(this._program)}static unbind(){const t=o.default.getContext();t.useProgram(null)}hasAttribute(t){return this._attributes.has(t)}getAttribute(t){var e=this._attributes.get(t);if(void 0===e)throw new Error(`attribute not found: ${t}`);return e}getUniform(t){var e=this._uniforms.get(t);if(void 0===e)throw new Error(`uniform not found: ${t}`);return e}_getAttribAndLocation(e,r){const n=o.default.getContext();if(!this._program)throw new Error("shader program not initialised");n.useProgram(this._program);for(let t=0;t<e.length;++t){var a=n.getAttribLocation(this._program,e[t]);if(a<0)throw new Error(`attribute not found => ${e[t]}`);this._attributes.set(e[t],a)}for(let t=0;t<r.length;++t){var i=n.getUniformLocation(this._program,r[t]);if(null===i)throw new Error(`uniform not found => ${r[t]}`);this._uniforms.set(r[t],i)}n.useProgram(null)}_getShader(t,e){const r=o.default.getContext();e=r.createShader(e);if(!e)throw new Error("could not create a shader");if(r.shaderSource(e,t),r.compileShader(e),r.getShaderParameter(e,r.COMPILE_STATUS))return e;{let t=r.getShaderInfoLog(e);throw t=t||"failed to compile a shader",new Error(t)}}}},{"./WebGLContext":30}],29:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=t("./WebGLContext");r.default=class{constructor(){this._width=0,this._height=0,this._texture=null}async load(t,a=!1){const i=n.default.getContext();this._texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this._texture);const o=i.RGBA;const s=i.RGBA,u=i.UNSIGNED_BYTE;var e=new Uint8Array([0,0,255,255]);return i.texImage2D(i.TEXTURE_2D,0,o,1,1,0,s,u,e),new Promise((e,r)=>{const n=new Image;n.onerror=t=>{r(t)},n.onload=()=>{this._width=n.width,this._height=n.height,i.bindTexture(i.TEXTURE_2D,this._texture),i.texImage2D(i.TEXTURE_2D,0,o,s,u,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);var t=a?i.NEAREST:i.LINEAR;i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,t),i.bindTexture(i.TEXTURE_2D,null),e()},n.src=t})}getWidth(){if(!this._texture)throw new Error("texture not initialised");return this._width}getHeight(){if(!this._texture)throw new Error("texture not initialised");return this._height}bind(){if(!this._texture)throw new Error("texture not initialised");const t=n.default.getContext();t.bindTexture(t.TEXTURE_2D,this._texture)}static unbind(){const t=n.default.getContext();t.bindTexture(t.TEXTURE_2D,null)}}},{"./WebGLContext":30}],30:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});class n{static initialise(t){if(n._gl=t.getContext("webgl",{alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!0,stencil:!1}),!n._gl)throw new Error("could not create webgl context");n._extensionVAO=n._gl.getExtension("OES_vertex_array_object")||n._gl.getExtension("MOZ_OES_vertex_array_object")||n._gl.getExtension("WEBKIT_OES_vertex_array_object"),n._extensionLoseContext=n._gl.getExtension("WEBGL_lose_context"),n._extensionInstancing=n._gl.getExtension("ANGLE_instanced_arrays"),n._viewportSize[0]=t.clientWidth,n._viewportSize[1]=t.clientHeight}static getContext(){if(!n._gl)throw new Error("webgl context not initialised");return n._gl}static getExtensionVao(){return n._extensionVAO}static getExtensionLoseContext(){return n._extensionLoseContext}static getExtensionInstancing(){return n._extensionInstancing}static getExtensionVaoStrict(){if(!n._extensionVAO)throw new Error("vao extension not available");return n._extensionVAO}static getExtensionLoseContextStrict(){if(!n._extensionLoseContext)throw new Error("lose context extension not available");return n._extensionLoseContext}static getExtensionInstancingStrict(){if(!n._extensionInstancing)throw new Error("instancing extension not available");return n._extensionInstancing}static getViewportSize(){return n._viewportSize}}n._gl=null,n._extensionVAO=null,n._extensionLoseContext=null,n._extensionInstancing=null,n._viewportSize=[0,0],r.default=n},{}],31:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),window.onerror=(...t)=>{alert(JSON.stringify(t))};const n=t("./experiment/WebGLExperiment");(async()=>{const t=new n.default;await t.init(),t.start();{const e=document.getElementById("touch_id");e&&("ontouchstart"in window?e.innerHTML+="Supported":e.innerHTML+="Not Supported")}{const r=document.getElementById("gui_toggle_start");if(!r)throw new Error("gui_toggle_start not found");r.addEventListener("click",()=>{console.log("toggle_start"),t.isRunning()?t.stop():t.start()})}})()},{"./experiment/WebGLExperiment":13}]},{},[31]);