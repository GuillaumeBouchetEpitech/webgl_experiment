!function r(o,i,a){function u(e,t){if(!i[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(s)return s(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=i[e]={exports:{}},o[e][0].call(n.exports,function(t){return u(o[e][1][t]||t)},n,n.exports,r,o,i,a)}return i[e].exports}for(var s="function"==typeof require&&require,t=0;t<a.length;t++)u(a[t]);return u}({1:[function(t,e,n){!function(o,C){"use strict";function L(t){return document.createElement(t)}function F(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function j(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function I(t,e){if("array"!==j(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function D(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(j(e[1][t])){case"object":e[0][t]=D({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?D.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function q(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function Y(t,e,n,r){t.addEventListener?t[r?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[r?"detachEvent":"attachEvent"]("on"+e,n)}var N,t;t=o.performance,N=t&&(t.now||t.webkitNow)?t[t.now?"now":"webkitNow"].bind(t):function(){return+new Date};var B=o.cancelAnimationFrame||o.cancelRequestAnimationFrame,z=o.requestAnimationFrame;!function(){for(var t=["moz","webkit","o"],r=0,e=0,n=t.length;e<n&&!B;++e)B=o[t[e]+"CancelAnimationFrame"]||o[t[e]+"CancelRequestAnimationFrame"],z=B&&o[t[e]+"RequestAnimationFrame"];B||(z=function(t){var e=N(),n=Math.max(0,16-(e-r));return r=e+n,o.setTimeout(function(){t(e+n)},n)},B=function(t){clearTimeout(t)})}();var W="string"===j(document.createElement("div").textContent)?"textContent":"innerText";function G(e,t){"object"===j(e)&&e.nodeType===C&&(t=e,e=document.body),e=e||document.body;var a,u,n,r,o,i,s,c,f,l=this,h=D({},G.defaults,t||{}),d={},m=[],_=100,p=[],v=h.threshold,g=0,b=N()-v,y=[],M=[],x="fps"===h.show;function w(t,e,n,r){return u[0|t][Math.round(Math.min((e-n)/(r-n)*_,_))]}function P(){d.legend.fps!==x&&(d.legend.fps=x,d.legend[W]=x?"FPS":"ms"),s=x?l.fps:l.duration,d.count[W]=999<s?"999+":s.toFixed(99<s?0:h.decimals)}function E(){if(n=N(),b<n-h.threshold&&(l.fps-=l.fps/Math.max(1,60*h.smoothing/h.interval),l.duration=1e3/l.fps),function(){for(c=h.history;c--;)y[c]=0===c?l.fps:y[c-1],M[c]=0===c?l.duration:M[c-1]}(),P(),h.heat){if(p.length)for(c=p.length;c--;)p[c].el.style[a[p[c].name].heatOn]=x?w(a[p[c].name].heatmap,l.fps,0,h.maxFps):w(a[p[c].name].heatmap,l.duration,h.threshold,0);if(d.graph&&a.column.heatOn)for(c=m.length;c--;)m[c].style[a.column.heatOn]=x?w(a.column.heatmap,y[c],0,h.maxFps):w(a.column.heatmap,M[c],h.threshold,0)}if(d.graph)for(f=0;f<h.history;f++)m[f].style.height=(x?y[f]?Math.round(i/h.maxFps*Math.min(y[f],h.maxFps)):0:M[f]?Math.round(i/h.threshold*Math.min(M[f],h.threshold)):0)+"px"}function k(){h.interval<20?(r=z(k),E()):(r=setTimeout(k,h.interval),o=z(E))}function R(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),l.toggle()}function A(){h.toggleOn&&Y(d.container,h.toggleOn,R,1),e.removeChild(d.container)}function O(){if(a=G.theme[h.theme],!(u=a.compiledHeatmaps||[]).length&&a.heatmaps.length){for(f=0;f<a.heatmaps.length;f++)for(u[f]=[],c=0;c<=_;c++)u[f][c]=(t=.33/_*c,e=a.heatmaps[f].saturation,n=a.heatmaps[f].lightness,i=o=r=void 0,0===(i=n<=.5?n*(1+e):n+e-n*e)?"#000":(t=i*((i-(e=2*n-i))/i)*((t*=6)-(n=Math.floor(t))),t=0===n||6===n?(r=i,o=e+t,e):1===n?(r=i-t,o=i,e):2===n?(o=i,(r=e)+t):3===n?(r=e,o=i-t,i):4===n?(r=e+t,o=e,i):(o=e,(r=i)-t),"#"+q(r)+q(o)+q(t)));a.compiledHeatmaps=u}var t,e,n,r,o,i}function S(){for(var t in d.container&&A(),O(),d.container=F(L("div"),a.container),d.count=d.container.appendChild(F(L("div"),a.count)),d.legend=d.container.appendChild(F(L("div"),a.legend)),d.graph=h.graph?d.container.appendChild(F(L("div"),a.graph)):0,p.length=0,d)d[t]&&a[t].heatOn&&p.push({name:t,el:d[t]});if(m.length=0,d.graph)for(d.graph.style.width=h.history*a.column.width+(h.history-1)*a.column.spacing+"px",c=0;c<h.history;c++)m[c]=d.graph.appendChild(F(L("div"),a.column)),m[c].style.position="absolute",m[c].style.bottom=0,m[c].style.right=c*a.column.width+c*a.column.spacing+"px",m[c].style.width=a.column.width+"px",m[c].style.height="0px";T(),P(),e.appendChild(d.container),d.graph&&(i=d.graph.clientHeight),h.toggleOn&&("click"===h.toggleOn&&(d.container.style.cursor="pointer"),Y(d.container,h.toggleOn,R))}function T(){F(d.container,h)}l.options=h,l.fps=0,l.duration=0,l.isPaused=0,l.tickStart=function(){g=N()},l.tick=function(){n=N(),v+=(n-b-v)/h.smoothing,l.fps=1e3/v,l.duration=g<b?v:n-g,b=n},l.pause=function(){return r&&(l.isPaused=1,clearTimeout(r),B(r),B(o),r=o=0),l},l.resume=function(){return r||(l.isPaused=0,k()),l},l.set=function(t,e){return h[t]=e,x="fps"===h.show,-1!==I(t,V)&&S(),-1!==I(t,U)&&T(),l},l.showDuration=function(){return l.set("show","ms"),l},l.showFps=function(){return l.set("show","fps"),l},l.toggle=function(){return l.set("show",x?"ms":"fps"),l},l.hide=function(){return l.pause(),d.container.style.display="none",l},l.show=function(){return l.resume(),d.container.style.display="block",l},l.destroy=function(){l.pause(),A(),l.tick=l.tickStart=function(){}},S(),k()}G.extend=D,(window.FPSMeter=G).defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var V=["toggleOn","theme","heat","graph","history"],U=["position","zIndex","left","top","right","bottom","margin"]}(window),function(t){"use strict";t.theme={};var e=t.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};t.theme.dark=t.extend({},e,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),t.theme.light=t.extend({},e,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),t.theme.colorful=t.extend({},e,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),t.theme.transparent=t.extend({},e,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}((window,FPSMeter))},{}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.setMatrixArrayType=function(t){n.ARRAY_TYPE=o=t},n.toRadian=function(t){return t*a},n.equals=function(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))},n.RANDOM=n.ARRAY_TYPE=n.EPSILON=void 0;var r=1e-6;n.EPSILON=r;var o="undefined"!=typeof Float32Array?Float32Array:Array;n.ARRAY_TYPE=o;var i=Math.random;n.RANDOM=i;var a=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},{}],3:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.vec4=n.vec3=n.vec2=n.quat2=n.quat=n.mat4=n.mat3=n.mat2d=n.mat2=n.glMatrix=void 0;var r=o(t("./common.js"));n.glMatrix=r;r=o(t("./mat2.js"));n.mat2=r;r=o(t("./mat2d.js"));n.mat2d=r;r=o(t("./mat3.js"));n.mat3=r;r=o(t("./mat4.js"));n.mat4=r;r=o(t("./quat.js"));n.quat=r;r=o(t("./quat2.js"));n.quat2=r;r=o(t("./vec2.js"));n.vec2=r;r=o(t("./vec3.js"));n.vec3=r;t=o(t("./vec4.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function o(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&((r=i?Object.getOwnPropertyDescriptor(t,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=t[n]);return o.default=t,e&&e.set(t,o),o}n.vec4=t},{"./common.js":2,"./mat2.js":4,"./mat2d.js":5,"./mat3.js":6,"./mat4.js":7,"./quat.js":8,"./quat2.js":9,"./vec2.js":10,"./vec3.js":11,"./vec4.js":12}],4:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.create=function(){var t=new s.ARRAY_TYPE(4);s.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0);return t[0]=1,t[3]=1,t},n.clone=function(t){var e=new s.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},n.fromValues=function(t,e,n,r){var o=new s.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},n.set=function(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t},n.transpose=function(t,e){{var n;t===e?(n=e[1],t[1]=e[2],t[2]=n):(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3])}return t},n.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],e=n*i-o*r;return e?(e=1/e,t[0]=i*e,t[1]=-r*e,t[2]=-o*e,t[3]=n*e,t):null},n.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},n.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},n.multiply=r,n.rotate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],e=Math.sin(n),n=Math.cos(n);return t[0]=r*n+i*e,t[1]=o*n+a*e,t[2]=r*-e+i*n,t[3]=o*-e+a*n,t},n.scale=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],e=n[0],n=n[1];return t[0]=r*e,t[1]=o*e,t[2]=i*n,t[3]=a*n,t},n.fromRotation=function(t,e){var n=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=n,t[2]=-n,t[3]=e,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},n.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},n.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},n.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},n.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},n.subtract=o,n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},n.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=e[0],u=e[1],t=e[2],e=e[3];return Math.abs(n-a)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-t)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(t))&&Math.abs(i-e)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(e))},n.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},n.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},n.sub=n.mul=void 0;var s=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var i;Object.prototype.hasOwnProperty.call(t,n)&&((i=o?Object.getOwnPropertyDescriptor(t,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("./common.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function r(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[0],s=n[1],e=n[2],n=n[3];return t[0]=r*u+i*s,t[1]=o*u+a*s,t[2]=r*e+i*n,t[3]=o*e+a*n,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}n.mul=r,n.sub=o},{"./common.js":2}],5:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.create=function(){var t=new h.ARRAY_TYPE(6);h.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0);return t[0]=1,t[3]=1,t},n.clone=function(t){var e=new h.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},n.fromValues=function(t,e,n,r,o,i){var a=new h.ARRAY_TYPE(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=o,a[5]=i,a},n.set=function(t,e,n,r,o,i,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=a,t},n.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],e=n*i-r*o;return e?(e=1/e,t[0]=i*e,t[1]=-r*e,t[2]=-o*e,t[3]=n*e,t[4]=(o*u-i*a)*e,t[5]=(r*a-n*u)*e,t):null},n.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},n.multiply=r,n.rotate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],e=Math.sin(n),n=Math.cos(n);return t[0]=r*n+i*e,t[1]=o*n+a*e,t[2]=r*-e+i*n,t[3]=o*-e+a*n,t[4]=u,t[5]=s,t},n.scale=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],e=n[0],n=n[1];return t[0]=r*e,t[1]=o*e,t[2]=i*n,t[3]=a*n,t[4]=u,t[5]=s,t},n.translate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],e=n[0],n=n[1];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=r*e+i*n+u,t[5]=o*e+a*n+s,t},n.fromRotation=function(t,e){var n=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=n,t[2]=-n,t[3]=e,t[4]=0,t[5]=0,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},n.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},n.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},n.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},n.subtract=o,n.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},n.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},n.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=e[0],c=e[1],f=e[2],l=e[3],t=e[4],e=e[5];return Math.abs(n-s)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-c)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-f)<=h.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(i-l)<=h.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-t)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(t))&&Math.abs(u-e)<=h.EPSILON*Math.max(1,Math.abs(u),Math.abs(e))},n.sub=n.mul=void 0;var h=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var i;Object.prototype.hasOwnProperty.call(t,n)&&((i=o?Object.getOwnPropertyDescriptor(t,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("./common.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function r(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=n[0],f=n[1],l=n[2],h=n[3],e=n[4],n=n[5];return t[0]=r*c+i*f,t[1]=o*c+a*f,t[2]=r*l+i*h,t[3]=o*l+a*h,t[4]=r*e+i*n+u,t[5]=o*e+a*n+s,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}n.mul=r,n.sub=o},{"./common.js":2}],6:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.create=function(){var t=new g.ARRAY_TYPE(9);g.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0);return t[0]=1,t[4]=1,t[8]=1,t},n.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},n.clone=function(t){var e=new g.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},n.fromValues=function(t,e,n,r,o,i,a,u,s){var c=new g.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=o,c[5]=i,c[6]=a,c[7]=u,c[8]=s,c},n.set=function(t,e,n,r,o,i,a,u,s,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.transpose=function(t,e){{var n,r,o;t===e?(n=e[1],r=e[2],o=e[5],t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=o):(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8])}return t},n.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=f*a-u*c,h=-f*i+u*s,d=c*i-a*s,e=n*l+r*h+o*d;return e?(e=1/e,t[0]=l*e,t[1]=(-f*r+o*c)*e,t[2]=(u*r-o*a)*e,t[3]=h*e,t[4]=(f*n-o*s)*e,t[5]=(-u*n+o*i)*e,t[6]=d*e,t[7]=(-c*n+r*s)*e,t[8]=(a*n-r*i)*e,t):null},n.adjoint=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],e=e[8];return t[0]=a*e-u*c,t[1]=o*c-r*e,t[2]=r*u-o*a,t[3]=u*s-i*e,t[4]=n*e-o*s,t[5]=o*i-n*u,t[6]=i*c-a*s,t[7]=r*s-n*c,t[8]=n*a-r*i,t},n.determinant=function(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],u=t[6],s=t[7],t=t[8];return e*(t*i-a*s)+n*(-t*o+a*u)+r*(s*o-i*u)},n.multiply=r,n.translate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],e=n[0],n=n[1];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=u,t[5]=s,t[6]=e*r+n*a+c,t[7]=e*o+n*u+f,t[8]=e*i+n*s+l,t},n.rotate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],e=Math.sin(n),n=Math.cos(n);return t[0]=n*r+e*a,t[1]=n*o+e*u,t[2]=n*i+e*s,t[3]=n*a-e*r,t[4]=n*u-e*o,t[5]=n*s-e*i,t[6]=c,t[7]=f,t[8]=l,t},n.scale=function(t,e,n){var r=n[0],n=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},n.fromRotation=function(t,e){var n=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=n,t[2]=0,t[3]=-n,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},n.fromQuat=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n+n,u=r+r,s=o+o,c=n*a,f=r*a,e=r*u,n=o*a,r=o*u,o=o*s,a=i*a,u=i*u,s=i*s;return t[0]=1-e-o,t[3]=f-s,t[6]=n+u,t[1]=f+s,t[4]=1-c-o,t[7]=r-a,t[2]=n-u,t[5]=r+a,t[8]=1-c-e,t},n.normalFromMat4=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],m=e[12],_=e[13],p=e[14],v=e[15],g=n*u-r*a,b=n*s-o*a,y=n*c-i*a,M=r*s-o*u,x=r*c-i*u,w=o*c-i*s,P=f*_-l*m,E=f*p-h*m,e=f*v-d*m,f=l*p-h*_,l=l*v-d*_,h=h*v-d*p,d=g*h-b*l+y*f+M*e-x*E+w*P;return d?(d=1/d,t[0]=(u*h-s*l+c*f)*d,t[1]=(s*e-a*h-c*E)*d,t[2]=(a*l-u*e+c*P)*d,t[3]=(o*l-r*h-i*f)*d,t[4]=(n*h-o*e+i*E)*d,t[5]=(r*e-n*l-i*P)*d,t[6]=(_*w-p*x+v*M)*d,t[7]=(p*y-m*w-v*b)*d,t[8]=(m*x-_*y+v*g)*d,t):null},n.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},n.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},n.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},n.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},n.subtract=o,n.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},n.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},n.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=e[0],h=e[1],d=e[2],m=e[3],_=e[4],p=e[5],v=e[6],t=e[7],e=e[8];return Math.abs(n-l)<=g.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-h)<=g.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-d)<=g.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(i-m)<=g.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(a-_)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(u-p)<=g.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(s-v)<=g.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-t)<=g.EPSILON*Math.max(1,Math.abs(c),Math.abs(t))&&Math.abs(f-e)<=g.EPSILON*Math.max(1,Math.abs(f),Math.abs(e))},n.sub=n.mul=void 0;var g=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var i;Object.prototype.hasOwnProperty.call(t,n)&&((i=o?Object.getOwnPropertyDescriptor(t,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("./common.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function r(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],h=n[0],d=n[1],m=n[2],_=n[3],p=n[4],v=n[5],g=n[6],e=n[7],n=n[8];return t[0]=h*r+d*a+m*c,t[1]=h*o+d*u+m*f,t[2]=h*i+d*s+m*l,t[3]=_*r+p*a+v*c,t[4]=_*o+p*u+v*f,t[5]=_*i+p*s+v*l,t[6]=g*r+e*a+n*c,t[7]=g*o+e*u+n*f,t[8]=g*i+e*s+n*l,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}n.mul=r,n.sub=o},{"./common.js":2}],7:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.create=function(){var t=new C.ARRAY_TYPE(16);C.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},n.clone=function(t){var e=new C.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.fromValues=function(t,e,n,r,o,i,a,u,s,c,f,l,h,d,m,_){var p=new C.ARRAY_TYPE(16);return p[0]=t,p[1]=e,p[2]=n,p[3]=r,p[4]=o,p[5]=i,p[6]=a,p[7]=u,p[8]=s,p[9]=c,p[10]=f,p[11]=l,p[12]=h,p[13]=d,p[14]=m,p[15]=_,p},n.set=function(t,e,n,r,o,i,a,u,s,c,f,l,h,d,m,_,p){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t[9]=f,t[10]=l,t[11]=h,t[12]=d,t[13]=m,t[14]=_,t[15]=p,t},n.identity=m,n.transpose=function(t,e){{var n,r,o,i,a,u;t===e?(n=e[1],r=e[2],o=e[3],i=e[6],a=e[7],u=e[11],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=o,t[13]=a,t[14]=u):(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15])}return t},n.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],m=e[12],_=e[13],p=e[14],v=e[15],g=n*u-r*a,b=n*s-o*a,y=n*c-i*a,M=r*s-o*u,x=r*c-i*u,w=o*c-i*s,P=f*_-l*m,E=f*p-h*m,k=f*v-d*m,R=l*p-h*_,A=l*v-d*_,O=h*v-d*p,e=g*O-b*A+y*R+M*k-x*E+w*P;return e?(e=1/e,t[0]=(u*O-s*A+c*R)*e,t[1]=(o*A-r*O-i*R)*e,t[2]=(_*w-p*x+v*M)*e,t[3]=(h*x-l*w-d*M)*e,t[4]=(s*k-a*O-c*E)*e,t[5]=(n*O-o*k+i*E)*e,t[6]=(p*y-m*w-v*b)*e,t[7]=(f*w-h*y+d*b)*e,t[8]=(a*A-u*k+c*P)*e,t[9]=(r*k-n*A-i*P)*e,t[10]=(m*x-_*y+v*g)*e,t[11]=(l*y-f*x-d*g)*e,t[12]=(u*E-a*R-s*P)*e,t[13]=(n*R-r*E+o*P)*e,t[14]=(_*b-m*M-p*g)*e,t[15]=(f*M-l*b+h*g)*e,t):null},n.adjoint=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],m=e[12],_=e[13],p=e[14],e=e[15];return t[0]=u*(h*e-d*p)-l*(s*e-c*p)+_*(s*d-c*h),t[1]=-(r*(h*e-d*p)-l*(o*e-i*p)+_*(o*d-i*h)),t[2]=r*(s*e-c*p)-u*(o*e-i*p)+_*(o*c-i*s),t[3]=-(r*(s*d-c*h)-u*(o*d-i*h)+l*(o*c-i*s)),t[4]=-(a*(h*e-d*p)-f*(s*e-c*p)+m*(s*d-c*h)),t[5]=n*(h*e-d*p)-f*(o*e-i*p)+m*(o*d-i*h),t[6]=-(n*(s*e-c*p)-a*(o*e-i*p)+m*(o*c-i*s)),t[7]=n*(s*d-c*h)-a*(o*d-i*h)+f*(o*c-i*s),t[8]=a*(l*e-d*_)-f*(u*e-c*_)+m*(u*d-c*l),t[9]=-(n*(l*e-d*_)-f*(r*e-i*_)+m*(r*d-i*l)),t[10]=n*(u*e-c*_)-a*(r*e-i*_)+m*(r*c-i*u),t[11]=-(n*(u*d-c*l)-a*(r*d-i*l)+f*(r*c-i*u)),t[12]=-(a*(l*p-h*_)-f*(u*p-s*_)+m*(u*h-s*l)),t[13]=n*(l*p-h*_)-f*(r*p-o*_)+m*(r*h-o*l),t[14]=-(n*(u*p-s*_)-a*(r*p-o*_)+m*(r*s-o*u)),t[15]=n*(u*h-s*l)-a*(r*h-o*l)+f*(r*s-o*u),t},n.determinant=function(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],u=t[6],s=t[7],c=t[8],f=t[9],l=t[10],h=t[11],d=t[12],m=t[13],_=t[14],t=t[15];return(e*a-n*i)*(l*t-h*_)-(e*u-r*i)*(f*t-h*m)+(e*s-o*i)*(f*_-l*m)+(n*u-r*a)*(c*t-h*d)-(n*s-o*a)*(c*_-l*d)+(r*s-o*u)*(c*m-f*d)},n.multiply=r,n.translate=function(t,e,n){var r,o,i,a,u,s,c,f,l,h,d,m=n[0],_=n[1],p=n[2];e===t?(t[12]=e[0]*m+e[4]*_+e[8]*p+e[12],t[13]=e[1]*m+e[5]*_+e[9]*p+e[13],t[14]=e[2]*m+e[6]*_+e[10]*p+e[14],t[15]=e[3]*m+e[7]*_+e[11]*p+e[15]):(r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],h=e[9],d=e[10],n=e[11],t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=f,t[8]=l,t[9]=h,t[10]=d,t[11]=n,t[12]=r*m+u*_+l*p+e[12],t[13]=o*m+s*_+h*p+e[13],t[14]=i*m+c*_+d*p+e[14],t[15]=a*m+f*_+n*p+e[15]);return t},n.scale=function(t,e,n){var r=n[0],o=n[1],n=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},n.rotate=function(t,e,n,r){var o,i,a,u,s,c,f,l,h,d,m,_,p,v,g,b,y,M,x,w=r[0],P=r[1],E=r[2],k=Math.hypot(w,P,E);if(k<C.EPSILON)return null;w*=k=1/k,P*=k,E*=k,M=Math.sin(n),x=Math.cos(n),o=1-x,i=e[0],a=e[1],u=e[2],s=e[3],c=e[4],f=e[5],l=e[6],h=e[7],d=e[8],m=e[9],_=e[10],p=e[11],v=w*w*o+x,g=P*w*o+E*M,b=E*w*o-P*M,y=w*P*o-E*M,r=P*P*o+x,k=E*P*o+w*M,n=w*E*o+P*M,M=P*E*o-w*M,x=E*E*o+x,t[0]=i*v+c*g+d*b,t[1]=a*v+f*g+m*b,t[2]=u*v+l*g+_*b,t[3]=s*v+h*g+p*b,t[4]=i*y+c*r+d*k,t[5]=a*y+f*r+m*k,t[6]=u*y+l*r+_*k,t[7]=s*y+h*r+p*k,t[8]=i*n+c*M+d*x,t[9]=a*n+f*M+m*x,t[10]=u*n+l*M+_*x,t[11]=s*n+h*M+p*x,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},n.rotateX=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[4],a=e[5],u=e[6],s=e[7],c=e[8],f=e[9],l=e[10],n=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=i*o+c*r,t[5]=a*o+f*r,t[6]=u*o+l*r,t[7]=s*o+n*r,t[8]=c*o-i*r,t[9]=f*o-a*r,t[10]=l*o-u*r,t[11]=n*o-s*r,t},n.rotateY=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],a=e[1],u=e[2],s=e[3],c=e[8],f=e[9],l=e[10],n=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=i*o-c*r,t[1]=a*o-f*r,t[2]=u*o-l*r,t[3]=s*o-n*r,t[8]=i*r+c*o,t[9]=a*r+f*o,t[10]=u*r+l*o,t[11]=s*r+n*o,t},n.rotateZ=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],a=e[1],u=e[2],s=e[3],c=e[4],f=e[5],l=e[6],n=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=i*o+c*r,t[1]=a*o+f*r,t[2]=u*o+l*r,t[3]=s*o+n*r,t[4]=c*o-i*r,t[5]=f*o-a*r,t[6]=l*o-u*r,t[7]=n*o-s*r,t},n.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},n.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotation=function(t,e,n){var r=n[0],o=n[1],i=n[2],a=Math.hypot(r,o,i);if(a<C.EPSILON)return null;return r*=a=1/a,o*=a,i*=a,n=Math.sin(e),a=Math.cos(e),e=1-a,t[0]=r*r*e+a,t[1]=o*r*e+i*n,t[2]=i*r*e-o*n,t[3]=0,t[4]=r*o*e-i*n,t[5]=o*o*e+a,t[6]=i*o*e+r*n,t[7]=0,t[8]=r*i*e+o*n,t[9]=o*i*e-r*n,t[10]=i*i*e+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromXRotation=function(t,e){var n=Math.sin(e),e=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromYRotation=function(t,e){var n=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromZRotation=function(t,e){var n=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotationTranslation=h,n.fromQuat2=function(t,e){var n=new C.ARRAY_TYPE(3),r=-e[0],o=-e[1],i=-e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=r*r+o*o+i*i+a*a;0<l?(n[0]=2*(u*a+f*r+s*i-c*o)/l,n[1]=2*(s*a+f*o+c*r-u*i)/l,n[2]=2*(c*a+f*i+u*o-s*r)/l):(n[0]=2*(u*a+f*r+s*i-c*o),n[1]=2*(s*a+f*o+c*r-u*i),n[2]=2*(c*a+f*i+u*o-s*r));return h(t,e,n),t},n.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},n.getScaling=d,n.getRotation=function(t,e){var n=new C.ARRAY_TYPE(3);d(n,e);var r=1/n[0],o=1/n[1],i=1/n[2],a=e[0]*r,u=e[1]*o,s=e[2]*i,c=e[4]*r,f=e[5]*o,l=e[6]*i,n=e[8]*r,r=e[9]*o,o=e[10]*i,e=a+f+o,i=0;0<e?(i=2*Math.sqrt(1+e),t[3]=.25*i,t[0]=(l-r)/i,t[1]=(n-s)/i,t[2]=(u-c)/i):f<a&&o<a?(i=2*Math.sqrt(1+a-f-o),t[3]=(l-r)/i,t[0]=.25*i,t[1]=(u+c)/i,t[2]=(n+s)/i):o<f?(i=2*Math.sqrt(1+f-a-o),t[3]=(n-s)/i,t[0]=(u+c)/i,t[1]=.25*i,t[2]=(l+r)/i):(i=2*Math.sqrt(1+o-a-f),t[3]=(u-c)/i,t[0]=(n+s)/i,t[1]=(l+r)/i,t[2]=.25*i);return t},n.fromRotationTranslationScale=function(t,e,n,r){var o=e[0],i=e[1],a=e[2],u=e[3],s=o+o,c=i+i,f=a+a,l=o*s,h=o*c,d=o*f,e=i*c,o=i*f,i=a*f,a=u*s,s=u*c,c=u*f,u=r[0],f=r[1],r=r[2];return t[0]=(1-(e+i))*u,t[1]=(h+c)*u,t[2]=(d-s)*u,t[3]=0,t[4]=(h-c)*f,t[5]=(1-(l+i))*f,t[6]=(o+a)*f,t[7]=0,t[8]=(d+s)*r,t[9]=(o-a)*r,t[10]=(1-(l+e))*r,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},n.fromRotationTranslationScaleOrigin=function(t,e,n,r,o){var i=e[0],a=e[1],u=e[2],s=e[3],c=i+i,f=a+a,l=u+u,h=i*c,d=i*f,m=i*l,_=a*f,p=a*l,v=u*l,g=s*c,e=s*f,i=s*l,a=r[0],u=r[1],c=r[2],f=o[0],s=o[1],l=o[2],r=(1-(_+v))*a,o=(d+i)*a,a=(m-e)*a,i=(d-i)*u,v=(1-(h+v))*u,u=(p+g)*u,e=(m+e)*c,g=(p-g)*c,c=(1-(h+_))*c;return t[0]=r,t[1]=o,t[2]=a,t[3]=0,t[4]=i,t[5]=v,t[6]=u,t[7]=0,t[8]=e,t[9]=g,t[10]=c,t[11]=0,t[12]=n[0]+f-(r*f+i*s+e*l),t[13]=n[1]+s-(o*f+v*s+g*l),t[14]=n[2]+l-(a*f+u*s+c*l),t[15]=1,t},n.fromQuat=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n+n,u=r+r,s=o+o,c=n*a,f=r*a,e=r*u,n=o*a,r=o*u,o=o*s,a=i*a,u=i*u,s=i*s;return t[0]=1-e-o,t[1]=f+s,t[2]=n-u,t[3]=0,t[4]=f-s,t[5]=1-c-o,t[6]=r+a,t[7]=0,t[8]=n+u,t[9]=r-a,t[10]=1-c-e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.frustum=function(t,e,n,r,o,i,a){var u=1/(n-e),s=1/(o-r),c=1/(i-a);return t[0]=2*i*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*s,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(o+r)*s,t[10]=(a+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i*2*c,t[15]=0,t},n.perspective=function(t,e,n,r,o){e=1/Math.tan(e/2);t[0]=e/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(e=1/(r-o),t[10]=(o+r)*e,t[14]=2*o*r*e):(t[10]=-1,t[14]=-2*r);return t},n.perspectiveFromFieldOfView=function(t,e,n,r){var o=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(a+u),e=2/(o+i);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=-(a-u)*s*.5,t[9]=(o-i)*e*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},n.ortho=function(t,e,n,r,o,i,a){var u=1/(e-n),s=1/(r-o),c=1/(i-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*u,t[13]=(o+r)*s,t[14]=(a+i)*c,t[15]=1,t},n.lookAt=function(t,e,n,r){var o,i=e[0],a=e[1],u=e[2],s=r[0],c=r[1],f=r[2],l=n[0],h=n[1],d=n[2];if(Math.abs(i-l)<C.EPSILON&&Math.abs(a-h)<C.EPSILON&&Math.abs(u-d)<C.EPSILON)return m(t);o=i-l,e=a-h,r=u-d,n=1/Math.hypot(o,e,r),l=c*(r*=n)-f*(e*=n),h=f*(o*=n)-s*r,d=s*e-c*o,(n=Math.hypot(l,h,d))?(l*=n=1/n,h*=n,d*=n):d=h=l=0;f=e*d-r*h,s=r*l-o*d,c=o*h-e*l,(n=Math.hypot(f,s,c))?(f*=n=1/n,s*=n,c*=n):c=s=f=0;return t[0]=l,t[1]=f,t[2]=o,t[3]=0,t[4]=h,t[5]=s,t[6]=e,t[7]=0,t[8]=d,t[9]=c,t[10]=r,t[11]=0,t[12]=-(l*i+h*a+d*u),t[13]=-(f*i+s*a+c*u),t[14]=-(o*i+e*a+r*u),t[15]=1,t},n.targetTo=function(t,e,n,r){var o=e[0],i=e[1],a=e[2],u=r[0],s=r[1],c=r[2],f=o-n[0],l=i-n[1],e=a-n[2],r=f*f+l*l+e*e;0<r&&(r=1/Math.sqrt(r),f*=r,l*=r,e*=r);n=s*e-c*l,c=c*f-u*e,s=u*l-s*f;0<(r=n*n+c*c+s*s)&&(r=1/Math.sqrt(r),n*=r,c*=r,s*=r);return t[0]=n,t[1]=c,t[2]=s,t[3]=0,t[4]=l*s-e*c,t[5]=e*n-f*s,t[6]=f*c-l*n,t[7]=0,t[8]=f,t[9]=l,t[10]=e,t[11]=0,t[12]=o,t[13]=i,t[14]=a,t[15]=1,t},n.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},n.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},n.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},n.subtract=o,n.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},n.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},n.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],h=t[10],d=t[11],m=t[12],_=t[13],p=t[14],v=t[15],g=e[0],b=e[1],y=e[2],M=e[3],x=e[4],w=e[5],P=e[6],E=e[7],k=e[8],R=e[9],A=e[10],O=e[11],S=e[12],T=e[13],t=e[14],e=e[15];return Math.abs(n-g)<=C.EPSILON*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(r-b)<=C.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(o-y)<=C.EPSILON*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(i-M)<=C.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(a-x)<=C.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(u-w)<=C.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(s-P)<=C.EPSILON*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(c-E)<=C.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(f-k)<=C.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(l-R)<=C.EPSILON*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(h-A)<=C.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(d-O)<=C.EPSILON*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(m-S)<=C.EPSILON*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(_-T)<=C.EPSILON*Math.max(1,Math.abs(_),Math.abs(T))&&Math.abs(p-t)<=C.EPSILON*Math.max(1,Math.abs(p),Math.abs(t))&&Math.abs(v-e)<=C.EPSILON*Math.max(1,Math.abs(v),Math.abs(e))},n.sub=n.mul=void 0;var C=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var i;Object.prototype.hasOwnProperty.call(t,n)&&((i=o?Object.getOwnPropertyDescriptor(t,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("./common.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function m(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function r(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],h=e[9],d=e[10],m=e[11],_=e[12],p=e[13],v=e[14],g=e[15],b=n[0],y=n[1],M=n[2],e=n[3];return t[0]=b*r+y*u+M*l+e*_,t[1]=b*o+y*s+M*h+e*p,t[2]=b*i+y*c+M*d+e*v,t[3]=b*a+y*f+M*m+e*g,b=n[4],y=n[5],M=n[6],e=n[7],t[4]=b*r+y*u+M*l+e*_,t[5]=b*o+y*s+M*h+e*p,t[6]=b*i+y*c+M*d+e*v,t[7]=b*a+y*f+M*m+e*g,b=n[8],y=n[9],M=n[10],e=n[11],t[8]=b*r+y*u+M*l+e*_,t[9]=b*o+y*s+M*h+e*p,t[10]=b*i+y*c+M*d+e*v,t[11]=b*a+y*f+M*m+e*g,b=n[12],y=n[13],M=n[14],e=n[15],t[12]=b*r+y*u+M*l+e*_,t[13]=b*o+y*s+M*h+e*p,t[14]=b*i+y*c+M*d+e*v,t[15]=b*a+y*f+M*m+e*g,t}function h(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=r+r,s=o+o,c=i+i,f=r*u,l=r*s,e=r*c,r=o*s,o=o*c,i=i*c,u=a*u,s=a*s,c=a*c;return t[0]=1-(r+i),t[1]=l+c,t[2]=e-s,t[3]=0,t[4]=l-c,t[5]=1-(f+i),t[6]=o+u,t[7]=0,t[8]=e+s,t[9]=o-u,t[10]=1-(f+r),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function d(t,e){var n=e[0],r=e[1],o=e[2],i=e[4],a=e[5],u=e[6],s=e[8],c=e[9],e=e[10];return t[0]=Math.hypot(n,r,o),t[1]=Math.hypot(i,a,u),t[2]=Math.hypot(s,c,e),t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}n.mul=r,n.sub=o},{"./common.js":2}],8:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.create=c,n.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},n.setAxisAngle=f,n.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);r>d.EPSILON?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0);return n},n.getAngle=function(t,e){e=g(t,e);return Math.acos(2*e*e-1)},n.multiply=l,n.rotateX=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],e=Math.sin(n),n=Math.cos(n);return t[0]=r*n+a*e,t[1]=o*n+i*e,t[2]=i*n-o*e,t[3]=a*n-r*e,t},n.rotateY=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],e=Math.sin(n),n=Math.cos(n);return t[0]=r*n-i*e,t[1]=o*n+a*e,t[2]=i*n+r*e,t[3]=a*n-o*e,t},n.rotateZ=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],e=Math.sin(n),n=Math.cos(n);return t[0]=r*n+o*e,t[1]=o*n-r*e,t[2]=i*n+a*e,t[3]=a*n-i*e,t},n.calculateW=function(t,e){var n=e[0],r=e[1],e=e[2];return t[0]=n,t[1]=r,t[2]=e,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-e*e)),t},n.exp=h,n.ln=m,n.pow=function(t,e,n){return m(t,e),v(t,t,n),h(t,t),t},n.slerp=_,n.random=function(t){var e=d.RANDOM(),n=d.RANDOM(),r=d.RANDOM(),o=Math.sqrt(1-e),e=Math.sqrt(e);return t[0]=o*Math.sin(2*Math.PI*n),t[1]=o*Math.cos(2*Math.PI*n),t[2]=e*Math.sin(2*Math.PI*r),t[3]=e*Math.cos(2*Math.PI*r),t},n.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],e=n*n+r*r+o*o+i*i,e=e?1/e:0;return t[0]=-n*e,t[1]=-r*e,t[2]=-o*e,t[3]=i*e,t},n.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},n.fromMat3=p,n.fromEuler=function(t,e,n,r){var o=.5*Math.PI/180;e*=o,n*=o,r*=o;var i=Math.sin(e),a=Math.cos(e),o=Math.sin(n),e=Math.cos(n),n=Math.sin(r),r=Math.cos(r);return t[0]=i*e*r-a*o*n,t[1]=a*o*r+i*e*n,t[2]=a*e*n-i*o*r,t[3]=a*e*r+i*o*n,t},n.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},n.setAxes=n.sqlerp=n.rotationTo=n.equals=n.exactEquals=n.normalize=n.sqrLen=n.squaredLength=n.len=n.length=n.lerp=n.dot=n.scale=n.mul=n.add=n.set=n.copy=n.fromValues=n.clone=void 0;var d=s(t("./common.js")),r=s(t("./mat3.js")),o=s(t("./vec3.js")),i=s(t("./vec4.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function s(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&((r=i?Object.getOwnPropertyDescriptor(t,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=t[n]);return o.default=t,e&&e.set(t,o),o}function c(){var t=new d.ARRAY_TYPE(4);return d.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function f(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function l(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[0],s=n[1],e=n[2],n=n[3];return t[0]=r*n+a*u+o*e-i*s,t[1]=o*n+a*s+i*u-r*e,t[2]=i*n+a*e+r*s-o*u,t[3]=a*n-r*u-o*s-i*e,t}function h(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=Math.sqrt(n*n+r*r+o*o),e=Math.exp(i),i=0<a?e*Math.sin(a)/a:0;return t[0]=n*i,t[1]=r*i,t[2]=o*i,t[3]=e*Math.cos(a),t}function m(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],e=Math.sqrt(n*n+r*r+o*o),e=0<e?Math.atan2(e,i)/e:0;return t[0]=n*e,t[1]=r*e,t[2]=o*e,t[3]=.5*Math.log(n*n+r*r+o*o+i*i),t}function _(t,e,n,r){var o,i=e[0],a=e[1],u=e[2],s=e[3],c=n[0],f=n[1],l=n[2],h=n[3],e=i*c+a*f+u*l+s*h;return e<0&&(e=-e,c=-c,f=-f,l=-l,h=-h),r=1-e>d.EPSILON?(n=Math.acos(e),e=Math.sin(n),o=Math.sin((1-r)*n)/e,Math.sin(r*n)/e):(o=1-r,r),t[0]=o*i+r*c,t[1]=o*a+r*f,t[2]=o*u+r*l,t[3]=o*s+r*h,t}function p(t,e){var n,r,o,i=e[0]+e[4]+e[8];return 0<i?(o=Math.sqrt(i+1),t[3]=.5*o,t[0]=(e[5]-e[7])*(o=.5/o),t[1]=(e[6]-e[2])*o,t[2]=(e[1]-e[3])*o):(e[4]>e[n=0]&&(n=1),r=((n=e[8]>e[3*n+n]?2:n)+1)%3,i=(n+2)%3,o=Math.sqrt(e[3*n+n]-e[3*r+r]-e[3*i+i]+1),t[n]=.5*o,t[3]=(e[3*r+i]-e[3*i+r])*(o=.5/o),t[r]=(e[3*r+n]+e[3*n+r])*o,t[i]=(e[3*i+n]+e[3*n+i])*o),t}t=i.clone;n.clone=t;t=i.fromValues;n.fromValues=t;t=i.copy;n.copy=t;t=i.set;n.set=t;t=i.add;n.add=t,n.mul=l;var v=i.scale;n.scale=v;var g=i.dot;n.dot=g;t=i.lerp;n.lerp=t;t=i.length;n.length=t,n.len=t;t=i.squaredLength;n.squaredLength=t,n.sqrLen=t;var b=i.normalize;n.normalize=b;t=i.exactEquals;n.exactEquals=t;i=i.equals;n.equals=i;var y,M,x,i=(y=o.create(),M=o.fromValues(1,0,0),x=o.fromValues(0,1,0),function(t,e,n){var r=o.dot(e,n);return r<-.999999?(o.cross(y,M,e),o.len(y)<1e-6&&o.cross(y,x,e),o.normalize(y,y),f(t,y,Math.PI),t):.999999<r?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(o.cross(y,e,n),t[0]=y[0],t[1]=y[1],t[2]=y[2],t[3]=1+r,b(t,t))});n.rotationTo=i;var w,P,i=(w=c(),P=c(),function(t,e,n,r,o,i){return _(w,e,o,i),_(P,n,r,i),_(t,w,P,2*i*(1-i)),t});n.sqlerp=i;var E,r=(E=r.create(),function(t,e,n,r){return E[0]=n[0],E[3]=n[1],E[6]=n[2],E[1]=r[0],E[4]=r[1],E[7]=r[2],E[2]=-e[0],E[5]=-e[1],E[8]=-e[2],b(t,p(t,E))});n.setAxes=r},{"./common.js":2,"./mat3.js":6,"./vec3.js":11,"./vec4.js":12}],9:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.create=function(){var t=new p.ARRAY_TYPE(8);p.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0);return t[3]=1,t},n.clone=function(t){var e=new p.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},n.fromValues=function(t,e,n,r,o,i,a,u){var s=new p.ARRAY_TYPE(8);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s[4]=o,s[5]=i,s[6]=a,s[7]=u,s},n.fromRotationTranslationValues=function(t,e,n,r,o,i,a){var u=new p.ARRAY_TYPE(8);u[0]=t,u[1]=e,u[2]=n,u[3]=r;o*=.5,i*=.5,a*=.5;return u[4]=o*r+i*n-a*e,u[5]=i*r+a*t-o*n,u[6]=a*r+o*e-i*t,u[7]=-o*t-i*e-a*n,u},n.fromRotationTranslation=i,n.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},n.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},n.fromMat4=function(t,e){var n=m.create();o.getRotation(n,e);var r=new p.ARRAY_TYPE(3);return o.getTranslation(r,e),i(t,n,r),t},n.copy=f,n.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},n.set=function(t,e,n,r,o,i,a,u,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t[4]=i,t[5]=a,t[6]=u,t[7]=s,t},n.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},n.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},n.getTranslation=function(t,e){var n=e[4],r=e[5],o=e[6],i=e[7],a=-e[0],u=-e[1],s=-e[2],e=e[3];return t[0]=2*(n*e+i*a+r*s-o*u),t[1]=2*(r*e+i*u+o*a-n*s),t[2]=2*(o*e+i*s+n*u-r*a),t},n.translate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=.5*n[0],s=.5*n[1],c=.5*n[2],f=e[4],l=e[5],n=e[6],e=e[7];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=a*u+o*c-i*s+f,t[5]=a*s+i*u-r*c+l,t[6]=a*c+r*s-o*u+n,t[7]=-r*u-o*s-i*c+e,t},n.rotateX=function(t,e,n){var r=-e[0],o=-e[1],i=-e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=u*a+f*r+s*i-c*o,h=s*a+f*o+c*r-u*i,d=c*a+f*i+u*o-s*r,c=f*a-u*r-s*o-c*i;return m.rotateX(t,e,n),r=t[0],o=t[1],i=t[2],a=t[3],t[4]=l*a+c*r+h*i-d*o,t[5]=h*a+c*o+d*r-l*i,t[6]=d*a+c*i+l*o-h*r,t[7]=c*a-l*r-h*o-d*i,t},n.rotateY=function(t,e,n){var r=-e[0],o=-e[1],i=-e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=u*a+f*r+s*i-c*o,h=s*a+f*o+c*r-u*i,d=c*a+f*i+u*o-s*r,c=f*a-u*r-s*o-c*i;return m.rotateY(t,e,n),r=t[0],o=t[1],i=t[2],a=t[3],t[4]=l*a+c*r+h*i-d*o,t[5]=h*a+c*o+d*r-l*i,t[6]=d*a+c*i+l*o-h*r,t[7]=c*a-l*r-h*o-d*i,t},n.rotateZ=function(t,e,n){var r=-e[0],o=-e[1],i=-e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=u*a+f*r+s*i-c*o,h=s*a+f*o+c*r-u*i,d=c*a+f*i+u*o-s*r,c=f*a-u*r-s*o-c*i;return m.rotateZ(t,e,n),r=t[0],o=t[1],i=t[2],a=t[3],t[4]=l*a+c*r+h*i-d*o,t[5]=h*a+c*o+d*r-l*i,t[6]=d*a+c*i+l*o-h*r,t[7]=c*a-l*r-h*o-d*i,t},n.rotateByQuatAppend=function(t,e,n){var r=n[0],o=n[1],i=n[2],a=n[3],u=e[0],s=e[1],c=e[2],n=e[3];return t[0]=u*a+n*r+s*i-c*o,t[1]=s*a+n*o+c*r-u*i,t[2]=c*a+n*i+u*o-s*r,t[3]=n*a-u*r-s*o-c*i,u=e[4],s=e[5],c=e[6],n=e[7],t[4]=u*a+n*r+s*i-c*o,t[5]=s*a+n*o+c*r-u*i,t[6]=c*a+n*i+u*o-s*r,t[7]=n*a-u*r-s*o-c*i,t},n.rotateByQuatPrepend=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[0],s=n[1],c=n[2],e=n[3];return t[0]=r*e+a*u+o*c-i*s,t[1]=o*e+a*s+i*u-r*c,t[2]=i*e+a*c+r*s-o*u,t[3]=a*e-r*u-o*s-i*c,u=n[4],s=n[5],c=n[6],e=n[7],t[4]=r*e+a*u+o*c-i*s,t[5]=o*e+a*s+i*u-r*c,t[6]=i*e+a*c+r*s-o*u,t[7]=a*e-r*u-o*s-i*c,t},n.rotateAroundAxis=function(t,e,n,r){if(Math.abs(r)<p.EPSILON)return f(t,e);var o=Math.hypot(n[0],n[1],n[2]);r*=.5;var i=Math.sin(r),a=i*n[0]/o,u=i*n[1]/o,s=i*n[2]/o,c=Math.cos(r),i=e[0],n=e[1],o=e[2],r=e[3];t[0]=i*c+r*a+n*s-o*u,t[1]=n*c+r*u+o*a-i*s,t[2]=o*c+r*s+i*u-n*a,t[3]=r*c-i*a-n*u-o*s;i=e[4],n=e[5],o=e[6],e=e[7];return t[4]=i*c+e*a+n*s-o*u,t[5]=n*c+e*u+o*a-i*s,t[6]=o*c+e*s+i*u-n*a,t[7]=e*c-i*a-n*u-o*s,t},n.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t},n.multiply=s,n.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t},n.lerp=function(t,e,n,r){var o=1-r;c(e,n)<0&&(r=-r);return t[0]=e[0]*o+n[0]*r,t[1]=e[1]*o+n[1]*r,t[2]=e[2]*o+n[2]*r,t[3]=e[3]*o+n[3]*r,t[4]=e[4]*o+n[4]*r,t[5]=e[5]*o+n[5]*r,t[6]=e[6]*o+n[6]*r,t[7]=e[7]*o+n[7]*r,t},n.invert=function(t,e){var n=l(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t},n.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},n.normalize=function(t,e){var n=l(e);{var r,o,i,a,u,s,c,f;0<n&&(n=Math.sqrt(n),r=e[0]/n,o=e[1]/n,i=e[2]/n,a=e[3]/n,u=e[4],s=e[5],c=e[6],f=e[7],e=r*u+o*s+i*c+a*f,t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=(u-r*e)/n,t[5]=(s-o*e)/n,t[6]=(c-i*e)/n,t[7]=(f-a*e)/n)}return t},n.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},n.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=e[0],l=e[1],h=e[2],d=e[3],m=e[4],_=e[5],t=e[6],e=e[7];return Math.abs(n-f)<=p.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-l)<=p.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-h)<=p.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(i-d)<=p.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-m)<=p.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(u-_)<=p.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(s-t)<=p.EPSILON*Math.max(1,Math.abs(s),Math.abs(t))&&Math.abs(c-e)<=p.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))},n.sqrLen=n.squaredLength=n.len=n.length=n.dot=n.mul=n.setReal=n.getReal=void 0;var p=r(t("./common.js")),m=r(t("./quat.js")),o=r(t("./mat4.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function r(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n,r,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&((r=i?Object.getOwnPropertyDescriptor(t,n):null)&&(r.get||r.set)?Object.defineProperty(o,n,r):o[n]=t[n]);return o.default=t,e&&e.set(t,o),o}function i(t,e,n){var r=.5*n[0],o=.5*n[1],i=.5*n[2],a=e[0],u=e[1],n=e[2],e=e[3];return t[0]=a,t[1]=u,t[2]=n,t[3]=e,t[4]=r*e+o*n-i*u,t[5]=o*e+i*a-r*n,t[6]=i*e+r*u-o*a,t[7]=-r*a-o*u-i*n,t}function f(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}t=m.copy;n.getReal=t;t=m.copy;function s(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],u=n[4],s=n[5],c=n[6],f=n[7],l=e[4],h=e[5],d=e[6],m=e[7],_=n[0],p=n[1],e=n[2],n=n[3];return t[0]=r*n+a*_+o*e-i*p,t[1]=o*n+a*p+i*_-r*e,t[2]=i*n+a*e+r*p-o*_,t[3]=a*n-r*_-o*p-i*e,t[4]=r*f+a*u+o*c-i*s+l*n+m*_+h*e-d*p,t[5]=o*f+a*s+i*u-r*c+h*n+m*p+d*_-l*e,t[6]=i*f+a*c+r*s-o*u+d*n+m*e+l*p-h*_,t[7]=a*f-r*u-o*s-i*c+m*n-l*_-h*p-d*e,t}n.setReal=t,n.mul=s;var c=m.dot;n.dot=c;t=m.length;n.length=t,n.len=t;var l=m.squaredLength;n.squaredLength=l,n.sqrLen=l},{"./common.js":2,"./mat4.js":7,"./quat.js":8}],10:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.create=r,n.clone=function(t){var e=new o.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},n.fromValues=function(t,e){var n=new o.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},n.set=function(t,e,n){return t[0]=e,t[1]=n,t},n.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},n.subtract=i,n.multiply=s,n.divide=c,n.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},n.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},n.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},n.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},n.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},n.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},n.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},n.distance=f,n.squaredDistance=l,n.length=h,n.squaredLength=d,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},n.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},n.normalize=function(t,e){var n=e[0],r=e[1],r=n*n+r*r;0<r&&(r=1/Math.sqrt(r));return t[0]=e[0]*r,t[1]=e[1]*r,t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},n.cross=function(t,e,n){n=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=n,t},n.lerp=function(t,e,n,r){var o=e[0],e=e[1];return t[0]=o+r*(n[0]-o),t[1]=e+r*(n[1]-e),t},n.random=function(t,e){e=e||1;var n=2*o.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},n.transformMat2=function(t,e,n){var r=e[0],e=e[1];return t[0]=n[0]*r+n[2]*e,t[1]=n[1]*r+n[3]*e,t},n.transformMat2d=function(t,e,n){var r=e[0],e=e[1];return t[0]=n[0]*r+n[2]*e+n[4],t[1]=n[1]*r+n[3]*e+n[5],t},n.transformMat3=function(t,e,n){var r=e[0],e=e[1];return t[0]=n[0]*r+n[3]*e+n[6],t[1]=n[1]*r+n[4]*e+n[7],t},n.transformMat4=function(t,e,n){var r=e[0],e=e[1];return t[0]=n[0]*r+n[4]*e+n[12],t[1]=n[1]*r+n[5]*e+n[13],t},n.rotate=function(t,e,n,r){var o=e[0]-n[0],i=e[1]-n[1],e=Math.sin(r),r=Math.cos(r);return t[0]=o*r-i*e+n[0],t[1]=o*e+i*r+n[1],t},n.angle=function(t,e){var n=t[0],r=t[1],o=e[0],t=e[1],e=Math.sqrt(n*n+r*r)*Math.sqrt(o*o+t*t),e=e&&(n*o+r*t)/e;return Math.acos(Math.min(Math.max(e,-1),1))},n.zero=function(t){return t[0]=0,t[1]=0,t},n.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},n.equals=function(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return Math.abs(n-t)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(t))&&Math.abs(r-e)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(e))},n.forEach=n.sqrLen=n.sqrDist=n.dist=n.div=n.mul=n.sub=n.len=void 0;var o=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var i;Object.prototype.hasOwnProperty.call(t,n)&&((i=o?Object.getOwnPropertyDescriptor(t,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("./common.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function r(){var t=new o.ARRAY_TYPE(2);return o.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function i(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function s(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function c(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function f(t,e){var n=e[0]-t[0],t=e[1]-t[1];return Math.hypot(n,t)}function l(t,e){var n=e[0]-t[0],t=e[1]-t[1];return n*n+t*t}function h(t){var e=t[0],t=t[1];return Math.hypot(e,t)}function d(t){var e=t[0],t=t[1];return e*e+t*t}n.len=h,n.sub=i,n.mul=s,n.div=c,n.dist=f,n.sqrDist=l,n.sqrLen=d;var m,t=(m=r(),function(t,e,n,r,o,i){var a,u;for(e=e||2,n=n||0,u=r?Math.min(r*e+n,t.length):t.length,a=n;a<u;a+=e)m[0]=t[a],m[1]=t[a+1],o(m,m,i),t[a]=m[0],t[a+1]=m[1];return t});n.forEach=t},{"./common.js":2}],11:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.create=r,n.clone=function(t){var e=new u.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},n.length=o,n.fromValues=function(t,e,n){var r=new u.ARRAY_TYPE(3);return r[0]=t,r[1]=e,r[2]=n,r},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},n.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},n.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},n.subtract=i,n.multiply=c,n.divide=f,n.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},n.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},n.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},n.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},n.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},n.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},n.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},n.distance=l,n.squaredDistance=h,n.squaredLength=d,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},n.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},n.normalize=function(t,e){var n=e[0],r=e[1],o=e[2],o=n*n+r*r+o*o;0<o&&(o=1/Math.sqrt(o));return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t},n.dot=m,n.cross=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],e=n[1],n=n[2];return t[0]=o*n-i*e,t[1]=i*a-r*n,t[2]=r*e-o*a,t},n.lerp=function(t,e,n,r){var o=e[0],i=e[1],e=e[2];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=e+r*(n[2]-e),t},n.hermite=function(t,e,n,r,o,i){var a=i*i,u=a*(2*i-3)+1,s=a*(i-2)+i,c=a*(i-1),i=a*(3-2*i);return t[0]=e[0]*u+n[0]*s+r[0]*c+o[0]*i,t[1]=e[1]*u+n[1]*s+r[1]*c+o[1]*i,t[2]=e[2]*u+n[2]*s+r[2]*c+o[2]*i,t},n.bezier=function(t,e,n,r,o,i){var a=1-i,u=a*a,s=i*i,c=u*a,u=3*i*u,a=3*s*a,i=s*i;return t[0]=e[0]*c+n[0]*u+r[0]*a+o[0]*i,t[1]=e[1]*c+n[1]*u+r[1]*a+o[1]*i,t[2]=e[2]*c+n[2]*u+r[2]*a+o[2]*i,t},n.random=function(t,e){e=e||1;var n=2*u.RANDOM()*Math.PI,r=2*u.RANDOM()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t},n.transformMat4=function(t,e,n){var r=e[0],o=e[1],i=e[2],e=n[3]*r+n[7]*o+n[11]*i+n[15];return e=e||1,t[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/e,t[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/e,t[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/e,t},n.transformMat3=function(t,e,n){var r=e[0],o=e[1],e=e[2];return t[0]=r*n[0]+o*n[3]+e*n[6],t[1]=r*n[1]+o*n[4]+e*n[7],t[2]=r*n[2]+o*n[5]+e*n[8],t},n.transformQuat=function(t,e,n){var r=n[0],o=n[1],i=n[2],a=n[3],u=e[0],s=e[1],c=e[2],f=o*c-i*s,l=i*u-r*c,n=r*s-o*u,e=o*n-i*l,i=i*f-r*n,o=r*l-o*f,a=2*a;return f*=a,l*=a,n*=a,e*=2,i*=2,o*=2,t[0]=u+f+e,t[1]=s+l+i,t[2]=c+n+o,t},n.rotateX=function(t,e,n,r){var o=[],i=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],i[0]=o[0],i[1]=o[1]*Math.cos(r)-o[2]*Math.sin(r),i[2]=o[1]*Math.sin(r)+o[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},n.rotateY=function(t,e,n,r){var o=[],i=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],i[0]=o[2]*Math.sin(r)+o[0]*Math.cos(r),i[1]=o[1],i[2]=o[2]*Math.cos(r)-o[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},n.rotateZ=function(t,e,n,r){var o=[],i=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],i[0]=o[0]*Math.cos(r)-o[1]*Math.sin(r),i[1]=o[0]*Math.sin(r)+o[1]*Math.cos(r),i[2]=o[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t},n.angle=function(t,e){var n=t[0],r=t[1],o=t[2],i=e[0],a=e[1],u=e[2],o=Math.sqrt(n*n+r*r+o*o),u=Math.sqrt(i*i+a*a+u*u),u=o*u,u=u&&m(t,e)/u;return Math.acos(Math.min(Math.max(u,-1),1))},n.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},n.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},n.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=e[0],t=e[1],e=e[2];return Math.abs(n-i)<=u.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-t)<=u.EPSILON*Math.max(1,Math.abs(r),Math.abs(t))&&Math.abs(o-e)<=u.EPSILON*Math.max(1,Math.abs(o),Math.abs(e))},n.forEach=n.sqrLen=n.len=n.sqrDist=n.dist=n.div=n.mul=n.sub=void 0;var u=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var i;Object.prototype.hasOwnProperty.call(t,n)&&((i=o?Object.getOwnPropertyDescriptor(t,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function r(){var t=new u.ARRAY_TYPE(3);return u.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=t[0],n=t[1],t=t[2];return Math.hypot(e,n,t)}function i(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function c(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function f(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function l(t,e){var n=e[0]-t[0],r=e[1]-t[1],t=e[2]-t[2];return Math.hypot(n,r,t)}function h(t,e){var n=e[0]-t[0],r=e[1]-t[1],t=e[2]-t[2];return n*n+r*r+t*t}function d(t){var e=t[0],n=t[1],t=t[2];return e*e+n*n+t*t}function m(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}n.sub=i,n.mul=c,n.div=f,n.dist=l,n.sqrDist=h,n.len=o,n.sqrLen=d;var _,t=(_=r(),function(t,e,n,r,o,i){var a,u;for(e=e||3,n=n||0,u=r?Math.min(r*e+n,t.length):t.length,a=n;a<u;a+=e)_[0]=t[a],_[1]=t[a+1],_[2]=t[a+2],o(_,_,i),t[a]=_[0],t[a+1]=_[1],t[a+2]=_[2];return t});n.forEach=t},{"./common.js":2}],12:[function(t,e,n){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.create=r,n.clone=function(t){var e=new c.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},n.fromValues=function(t,e,n,r){var o=new c.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},n.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},n.set=function(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t},n.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},n.subtract=o,n.multiply=i,n.divide=s,n.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},n.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},n.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},n.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},n.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},n.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},n.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},n.distance=f,n.squaredDistance=l,n.length=h,n.squaredLength=d,n.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},n.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},n.normalize=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],e=n*n+r*r+o*o+i*i;0<e&&(e=1/Math.sqrt(e));return t[0]=n*e,t[1]=r*e,t[2]=o*e,t[3]=i*e,t},n.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},n.cross=function(t,e,n,r){var o=n[0]*r[1]-n[1]*r[0],i=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],u=n[1]*r[2]-n[2]*r[1],s=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],f=e[0],n=e[1],r=e[2],e=e[3];return t[0]=n*c-r*s+e*u,t[1]=-f*c+r*a-e*i,t[2]=f*s-n*a+e*o,t[3]=-f*u+n*i-r*o,t},n.lerp=function(t,e,n,r){var o=e[0],i=e[1],a=e[2],e=e[3];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t[3]=e+r*(n[3]-e),t},n.random=function(t,e){var n,r,o,i,a,u;e=e||1;for(;n=2*c.RANDOM()-1,r=2*c.RANDOM()-1,a=n*n+r*r,1<=a;);for(;o=2*c.RANDOM()-1,i=2*c.RANDOM()-1,u=o*o+i*i,1<=u;);var s=Math.sqrt((1-a)/u);return t[0]=e*n,t[1]=e*r,t[2]=e*o*s,t[3]=e*i*s,t},n.transformMat4=function(t,e,n){var r=e[0],o=e[1],i=e[2],e=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*e,t[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*e,t[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*e,t[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*e,t},n.transformQuat=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],u=n[1],s=n[2],c=n[3],f=c*r+u*i-s*o,l=c*o+s*r-a*i,n=c*i+a*o-u*r,i=-a*r-u*o-s*i;return t[0]=f*c+i*-a+l*-s-n*-u,t[1]=l*c+i*-u+n*-a-f*-s,t[2]=n*c+i*-s+f*-u-l*-a,t[3]=e[3],t},n.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},n.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},n.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},n.equals=function(t,e){var n=t[0],r=t[1],o=t[2],i=t[3],a=e[0],u=e[1],t=e[2],e=e[3];return Math.abs(n-a)<=c.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=c.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-t)<=c.EPSILON*Math.max(1,Math.abs(o),Math.abs(t))&&Math.abs(i-e)<=c.EPSILON*Math.max(1,Math.abs(i),Math.abs(e))},n.forEach=n.sqrLen=n.len=n.sqrDist=n.dist=n.div=n.mul=n.sub=void 0;var c=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var i;Object.prototype.hasOwnProperty.call(t,n)&&((i=o?Object.getOwnPropertyDescriptor(t,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("./common.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function r(){var t=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function i(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function s(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function f(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],t=e[3]-t[3];return Math.hypot(n,r,o,t)}function l(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],t=e[3]-t[3];return n*n+r*r+o*o+t*t}function h(t){var e=t[0],n=t[1],r=t[2],t=t[3];return Math.hypot(e,n,r,t)}function d(t){var e=t[0],n=t[1],r=t[2],t=t[3];return e*e+n*n+r*r+t*t}n.sub=o,n.mul=i,n.div=s,n.dist=f,n.sqrDist=l,n.len=h,n.sqrLen=d;var m,t=(m=r(),function(t,e,n,r,o,i){var a,u;for(e=e||4,n=n||0,u=r?Math.min(r*e+n,t.length):t.length,a=n;a<u;a+=e)m[0]=t[a],m[1]=t[a+1],m[2]=t[a+2],m[3]=t[a+3],o(m,m,i),t[a]=m[0],t[a+1]=m[1],t[a+2]=m[2],t[a+3]=m[3];return t});n.forEach=t},{"./common.js":2}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=15},{}],14:[function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},o=this&&this.__generator||function(n,r){var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../constants"),i=t("./generation/ChunkGenerator"),a=t("./webGLRenderer/WebGLRenderer");t("fpsmeter");u.prototype.init=function(){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,this._renderer.init()];case 1:return t.sent(),[2]}})})},u.prototype.start=function(){this.isRunning()||(this._running=!0,this._chunkGenerator.start(),this._tick())},u.prototype.stop=function(){this._running=!1,this._chunkGenerator.stop()},u.prototype.isRunning=function(){return this._running&&!this._errorGraphicContext},u.prototype._tick=function(){var t=this,e=function(){t._running&&!t._errorGraphicContext&&(t._main_loop(),window.requestAnimationFrame(e))};e()},u.prototype._main_loop=function(){this._fpsMeter.tickStart();var t=this._renderer.getCameraPosition();this._chunkGenerator.update(t);var e=this._chunkGenerator.getChunks();this._renderer.update(e),this._renderer.renderScene(e);for(var n=[Math.floor(t[0]/c.default),Math.floor(t[1]/c.default),Math.floor(t[2]/c.default)],r="Coordinates: "+n[0]+"/"+n[1]+"/"+n[2],o=0,i=0,a=e;i<a.length;i++)a[i].visible&&++o;this._renderer.pushText(r,[0,0],1),this._renderer.pushText("Chunks:",[0,96],1),this._renderer.pushText(">Generated: "+this._chunksCreated,[0,80],1),this._renderer.pushText(">Discarded: "+this._chunksDiscarded,[0,64],1),this._renderer.pushText(">Live:      "+(this._chunksCreated-this._chunksDiscarded),[0,48],1),this._renderer.pushText(">Visible:   "+o,[0,32],1);var u,s=this._renderer.getFreeFlyCamera().getTimeImmobile();3<s&&(t=5<s?1:(s-3)/2,(n=this._renderer.getSize())[0]=.75*n[0],u=0,(e=["         *---*         ","         |W/Z|         ","         *---*         ","                       ","   *---* *---* *---*   ","   |A/Q| | S | | D |   ","   *---* *---* *---*   ","","        *----*         ","        | UP |         ","        *----*         ","                       "," *----* *----* *-----* "," |LEFT| |DOWN| |RIGHT| "," *----* *----* *-----* ","","   *---------------*   ","   |MOUSE SUPPORTED|   ","   *---------------*   ","","*---------------------*","|TOUCHSCREEN SUPPORTED|","*---------------------*"]).forEach(function(t){return u=Math.max(u,t.length)}),u*=16*t,s=16*e.length*t,r=e.join("\n"),s=[.5*n[0]-.5*u,.5*n[1]+.5*s],this._renderer.pushText(r,s,t)),this._renderer.renderHUD(this._chunkGenerator.getChunks(),this._chunkGenerator.getProcessingPositions(),this._touches),this._fpsMeter.tick()},t=u;function u(){var o=this;this._touches=[],this._chunksCreated=0,this._chunksDiscarded=0;var t=document.getElementById("fpsmeter");if(!t)throw new Error("fpsmeter not found");this._fpsMeter=new FPSMeter(t,{theme:"transparent"});var e=document.getElementById("canvasesdiv");if(!e)throw new Error("canvasesdiv not found");t=document.getElementById("main-canvas");if(!t)throw new Error("main-canvas not found");this._renderer=new a.default(e,t),this._chunkGenerator=new i.default({chunkIsVisible:function(t){return o._renderer.chunkIsVisible(t)},pointIsVisible:function(t){return o._renderer.pointIsVisible(t)},addGeometry:function(t){return o._renderer.addGeometry(t)},updateGeometry:function(t,e){o._renderer.updateGeometry(t,e)},onChunkCreated:function(){++o._chunksCreated},onChunkDiscarded:function(){++o._chunksDiscarded}});t=function(t){for(var e=t.targetTouches,n=o._renderer.getSize(),r=o._touches.length=0;r<e.length;++r)o._touches.push([e[r].pageX,n[1]-e[r].pageY])};e.addEventListener("touchstart",t),e.addEventListener("touchend",t),e.addEventListener("touchmove",t);t=document.getElementById("gui_fullscreen");if(!t)throw new Error("gui_fullscreen not found");t.addEventListener("click",function(){var t=document.getElementById("canvasesdiv");if(!t)throw new Error("canvasesdiv not found");t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()});t=function(){var t=document.getElementById("canvasesdiv");if(!t)throw new Error("canvasesdiv not found");var e=document.getElementById("main-canvas");if(!t)throw new Error("main-canvas not found");var n=null,r=null,r=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement?(t.style.position="absolute",n=window.innerWidth,window.innerHeight):(t.style.position="relative",n=800,600);t.style.left="0px",t.style.top="0px",e.width=n,e.height=r,o._renderer.resize(n,r)};document.addEventListener("fullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),document.addEventListener("webkitfullscreenchange",t,!1),document.addEventListener("msfullscreenchange",t,!1),this._running=!1,this._errorGraphicContext=!1,this._renderer.set_on_context_lost(function(){console.log("on_context_lost"),o._errorGraphicContext=!0,o.stop()}),this._renderer.set_on_context_restored(function(){console.log("on_context_restored"),o._errorGraphicContext=!1,o.start()})}n.default=t},{"../constants":13,"./generation/ChunkGenerator":15,"./webGLRenderer/WebGLRenderer":16,fpsmeter:1}],15:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var f,l=t("../../constants");(t=f=f||{})[t.available=1]="available",t[t.working=2]="working";r.prototype._addWorker=function(){var r=this,o={instance:new Worker("./dist/worker.js"),float32buffer:new Float32Array(1e6),status:f.available};o.instance.addEventListener("message",function(t){var e=t.data.position;o.float32buffer=t.data.float32buffer,o.status=f.available;for(var n=0;n<r._processingPositions.length;++n)if(r._processingPositions[n][0]===e[0]&&r._processingPositions[n][1]===e[1]&&r._processingPositions[n][2]===e[2]){r._processingPositions.splice(n,1);break}r._running&&(t=void 0,0==r._geometriesPool.length?t=r._def.addGeometry(o.float32buffer):(t=r._geometriesPool.pop())&&r._def.updateGeometry(t,o.float32buffer),t?(r._chunks.push({position:e,geometry:t,coord2d:null,visible:!1}),r._def.onChunkCreated&&r._def.onChunkCreated(),r._launchWorker()):console.log("worker: processing the result -> invalid geometry"))},!1),this._workers.push(o)},r.prototype.start=function(){this._running=!0},r.prototype.stop=function(){this._running&&(this._running=!1,this._chunkPositionQueue.length=0,this._chunks.length=0,this._geometriesPool.length=0)},r.prototype.update=function(t){if(this._running){this._cameraPosition=t;t=[0|Math.floor(t[0]/l.default),0|Math.floor(t[1]/l.default),0|Math.floor(t[2]/l.default)];if(0==this._chunks.length||t[0]!=this._savedIndex[0]||t[1]!=this._savedIndex[1]||t[2]!=this._savedIndex[2]){this._savedIndex[0]=t[0],this._savedIndex[1]=t[1],this._savedIndex[2]=t[2],this._chunkPositionQueue.length=0;for(var e=[Math.floor(t[0]-3),Math.floor(t[1]-3),Math.floor(t[2]-3)],n=[Math.floor(t[0]+3),Math.floor(t[1]+3),Math.floor(t[2]+3)],r=0;r<this._chunks.length;++r){var o=[this._chunks[r].position[0]/l.default|0,this._chunks[r].position[1]/l.default|0,this._chunks[r].position[2]/l.default|0];(o[0]<e[0]||n[0]<o[0]||o[1]<e[1]||n[1]<o[1]||o[2]<e[2]||n[2]<o[2])&&(this._geometriesPool.push(this._chunks[r].geometry),this._chunks.splice(r,1),--r,this._def.onChunkDiscarded&&this._def.onChunkDiscarded())}for(var i=e[2];i<=n[2];++i)for(var a=e[1];a<=n[1];++a)for(var u=e[0];u<=n[0];++u){for(var s=[u*l.default,a*l.default,i*l.default],c=!1,f=0;f<this._chunks.length;++f)if(this._chunks[f].position[0]===s[0]&&this._chunks[f].position[1]===s[1]&&this._chunks[f].position[2]===s[2]){c=!0;break}c||this._chunkPositionQueue.push(s)}this._launchWorker()}}},r.prototype._launchWorker=function(){var t=this._workers.find(function(t){return t.status==f.available});if(void 0!==t&&0!=this._chunkPositionQueue.length){var e,n,r,o=void 0;if(1==this._chunkPositionQueue.length)o=this._chunkPositionQueue.pop();else{for(var i=-1,a=999999,u=void 0,s=0;s<this._chunkPositionQueue.length;++s){var c=this._chunkPositionQueue[s];-1!=i&&!this._def.chunkIsVisible(c)||(c=[this._cameraPosition[0]-c[0]-l.default/2,this._cameraPosition[1]-c[1]-l.default/2,this._cameraPosition[2]-c[2]-l.default/2],e=c[0],n=c[1],r=c[2],a<(c=Math.sqrt(e*e+n*n+r*r))||(a=c,u=this._chunkPositionQueue[i=s]))}this._chunkPositionQueue.splice(i,1),o=u}void 0!==o&&(this._processingPositions.push(o),t.status=f.working,t.instance.postMessage({position:o,float32buffer:t.float32buffer},[t.float32buffer.buffer]))}},r.prototype.getChunks=function(){return this._chunks},r.prototype.getProcessingPositions=function(){return this._processingPositions},t=r;function r(t){this._running=!1,this._chunks=[],this._chunkPositionQueue=[],this._geometriesPool=[],this._savedIndex=[999,999,999],this._workers=[],this._cameraPosition=[0,0,0],this._processingPositions=[],this._def=t;for(var e=0;e<2;++e)this._addWorker()}n.default=t},{"../../constants":13}],16:[function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},o=this&&this.__generator||function(n,r){var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(n,"__esModule",{value:!0});var l=t("../../constants"),m=t("./wrappers/WebGLContext"),c=t("./wrappers/ShaderProgram"),_=t("./wrappers/Texture"),f=t("./wrappers/Geometry"),i=t("./camera/FreeFlyCamera"),a=t("./camera/FrustumCulling"),u=t("./camera/sceneToScreenCoordinates"),h=t("./shaders/index"),d=t("./utils/generateWireframeCubeVertices"),p=t("./utils/generateWireframeFrustumVertices"),v=t("gl-matrix"),t=(s.prototype._initialiseChunkRendering=function(){var t=new c.default({vertexSrc:h.scene.vertex,fragmentSrc:h.scene.fragment,attributes:["a_vertexPosition","a_vertexColor","a_vertexNormal","a_vertexBCenter"],uniforms:["u_modelviewMatrix","u_projMatrix","u_cameraPos","u_sampler"]}),e={vbos:[{attrs:[{name:"a_vertexPosition",type:f.default.AttributeType.vec3f,index:0},{name:"a_vertexColor",type:f.default.AttributeType.vec3f,index:3},{name:"a_vertexNormal",type:f.default.AttributeType.vec3f,index:6},{name:"a_vertexBCenter",type:f.default.AttributeType.vec3f,index:9}],stride:48,instanced:!1}],primitiveType:f.default.PrimitiveType.triangles};this._chunkRendering={texture:new _.default,shader:t,geometryDefinition:e}},s.prototype._initialiseWireframeRendering=function(){var t=new c.default({vertexSrc:h.color.vertex,fragmentSrc:h.color.fragment,attributes:["a_vertexPosition","a_vertexColor"],uniforms:["u_modelviewMatrix","u_projMatrix"]}),e={vbos:[{attrs:[{name:"a_vertexPosition",type:f.default.AttributeType.vec3f,index:0},{name:"a_vertexColor",type:f.default.AttributeType.vec3f,index:3}],stride:24,instanced:!1}],primitiveType:f.default.PrimitiveType.lines};(o=[]).push(0,0,0,1,0,0,20,0,0,1,0,0),o.push(0,0,0,0,1,0,0,20,0,0,1,0),o.push(0,0,0,0,0,1,0,0,20,0,0,1);var n=new f.default.Geometry(t,e);n.updateBuffer(0,o),n.setPrimitiveCount(o.length/6),o.length=0;o.push(-5,0,0,1,1,1),o.push(25,0,0,1,1,1),o.push(0,-5,0,1,1,1),o.push(0,5,0,1,1,1),o.push(0,0,-5,1,1,1),o.push(0,0,5,1,1,1);var r=new f.default.Geometry(t,e);r.updateBuffer(0,o),r.setPrimitiveCount(o.length/6);var o=d.default(l.default,[1,0,0]),i=new f.default.Geometry(t,e);i.updateBuffer(0,o),i.setPrimitiveCount(o.length/6),o=d.default(l.default,[1,1,1]);var a=new f.default.Geometry(t,e);a.updateBuffer(0,o),a.setPrimitiveCount(o.length/6),o=d.default(l.default,[0,1,0]);var u=new f.default.Geometry(t,e);u.updateBuffer(0,o),u.setPrimitiveCount(o.length/6);var s=new f.default.Geometry(t,e);o=p.default(70,this._aspectRatio,.1,40);e=new f.default.Geometry(t,e);e.updateBuffer(0,o),e.setPrimitiveCount(o.length/6);o={vbos:[{attrs:[{name:"a_vertexPosition",type:f.default.AttributeType.vec3f,index:0},{name:"a_vertexColor",type:f.default.AttributeType.vec3f,index:3}],stride:24,instanced:!1}],primitiveType:f.default.PrimitiveType.triangles},o=new f.default.Geometry(t,o);this._wireframeRendering={shader:t,geometry_frustum:e,geometry_axis:n,geometry_cross:r,geometry_cubeR:i,geometry_cubeW:a,geometry_cubeG:u,geometry_wireframe_stack_rendering:s,geometry_thick_line_stack_rendering:o}},s.prototype._initialiseTextRendering=function(){for(var t=new c.default({vertexSrc:h.text.vertex,fragmentSrc:h.text.fragment,attributes:["a_position","a_texCoord","a_offsetPosition","a_offsetTexCoord","a_offsetScale"],uniforms:["u_modelviewMatrix","u_projectionMatrix","u_texture"]}),e={vbos:[{attrs:[{name:"a_position",type:f.default.AttributeType.vec2f,index:0},{name:"a_texCoord",type:f.default.AttributeType.vec2f,index:2}],stride:16,instanced:!1},{attrs:[{name:"a_offsetPosition",type:f.default.AttributeType.vec2f,index:0},{name:"a_offsetTexCoord",type:f.default.AttributeType.vec2f,index:2},{name:"a_offsetScale",type:f.default.AttributeType.float,index:4}],stride:20,instanced:!0}],primitiveType:f.default.PrimitiveType.triangles},n=new f.default.Geometry(t,e),r=[256,256],e=[16,16],e=[r[0]/e[0],r[1]/e[1]],r=[e[0]/r[0],e[1]/r[1]],o=[[[+e[0],0],[r[0],r[1]]],[[0,0],[0,r[1]]],[[+e[0],+e[1]],[r[0],0]],[[0,+e[1]],[0,0]]],i=[],a=0,u=[1,0,2,1,3,2];a<u.length;a++){var s=o[u[a]];i.push(s[0][0],s[0][1],s[1][0],s[1][1])}n.updateBuffer(0,i),n.setPrimitiveCount(i.length/4);r=new Map([[" ",[0*r[0],0*r[1]]],["!",[+r[0],0*r[1]]],['"',[2*r[0],0*r[1]]],["#",[3*r[0],0*r[1]]],["$",[4*r[0],0*r[1]]],["%",[5*r[0],0*r[1]]],["&",[6*r[0],0*r[1]]],["'",[7*r[0],0*r[1]]],["(",[8*r[0],0*r[1]]],[")",[9*r[0],0*r[1]]],["*",[10*r[0],0*r[1]]],["+",[11*r[0],0*r[1]]],[",",[12*r[0],0*r[1]]],["-",[13*r[0],0*r[1]]],[".",[14*r[0],0*r[1]]],["/",[15*r[0],0*r[1]]],["0",[0*r[0],+r[1]]],["1",[+r[0],+r[1]]],["2",[2*r[0],+r[1]]],["3",[3*r[0],+r[1]]],["4",[4*r[0],+r[1]]],["5",[5*r[0],+r[1]]],["6",[6*r[0],+r[1]]],["7",[7*r[0],+r[1]]],["8",[8*r[0],+r[1]]],["9",[9*r[0],+r[1]]],[":",[10*r[0],+r[1]]],[";",[11*r[0],+r[1]]],["<",[12*r[0],+r[1]]],["=",[13*r[0],+r[1]]],[">",[14*r[0],+r[1]]],["?",[15*r[0],+r[1]]],["@",[0*r[0],2*r[1]]],["A",[+r[0],2*r[1]]],["B",[2*r[0],2*r[1]]],["C",[3*r[0],2*r[1]]],["D",[4*r[0],2*r[1]]],["E",[5*r[0],2*r[1]]],["F",[6*r[0],2*r[1]]],["G",[7*r[0],2*r[1]]],["H",[8*r[0],2*r[1]]],["I",[9*r[0],2*r[1]]],["J",[10*r[0],2*r[1]]],["K",[11*r[0],2*r[1]]],["L",[12*r[0],2*r[1]]],["M",[13*r[0],2*r[1]]],["N",[14*r[0],2*r[1]]],["O",[15*r[0],2*r[1]]],["P",[0*r[0],3*r[1]]],["Q",[+r[0],3*r[1]]],["R",[2*r[0],3*r[1]]],["S",[3*r[0],3*r[1]]],["T",[4*r[0],3*r[1]]],["U",[5*r[0],3*r[1]]],["V",[6*r[0],3*r[1]]],["W",[7*r[0],3*r[1]]],["X",[8*r[0],3*r[1]]],["Y",[9*r[0],3*r[1]]],["Z",[10*r[0],3*r[1]]],["[",[11*r[0],3*r[1]]],["\\",[12*r[0],3*r[1]]],["]",[13*r[0],3*r[1]]],["^",[14*r[0],3*r[1]]],["_",[15*r[0],3*r[1]]],["`",[0*r[0],4*r[1]]],["a",[+r[0],4*r[1]]],["b",[2*r[0],4*r[1]]],["c",[3*r[0],4*r[1]]],["d",[4*r[0],4*r[1]]],["e",[5*r[0],4*r[1]]],["f",[6*r[0],4*r[1]]],["g",[7*r[0],4*r[1]]],["h",[8*r[0],4*r[1]]],["i",[9*r[0],4*r[1]]],["j",[10*r[0],4*r[1]]],["k",[11*r[0],4*r[1]]],["l",[12*r[0],4*r[1]]],["m",[13*r[0],4*r[1]]],["n",[14*r[0],4*r[1]]],["o",[15*r[0],4*r[1]]],["p",[0*r[0],5*r[1]]],["q",[+r[0],5*r[1]]],["r",[2*r[0],5*r[1]]],["s",[3*r[0],5*r[1]]],["t",[4*r[0],5*r[1]]],["u",[5*r[0],5*r[1]]],["v",[6*r[0],5*r[1]]],["w",[7*r[0],5*r[1]]],["x",[8*r[0],5*r[1]]],["y",[9*r[0],5*r[1]]],["z",[10*r[0],5*r[1]]],["{",[11*r[0],5*r[1]]],["|",[12*r[0],5*r[1]]],["}",[13*r[0],5*r[1]]],["~",[14*r[0],5*r[1]]]]);this._textRendering={texture:new _.default,shader:t,geometry:n,TexCoordMap:r,stack_vertices:[]}},s.prototype.chunkIsVisible=function(t){var e=.5*l.default;return this._frustum_culling.cubeInFrustum(t[0]+e,t[1]+e,t[2]+e,e)},s.prototype.pointIsVisible=function(t){return this._frustum_culling.pointInFrustum(t[0],t[1],t[2])},s.prototype.addGeometry=function(t){var e=new f.default.Geometry(this._chunkRendering.shader,this._chunkRendering.geometryDefinition);return e.updateBuffer(0,t),e.setPrimitiveCount(t.length/12),e},s.prototype.updateGeometry=function(t,e){t.updateBuffer(0,e)},s.prototype.getCameraPosition=function(){return this._free_fly_camera.getPosition()},s.prototype.getFreeFlyCamera=function(){return this._free_fly_camera},s.prototype.resize=function(t,e){var n=m.default.getViewportSize();n[0]=t,n[1]=e,this._aspectRatio=.75*n[0]/n[1];n=p.default(70,this._aspectRatio,.1,40);this._wireframeRendering.geometry_frustum.updateBuffer(0,n),this._wireframeRendering.geometry_frustum.setPrimitiveCount(n.length/6)},s.prototype.toggle_context_loss=function(){var t=m.default.getContext(),e=m.default.getExtensionLoseContext();e&&(t.isContextLost()?e.restoreContext():e.loseContext())},s.prototype.context_is_lost=function(){return m.default.getContext().isContextLost()},s.prototype.set_on_context_lost=function(t){this.on_context_lost=t},s.prototype.set_on_context_restored=function(t){this.on_context_restored=t},s.prototype.init=function(){return r(this,void 0,void 0,function(){var e;return o(this,function(t){switch(t.label){case 0:return(e=m.default.getContext()).clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.activeTexture(e.TEXTURE0),[4,this._chunkRendering.texture.load("assets/texture.png")];case 1:return t.sent(),[4,this._textRendering.texture.load("assets/ascii_font.png")];case 2:return t.sent(),[2]}})})},s.prototype.getSize=function(){var t=m.default.getViewportSize();return[t[0],t[1]]},s.prototype.update=function(t){var e=m.default.getViewportSize();this._free_fly_camera.handleKeys(),this._free_fly_camera.update(1/60),v.mat4.perspective(this._projection_matrix,70,this._aspectRatio,.1,70),this._free_fly_camera.updateViewMatrix(this._modelview_matrix),this._frustum_culling.calculateFrustum(this._projection_matrix,this._modelview_matrix);for(var n=[0,0,.75*e[0],e[1]],r=0;r<t.length;++r){var o=t[r].position;t[r].visible=this.chunkIsVisible(o),t[r].coord2d=null,!this.pointIsVisible(o)||(o=u.default(o,this._modelview_matrix,this._projection_matrix,n))&&(t[r].coord2d=o)}},s.prototype.pushText=function(t,e,n){for(var r=[256,256],o=[16,16],i=[r[0]/o[0],r[1]/o[1]],a=[e[0],e[1]],u=0,s=t;u<s.length;u++){var c=s[u];if("\n"!=c){var f=this._textRendering.TexCoordMap.get(c);if(!f)throw new Error("fail to find a letter, letter="+c);this._textRendering.stack_vertices.push(a[0],a[1],f[0],f[1],n),a[0]+=i[0]*n}else a[0]=e[0],a[1]-=i[1]*n}},s.prototype.renderScene=function(t){var e=m.default.getContext(),n=m.default.getViewportSize();e.viewport(0,0,.75*n[0],n[1]),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this._chunkRendering.shader.bind(),this._chunkRendering.texture.bind(),e.uniform1i(this._chunkRendering.shader.getUniform("u_sampler"),0),e.uniformMatrix4fv(this._chunkRendering.shader.getUniform("u_modelviewMatrix"),!1,this._modelview_matrix),e.uniformMatrix4fv(this._chunkRendering.shader.getUniform("u_projMatrix"),!1,this._projection_matrix);n=this._free_fly_camera.getPosition();e.uniform3f(this._chunkRendering.shader.getUniform("u_cameraPos"),n[0],n[1],n[2]);for(var r=0;r<t.length;++r)t[r].visible&&t[r].geometry.render();this._wireframeRendering.shader.bind(),e.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_projMatrix"),!1,this._projection_matrix),e.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,this._modelview_matrix);for(var o,i=v.mat4.create(),r=0;r<t.length;++r)t[r].visible&&(o=t[r].position,v.mat4.translate(i,this._modelview_matrix,o),e.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,i),this._wireframeRendering.geometry_cubeW.render());c.default.unbind()},s.prototype.renderHUD=function(t,e,n){var r=m.default.getContext(),o=m.default.getViewportSize();this._wireframeRendering.shader.bind();var i=.25*o[0],a=.75*o[0],o=.33*o[1];r.clear(r.DEPTH_BUFFER_BIT),this._render_main_hud(t,n),this._wireframeRendering.shader.bind(),this._render_side_hud(t,e,[a,0*o,i,o],[1,1.2,1],[0,0,1]),this._render_side_hud(t,e,[a,o,i,o],[0,1,0],[0,0,1]),this._render_side_hud(t,e,[a,2*o,i,o],[0,0,1],[0,1,0]),c.default.unbind()},s.prototype._render_main_hud=function(t,e){var n=m.default.getContext(),r=m.default.getViewportSize(),o=.75*r[0],i=r[1];n.viewport(0,0,o,i);var a=v.mat4.create();v.mat4.ortho(a,.5*-o,.5*o,.5*-i,.5*+i,-200,200);r=v.mat4.create();v.mat4.lookAt(r,[.5*o,.5*+i,1],[.5*o,.5*+i,0],[0,1,0]),n.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,r),n.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_projMatrix"),!1,a);for(var u=[],s=function(t,e,n,r){void 0===r&&(r=[1,1,1]);var o=Math.atan2(e[1]-t[1],e[0]-t[0])+.5*Math.PI,i=Math.cos(o)*n*.5,n=Math.sin(o)*n*.5,n=[[t[0]-i,t[1]-n],[t[0]+i,t[1]+n],[e[0]-i,e[1]-n],[e[0]+i,e[1]+n]];u.push(n[0][0],n[0][1],0,r[0],r[1],r[2]),u.push(n[3][0],n[3][1],0,r[0],r[1],r[2]),u.push(n[2][0],n[2][1],0,r[0],r[1],r[2]),u.push(n[0][0],n[0][1],0,r[0],r[1],r[2]),u.push(n[1][0],n[1][1],0,r[0],r[1],r[2]),u.push(n[3][0],n[3][1],0,r[0],r[1],r[2])},c=0,f=e;c<f.length;c++){var l=f[c],h=[1,0,0],d=100;s([l[0]-d,l[1]-d],[l[0]+d,l[1]+d],15,h),s([l[0]-d,l[1]+d],[l[0]+d,l[1]-d],15,h),this._free_fly_camera.getForceForward()&&(s([l[0]-d,l[1]],[l[0]+d,l[1]],15,h),s([l[0],l[1]-d],[l[0],l[1]+d],15,h))}this._wireframeRendering.geometry_thick_line_stack_rendering.updateBuffer(0,u),this._wireframeRendering.geometry_thick_line_stack_rendering.setPrimitiveCount(u.length/6),this._wireframeRendering.geometry_thick_line_stack_rendering.render(),this._textRendering.shader.bind(),this._textRendering.texture.bind(),n.uniformMatrix4fv(this._textRendering.shader.getUniform("u_modelviewMatrix"),!1,r),n.uniformMatrix4fv(this._textRendering.shader.getUniform("u_projectionMatrix"),!1,a),this._textRendering.geometry.updateBuffer(1,this._textRendering.stack_vertices,!0),this._textRendering.geometry.setInstancedCount(this._textRendering.stack_vertices.length/5),this._textRendering.geometry.render(),_.default.unbind(),this._textRendering.stack_vertices.length=0},s.prototype._render_side_hud=function(t,e,n,r,o){var i=m.default.getContext();i.viewport(n[0],n[1],n[2],n[3]);var a=v.mat4.create(),n=n[2]/n[3];v.mat4.ortho(a,-65*n,65*n,-65,65,-200,200);var n=this._free_fly_camera.getPosition(),u=v.mat4.create();v.mat4.lookAt(u,[n[0]+r[0],n[1]+r[1],n[2]+r[2]],[n[0],n[1],n[2]],o),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,u),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_projMatrix"),!1,a),this._wireframeRendering.geometry_axis.render();for(var s=v.mat4.create(),c=0;c<t.length;++c){var f=t[c].position;v.mat4.identity(s),t[c].visible?(v.mat4.translate(s,u,f),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,s),this._wireframeRendering.geometry_cubeW.render()):(v.mat4.translate(s,u,[f[0]+.15*l.default,f[1]+.15*l.default,f[2]+.15*l.default]),v.mat4.scale(s,s,[.7,.7,.7]),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,s),this._wireframeRendering.geometry_cubeR.render())}if(0<e.length)for(c=0;c<e.length;++c)v.mat4.translate(s,u,[e[c][0]+.2*l.default,e[c][1]+.2*l.default,e[c][2]+.2*l.default]),v.mat4.scale(s,s,[.6,.6,.6]),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,s),this._wireframeRendering.geometry_cubeG.render();v.mat4.translate(u,u,this._free_fly_camera.getPosition()),v.mat4.rotate(u,u,this._free_fly_camera.getTheta()*Math.PI/180,[0,0,1]),v.mat4.rotate(u,u,this._free_fly_camera.getPhi()*Math.PI/180,[0,-1,0]),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,u),this._wireframeRendering.geometry_cross.render(),this._wireframeRendering.geometry_frustum.render()},s);function s(t,e){var n=this;this.on_context_lost=null,this.on_context_restored=null,m.default.initialise(e),e.addEventListener("webglcontextlost",function(t){t.preventDefault(),console.log("context is lost"),n.on_context_lost&&n.on_context_lost()},!1),e.addEventListener("webglcontextrestored",function(){console.log("context is restored"),m.default.initialise(e),n.on_context_restored&&n.on_context_restored()},!1);var r=m.default.getViewportSize();this._free_fly_camera=new i.default(t),this._free_fly_camera.activate(),this._free_fly_camera.setPosition(l.default/4*3,l.default/4*3,0),this._frustum_culling=new a.default,this._projection_matrix=v.mat4.create(),this._modelview_matrix=v.mat4.create(),this._aspectRatio=.75*r[0]/r[1],this._initialiseChunkRendering(),this._initialiseWireframeRendering(),this._initialiseTextRendering()}n.default=t},{"../../constants":13,"./camera/FreeFlyCamera":17,"./camera/FrustumCulling":18,"./camera/sceneToScreenCoordinates":21,"./shaders/index":23,"./utils/generateWireframeCubeVertices":26,"./utils/generateWireframeFrustumVertices":27,"./wrappers/Geometry":28,"./wrappers/ShaderProgram":29,"./wrappers/Texture":30,"./wrappers/WebGLContext":31,"gl-matrix":3}],17:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("gl-matrix"),a=t("./helpers/KeyboardHandler"),u=t("./helpers/PointerLockSetup"),t=(o.prototype.update=function(t){this.handleKeys();var e=Date.now();this._time_immobile+=t,3e3<e-this._last_time&&(this._time_immobile=10),this._last_time=e,this._force_forward&&(this._time_immobile=0);if(1&this._movement_flag||1==this._force_forward)for(var n=0;n<3;++n)this._position[n]+=this._forward[n]*t*16;else if(2&this._movement_flag)for(n=0;n<3;++n)this._position[n]-=this._forward[n]*t*16;if(4&this._movement_flag)for(n=0;n<3;++n)this._position[n]-=this._left[n]*t*16;else if(8&this._movement_flag)for(n=0;n<3;++n)this._position[n]+=this._left[n]*t*16;this._movement_flag=0;this._phi=Math.min(Math.max(this._phi,-89),89);var r=[0,0,1],e=Math.cos(3.14*(this._phi-90)/180);r[2]=Math.sin(3.14*(this._phi-90)/180),r[0]=e*Math.cos(3.14*this._theta/180),r[1]=e*Math.sin(3.14*this._theta/180);e=Math.cos(3.14*this._phi/180);this._forward[2]=Math.sin(3.14*this._phi/180),this._forward[0]=e*Math.cos(3.14*this._theta/180),this._forward[1]=e*Math.sin(3.14*this._theta/180),this._left[0]=r[1]*this._forward[2]-r[2]*this._forward[1],this._left[1]=r[2]*this._forward[0]-r[0]*this._forward[2],this._left[2]=r[0]*this._forward[1]-r[1]*this._forward[0],this._target[0]=this._position[0]+this._forward[0],this._target[1]=this._position[1]+this._forward[1],this._target[2]=this._position[2]+this._forward[2]},o.prototype.updateViewMatrix=function(t){r.mat4.lookAt(t,[this._position[0],this._position[1],this._position[2]],[this._target[0],this._target[1],this._target[2]],[0,0,1])},o.prototype.setPosition=function(t,e,n){this._position[0]=t,this._position[1]=e,this._position[2]=n},o.prototype.getPosition=function(){return[this._position[0],this._position[1],this._position[2]]},o.prototype.getTheta=function(){return this._theta},o.prototype.getPhi=function(){return this._phi},o.prototype.getForceForward=function(){return this._force_forward},o.prototype.getTimeImmobile=function(){return this._time_immobile},o.prototype.handleKeys=function(){(this._keyboard_handler.isPressed(a.keyCodes.KEY_Z)||this._keyboard_handler.isPressed(a.keyCodes.KEY_W))&&(this._movement_flag|=1,this._time_immobile=0),this._keyboard_handler.isPressed(a.keyCodes.KEY_S)&&(this._movement_flag|=2,this._time_immobile=0),(this._keyboard_handler.isPressed(a.keyCodes.KEY_A)||this._keyboard_handler.isPressed(a.keyCodes.KEY_Q))&&(this._movement_flag|=4,this._time_immobile=0),this._keyboard_handler.isPressed(a.keyCodes.KEY_D)&&(this._movement_flag|=8,this._time_immobile=0),this._keyboard_handler.isPressed(a.keyCodes.ARROW_UP)&&(this._phi++,this._time_immobile=0),this._keyboard_handler.isPressed(a.keyCodes.ARROW_DOWN)&&(this._phi--,this._time_immobile=0),this._keyboard_handler.isPressed(a.keyCodes.ARROW_LEFT)&&(this._theta++,this._time_immobile=0),this._keyboard_handler.isPressed(a.keyCodes.ARROW_RIGHT)&&(this._theta--,this._time_immobile=0)},o.prototype.activate=function(){this._keyboard_handler.activate()},o.prototype.deactivate=function(){this._keyboard_handler.deactivate()},o);function o(t){var r=this;this._phi=0,this._theta=0,this._forward=[1,0,0],this._left=[0,0,0],this._position=[0,0,0],this._target=[0,0,0],this._movement_flag=0,this._keyboard_handler=new a.KeyboardHandler,this._force_forward=!1,this._time_immobile=0,this._last_time=0,this._last_time=Date.now();function e(t){var e=t.movementX||t.mozMovementX||t.webkitMovementX||0,t=t.movementY||t.mozMovementY||t.webkitMovementY||0;r._theta-=e/5,r._phi-=t/5,r._time_immobile=0}u.default({target_element:t,cb_enabled:function(){t.addEventListener("mousemove",e,!1)},cb_disabled:function(){t.removeEventListener("mousemove",e,!1)}});var o=null,i=null,n=Date.now();t.addEventListener("touchstart",function(t){t.preventDefault(),i=o=null;var e=Date.now();1==t.targetTouches.length&&e-n<250&&(r._force_forward=!0),n=e}),t.addEventListener("touchend",function(t){t.preventDefault(),i=o=null,r._force_forward=!1}),t.addEventListener("touchmove",function(t){t.preventDefault();var e,n,t=t.targetTouches;0==t.length||2<t.length||(2==t.length?(n=t[0].pageX-t[1].pageX,e=t[0].pageY-t[1].pageY,n=Math.sqrt(n*n+e*e),i&&(r._movement_flag|=i<n?1:2),i=n):(o&&(e=o.pageX-t[0].pageX,n=o.pageY-t[0].pageY,r._theta-=e/5,r._phi-=n/5),o=t[0]),r._time_immobile=0)})}n.default=t},{"./helpers/KeyboardHandler":19,"./helpers/PointerLockSetup":20,"gl-matrix":3}],18:[function(t,e,n){"use strict";var r,a;Object.defineProperty(n,"__esModule",{value:!0}),(o=r=r||{})[o.Right=0]="Right",o[o.Left=1]="Left",o[o.Bottom=2]="Bottom",o[o.Top=3]="Top",o[o.Back=4]="Back",o[o.Front=5]="Front",(o=a=a||{})[o.A=0]="A",o[o.B=1]="B",o[o.C=2]="C",o[o.D=3]="D";var o=(i.prototype.normalizePlane=function(t){var e=4*t,t=Math.sqrt(this._Frustum[e+a.A]*this._Frustum[e+a.A]+this._Frustum[e+a.B]*this._Frustum[e+a.B]+this._Frustum[e+a.C]*this._Frustum[e+a.C]);this._Frustum[e+a.A]/=t,this._Frustum[e+a.B]/=t,this._Frustum[e+a.C]/=t,this._Frustum[e+a.D]/=t},i.prototype.calculateFrustum=function(t,e){var n=new Float32Array(16);n[0]=e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12],n[1]=e[0]*t[1]+e[1]*t[5]+e[2]*t[9]+e[3]*t[13],n[2]=e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+e[3]*t[14],n[3]=e[0]*t[3]+e[1]*t[7]+e[2]*t[11]+e[3]*t[15],n[4]=e[4]*t[0]+e[5]*t[4]+e[6]*t[8]+e[7]*t[12],n[5]=e[4]*t[1]+e[5]*t[5]+e[6]*t[9]+e[7]*t[13],n[6]=e[4]*t[2]+e[5]*t[6]+e[6]*t[10]+e[7]*t[14],n[7]=e[4]*t[3]+e[5]*t[7]+e[6]*t[11]+e[7]*t[15],n[8]=e[8]*t[0]+e[9]*t[4]+e[10]*t[8]+e[11]*t[12],n[9]=e[8]*t[1]+e[9]*t[5]+e[10]*t[9]+e[11]*t[13],n[10]=e[8]*t[2]+e[9]*t[6]+e[10]*t[10]+e[11]*t[14],n[11]=e[8]*t[3]+e[9]*t[7]+e[10]*t[11]+e[11]*t[15],n[12]=e[12]*t[0]+e[13]*t[4]+e[14]*t[8]+e[15]*t[12],n[13]=e[12]*t[1]+e[13]*t[5]+e[14]*t[9]+e[15]*t[13],n[14]=e[12]*t[2]+e[13]*t[6]+e[14]*t[10]+e[15]*t[14],n[15]=e[12]*t[3]+e[13]*t[7]+e[14]*t[11]+e[15]*t[15];t=4*r.Right;this._Frustum[t+a.A]=n[3]-n[0],this._Frustum[t+a.B]=n[7]-n[4],this._Frustum[t+a.C]=n[11]-n[8],this._Frustum[t+a.D]=n[15]-n[12],this.normalizePlane(r.Right),t=4*r.Left,this._Frustum[t+a.A]=n[3]+n[0],this._Frustum[t+a.B]=n[7]+n[4],this._Frustum[t+a.C]=n[11]+n[8],this._Frustum[t+a.D]=n[15]+n[12],this.normalizePlane(r.Left),t=4*r.Bottom,this._Frustum[t+a.A]=n[3]+n[1],this._Frustum[t+a.B]=n[7]+n[5],this._Frustum[t+a.C]=n[11]+n[9],this._Frustum[t+a.D]=n[15]+n[13],this.normalizePlane(r.Bottom),t=4*r.Top,this._Frustum[t+a.A]=n[3]-n[1],this._Frustum[t+a.B]=n[7]-n[5],this._Frustum[t+a.C]=n[11]-n[9],this._Frustum[t+a.D]=n[15]-n[13],this.normalizePlane(r.Top),t=4*r.Back,this._Frustum[t+a.A]=n[3]-n[2],this._Frustum[t+a.B]=n[7]-n[6],this._Frustum[t+a.C]=n[11]-n[10],this._Frustum[t+a.D]=n[15]-n[14],this.normalizePlane(r.Back),t=4*r.Front,this._Frustum[t+a.A]=n[3]+n[2],this._Frustum[t+a.B]=n[7]+n[6],this._Frustum[t+a.C]=n[11]+n[10],this._Frustum[t+a.D]=n[15]+n[14],this.normalizePlane(r.Front)},i.prototype.sphereInFrustum=function(t,e,n,r){for(var o=0;o<6;++o)if(this._Frustum[4*o+a.A]*t+this._Frustum[4*o+a.B]*e+this._Frustum[4*o+a.C]*n+this._Frustum[4*o+a.D]<=r)return!1;return!0},i.prototype.pointInFrustum=function(t,e,n){return this.sphereInFrustum(t,e,n,0)},i.prototype.cubeInFrustum=function(t,e,n,r){for(var o=0;o<6;++o){var i=4*o;if(!(0<this._Frustum[i+a.A]*(t-r)+this._Frustum[i+a.B]*(e-r)+this._Frustum[i+a.C]*(n-r)+this._Frustum[i+a.D])&&!(0<this._Frustum[i+a.A]*(t+r)+this._Frustum[i+a.B]*(e-r)+this._Frustum[i+a.C]*(n-r)+this._Frustum[i+a.D]||0<this._Frustum[i+a.A]*(t-r)+this._Frustum[i+a.B]*(e+r)+this._Frustum[i+a.C]*(n-r)+this._Frustum[i+a.D]||0<this._Frustum[i+a.A]*(t+r)+this._Frustum[i+a.B]*(e+r)+this._Frustum[i+a.C]*(n-r)+this._Frustum[i+a.D]||0<this._Frustum[i+a.A]*(t-r)+this._Frustum[i+a.B]*(e-r)+this._Frustum[i+a.C]*(n+r)+this._Frustum[i+a.D]||0<this._Frustum[i+a.A]*(t+r)+this._Frustum[i+a.B]*(e-r)+this._Frustum[i+a.C]*(n+r)+this._Frustum[i+a.D]||0<this._Frustum[i+a.A]*(t-r)+this._Frustum[i+a.B]*(e+r)+this._Frustum[i+a.C]*(n+r)+this._Frustum[i+a.D]||0<this._Frustum[i+a.A]*(t+r)+this._Frustum[i+a.B]*(e+r)+this._Frustum[i+a.C]*(n+r)+this._Frustum[i+a.D]))return!1}return!0},i);function i(){this._Frustum=new Float32Array(24)}n.default=o},{}],19:[function(t,e,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardHandler=n.keyCodes=void 0,(o=r=r||{}).KEY_Z="z",o.KEY_W="w",o.KEY_S="s",o.KEY_A="a",o.KEY_Q="q",o.KEY_D="d",o.ARROW_LEFT="ArrowLeft",o.ARROW_RIGHT="ArrowRight",o.ARROW_UP="ArrowUp",o.ARROW_DOWN="ArrowDown",n.keyCodes=r;var o=(i.prototype.isPressed=function(t){return this._pressedKeys.get(t)||!1},i.prototype.activate=function(){this._activated||(document.addEventListener("keydown",this._handleKeyDown),document.addEventListener("keyup",this._handleKeyUp),this._activated=!0)},i.prototype.deactivate=function(){this._activated&&(document.removeEventListener("keydown",this._handleKeyDown),document.removeEventListener("keyup",this._handleKeyUp),this._activated=!1)},i);function i(){var e=this;this._pressedKeys=new Map,this._activated=!1;var n=[r.ARROW_LEFT,r.ARROW_RIGHT,r.ARROW_UP,r.ARROW_DOWN];this._activated=!1,this._handleKeyDown=function(t){-1!=n.indexOf(t.key)&&t.preventDefault(),e._pressedKeys.set(t.key,!0)}.bind(this),this._handleKeyUp=function(t){-1!=n.indexOf(t.key)&&t.preventDefault(),e._pressedKeys.set(t.key,!1)}.bind(this)}n.KeyboardHandler=o},{}],20:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=function(e){e.target_element.requestPointerLock=e.target_element.requestPointerLock||e.target_element.mozRequestPointerLock||e.target_element.webkitRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,e.target_element.onclick=function(){e.target_element.requestPointerLock&&e.target_element.requestPointerLock()};function t(){document.pointerLockElement===e.target_element||document.mozPointerLockElement===e.target_element||document.webkitPointerLockElement===e.target_element?(console.log("The pointer lock status is now locked"),e.cb_enabled()):(console.log("The pointer lock status is now unlocked"),e.cb_disabled())}function n(t){console.error("Pointer lock failed"),console.error(t),e.cb_error&&e.cb_error(t)}"onpointerlockchange"in document?document.addEventListener("pointerlockchange",t,!1):"onmozpointerlockchange"in document?document.addEventListener("mozpointerlockchange",t,!1):"onwebkitpointerlockchange"in document&&document.addEventListener("webkitpointerlockchange",t,!1),"onpointerlockerror"in document?document.addEventListener("pointerlockerror",n,!1):"onmozpointerlockerror"in document?document.addEventListener("mozpointerlockerror",n,!1):"onwebkitpointerlockerror"in document&&document.addEventListener("webkitpointerlockerror",n,!1)}},{}],21:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("gl-matrix");n.default=function(t,e,n,r){var o=a.vec4.fromValues(t[0],t[1],t[2],1),i=a.mat4.create(),t=a.vec4.create();return a.mat4.multiply(i,n,e),a.vec4.transformMat4(t,o,i),0===t[3]?null:(t[3]=1/t[3],t[0]*=t[3],t[1]*=t[3],t[2]*=t[3],[(.5*t[0]+.5)*r[2]+r[0],(.5*t[1]+.5)*r[3]+r[1]])}},{"gl-matrix":3}],22:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fragment=n.vertex=void 0;n.vertex="\n\nattribute vec3 a_vertexPosition;\nattribute vec3 a_vertexColor;\n\nvarying vec4 v_color;\n\nuniform mat4 u_modelviewMatrix;\nuniform mat4 u_projMatrix;\n\nvoid main(void)\n{\n    v_color = vec4(a_vertexColor,1.0);\n\n    gl_Position = u_projMatrix * u_modelviewMatrix * vec4(a_vertexPosition, 1.0);\n}\n";n.fragment="\n\nprecision mediump float;\n\nvarying vec4 v_color;\n\nvoid main(void)\n{\n    gl_FragColor = v_color;\n}\n"},{}],23:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.color=t("./color"),n.scene=t("./scene"),n.text=t("./text")},{"./color":22,"./scene":24,"./text":25}],24:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fragment=n.vertex=void 0;n.vertex="\n\nattribute vec3 a_vertexPosition;\nattribute vec3 a_vertexColor;\nattribute vec3 a_vertexNormal;\nattribute vec3 a_vertexBCenter;\n\nuniform mat4 u_modelviewMatrix;\nuniform mat4 u_projMatrix;\nuniform vec3 u_cameraPos;\n\nvarying vec3 v_color;\nvarying vec3 v_bCenter;\n\nvarying vec3 v_normalInterp;\nvarying vec3 v_vertPos;\nvarying float v_distance;\n\nvarying vec3 v_pureVertexPos;\nvarying vec3 v_pureNormalInterp;\n\nconst float k_range_min = 20.0;\nconst float k_range_max = 23.0;\n\nvoid main(void)\n{\n    vec4 vertPos4 = u_modelviewMatrix * vec4(a_vertexPosition, 1.0);\n    v_vertPos = vec3(vertPos4) / vertPos4.w;\n    v_normalInterp = vec3(u_modelviewMatrix * vec4(a_vertexNormal, 0.0));\n\n    v_pureVertexPos = a_vertexPosition;\n    v_pureNormalInterp = a_vertexNormal;\n\n    float tmp_dist = length(a_vertexPosition - u_cameraPos);\n\n    v_distance = tmp_dist;\n\n    v_color = a_vertexColor;\n    v_bCenter = a_vertexBCenter;\n\n    if (tmp_dist < k_range_min ||\n        tmp_dist > k_range_max)\n    {\n        gl_Position = u_projMatrix * u_modelviewMatrix * vec4(a_vertexPosition, 1.0);\n    }\n    else\n    {\n        // bump effect -> bump in the direction of the normal\n\n        gl_Position = u_projMatrix * u_modelviewMatrix * vec4(a_vertexPosition + a_vertexNormal, 1.0);\n    }\n}\n";n.fragment='\n\nprecision mediump float;\n\nuniform sampler2D u_sampler;\n\nvarying vec3 v_color;\nvarying vec3 v_bCenter;\n\nvarying vec3 v_normalInterp;\nvarying vec3 v_vertPos;\nvarying float v_distance;\n\nvarying vec3 v_pureVertexPos;\nvarying vec3 v_pureNormalInterp;\n\nconst vec3 k_lightPos = vec3(0.0,0.0,0.0);\nconst vec3 k_specColor = vec3(1.0, 1.0, 1.0);\n\nconst float k_range_min = 20.0;\nconst float k_range_max = 23.0;\n\nvoid main(void)\n{\n\n    { // wireframe\n\n        if (gl_FrontFacing)\n        {\n            // "bumped wireframe" effect on the front facing\n\n            if (v_distance > k_range_min &&\n                v_distance < k_range_max)\n            {\n\n                if (all(greaterThan(v_bCenter, vec3(0.03))) &&\n                    any(lessThan(v_bCenter, vec3(0.08))))\n                {\n                    gl_FragColor = vec4(v_color, 1.0);\n                    return;\n                }\n\n            }\n\n        }\n        else\n        {\n            // normal wireframe effect on the back facing\n\n            if (any(lessThan(v_bCenter, vec3(0.06))))\n            {\n                gl_FragColor = vec4(1);\n                return;\n            }\n        }\n\n        // wireframe only for the backface\n        if (!gl_FrontFacing)\n            discard;\n\n    } // /wireframe\n\n    vec3 tmp_color = v_color;\n\n    { // texture\n\n        // current 3d texture coordinate\n        vec3 flooredPos = vec3(\n            v_pureVertexPos.x - floor(v_pureVertexPos.x),\n            v_pureVertexPos.y - floor(v_pureVertexPos.y),\n            v_pureVertexPos.z - floor(v_pureVertexPos.z)\n        );\n\n        vec3 blend_weights = abs( normalize( v_pureNormalInterp.xyz ) );\n        blend_weights = max( ( blend_weights - 0.2 ) * 7.0, 0.0 );\n        blend_weights /= ( blend_weights.x + blend_weights.y + blend_weights.z );\n\n        // horizontal texture coordinates -> should be a wall\n        vec2 texcoord1 = vec2(flooredPos.y * 0.5 + 0.5, flooredPos.z * 0.5);\n        vec2 texcoord2 = vec2(flooredPos.x * 0.5 + 0.5, flooredPos.z * 0.5);\n\n        // vertical texture coord -> should be green grass\n        vec2 texcoord3 = vec2(flooredPos.x * 0.5, flooredPos.y * 0.5 + 0.5);\n\n        if (v_pureNormalInterp.z < 0.0)\n        {\n            // switch the texture Y -> dirt on the ceilling instead of grass\n            texcoord3.y -= 0.5;\n        }\n\n        // horizontal color\n        vec3 texColor1 = texture2D( u_sampler, texcoord1 ).rgb;\n        vec3 texColor2 = texture2D( u_sampler, texcoord2 ).rgb;\n\n        // vertical color\n        vec3 texColor3 = texture2D( u_sampler, texcoord3 ).rgb;\n\n        tmp_color = texColor1 * blend_weights.xxx +\n                    texColor2 * blend_weights.yyy +\n                    texColor3 * blend_weights.zzz;\n\n    } // texture\n\n    { // lighting\n\n        vec3 normal = normalize(v_normalInterp);\n        vec3 lightDir = normalize(k_lightPos - v_vertPos);\n\n        float lambertian = max(dot(lightDir,v_normalInterp.xyz), 0.0);\n        float specular = 0.0;\n\n        if (lambertian > 0.0)\n        {\n            // lighting specular\n\n            vec3 reflectDir = reflect(-lightDir, normal);\n            vec3 viewDir = normalize(-v_vertPos);\n\n            float specAngle = max(dot(reflectDir, viewDir), 0.0);\n            specular = pow(specAngle, 16.0);\n        }\n\n        // lighting output\n\n        vec3 ambiant_color = tmp_color.xyz * 0.05;\n        vec3 diffuse_color = tmp_color.xyz * lambertian;\n        vec3 specular_color = k_specColor * specular;\n\n        tmp_color = ambiant_color + diffuse_color + specular_color;\n\n    } // lighting\n\n    gl_FragColor = vec4(tmp_color, 1.0);\n}\n'},{}],25:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fragment=n.vertex=void 0;n.vertex="\n\nprecision mediump float;\n\nuniform mat4 u_modelviewMatrix;\nuniform mat4 u_projectionMatrix;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsetPosition;\nattribute vec2 a_offsetTexCoord;\nattribute float a_offsetScale;\n\nvarying vec2 v_texCoord;\n\nvoid main(void)\n{\n    vec2 position = a_position * a_offsetScale + a_offsetPosition;\n\n    gl_Position = u_projectionMatrix * u_modelviewMatrix * vec4(position, 0.0, 1.0);\n\n    v_texCoord = a_texCoord + a_offsetTexCoord;\n}\n";n.fragment="\n\nprecision mediump float;\n\nuniform sampler2D u_texture;\n\nvarying vec2 v_texCoord;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n\n"},{}],26:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=function(t,e,n){var r=t/2,t=t/2.1,o=[r,r,r,-r,r,r,r,-r,r,-r,-r,r,r,r,-r,-r,r,-r,r,-r,-r,-r,-r,-r,t,t,t,-t,t,t,t,-t,t,-t,-t,t,t,t,-t,-t,t,-t,t,-t,-t,-t,-t,-t],i=[0,1,1,3,3,2,2,0,4,5,5,7,7,6,6,4,0,4,1,5,3,7,2,6,8,9,9,11,11,10,10,8,12,13,13,15,15,14,14,12,8,12,9,13,11,15,10,14];(n=void 0===n?!1:n)&&(i.length/=2);for(var a=[],u=0;u<i.length;++u){for(var s=3*i[u],c=0;c<3;++c)a.push(o[s+c]+r);for(c=0;c<3;++c)a.push(e[c])}return a}},{}],27:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=function(t,e,n,r){for(var o=Math.tan(t/360*Math.PI)*n,i=o*e,a=-i,u=+i,i=+o,o=-o,t=r*Math.sin(t*Math.PI/180),e=t*e,s=[n,a,i,n,u,i,n,a,o,n,u,o,r,-e,+t,r,+e,+t,r,-e,-t,r,+e,-t,r,1.66*-e,-t,r,1.66*-e,+t],c=[0,1,1,3,3,2,2,0,0,4,1,5,2,6,3,7,4,5,5,7,7,6,6,4,8,9,7,8,5,9],f=[],l=0;l<c.length;++l){for(var h=3*c[l],d=0;d<3;++d)f.push(s[h+d]);f.push(1,1,0)}return f}},{}],28:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,A=t("./WebGLContext");!function(E){var k,R;E.BytesPerPixel=4,(t=k=E.AttributeType||(E.AttributeType={}))[t.float=0]="float",t[t.vec2f=1]="vec2f",t[t.vec3f=2]="vec3f",t[t.vec4f=3]="vec4f",t[t.mat3f=4]="mat3f",t[t.mat4f=5]="mat4f",(t=R=E.PrimitiveType||(E.PrimitiveType={}))[t.lines=0]="lines",t[t.triangles=1]="triangles";var t=(e.prototype.dispose=function(){for(var t=A.default.getContext(),e=A.default.getExtensionVaoStrict(),n=0;n<this._vbos.length;++n)t.deleteBuffer(this._vbos[n]);e.deleteVertexArrayOES(this._vao)},e.prototype.updateBuffer=function(t,e,n){if(void 0===n&&(n=!1),t<0||t>=this._vbos.length)throw new Error("no buffer avaialble to tha index");var r=A.default.getContext(),t=this._vbos[t],e=e instanceof Float32Array?e:new Float32Array(e),n=n?r.DYNAMIC_DRAW:r.STATIC_DRAW;r.bindBuffer(r.ARRAY_BUFFER,t),r.bufferData(r.ARRAY_BUFFER,e,n),r.bindBuffer(r.ARRAY_BUFFER,null)},e.prototype.render=function(){var t,e,n;0==this._primitiveCount||this._isInstanced&&0==this._instanceCount||(t=A.default.getContext(),e=A.default.getExtensionVaoStrict(),n=A.default.getExtensionInstancingStrict(),e.bindVertexArrayOES(this._vao),!0===this._isInstanced?n.drawArraysInstancedANGLE(this._primitiveType,this._primitiveStart,this._primitiveCount,this._instanceCount):t.drawArrays(this._primitiveType,this._primitiveStart,this._primitiveCount),e.bindVertexArrayOES(null))},e.prototype.setPrimitiveStart=function(t){this._primitiveStart=t},e.prototype.setPrimitiveCount=function(t){this._primitiveCount=t},e.prototype.setInstancedCount=function(t){this._instanceCount=t},e);function e(t,e){this._primitiveStart=0,this._primitiveCount=0,this._instanceCount=0,this._isInstanced=!1;var n=A.default.getContext();if(0===e.vbos.length)throw new Error("empty vbo defintion");for(var r=0,o=e.vbos;r<o.length;r++){if(0===(h=o[r]).attrs.length)throw new Error("empty vbo attribute defintion");for(var i=0,a=h.attrs;i<a.length;i++){var u=a[i];if(!t.hasAttribute(u.name))throw new Error('attribute not found, name="'+u.name+'"')}}switch((this._def=e).primitiveType){case R.lines:this._primitiveType=n.LINES;break;case R.triangles:this._primitiveType=n.TRIANGLES;break;default:throw new Error("primitive type not found")}var s=A.default.getExtensionVaoStrict(),c=A.default.getExtensionInstancingStrict(),e=s.createVertexArrayOES();if(!e)throw new Error("fail o create a vao unit");this._vao=e,s.bindVertexArrayOES(this._vao),this._vbos=[];for(var f=0,l=this._def.vbos;f<l.length;f++){var h,d=l[f];if(!(h=n.createBuffer()))throw new Error("fail o create a vbo unit");this._vbos.push(h),n.bindBuffer(n.ARRAY_BUFFER,h);var m=d.stride||0;if(!m){for(var _=0,p=d.attrs;_<p.length;_++)switch((u=p[_]).type){case k.float:m+=1;break;case k.vec2f:m+=2;break;case k.vec3f:m+=3;break;case k.vec4f:m+=4;break;case k.mat3f:m+=9;break;case k.mat4f:m+=16}m*=E.BytesPerPixel}for(var v=0,g=d.attrs;v<g.length;v++){var b=1,y=1;switch((u=g[v]).type){case k.float:y=b=1;break;case k.vec2f:b=2,y=1;break;case k.vec3f:b=3,y=1;break;case k.vec4f:b=4,y=1;break;case k.mat3f:y=b=3;break;case k.mat4f:y=b=4}for(var M=t.getAttribute(u.name),x=0;x<y;++x){var w=M+x,P=(u.index+x*b)*E.BytesPerPixel;n.enableVertexAttribArray(w),n.vertexAttribPointer(w,b,n.FLOAT,!1,m,P),!0===d.instanced&&(c.vertexAttribDivisorANGLE(w,1),this._isInstanced=!0)}}}s.bindVertexArrayOES(null)}E.Geometry=t}(r=r||{}),n.default=r},{"./WebGLContext":31}],29:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t("./WebGLContext"),t=(r.prototype.bind=function(){i.default.getContext().useProgram(this._program)},r.unbind=function(){i.default.getContext().useProgram(null)},r.prototype.hasAttribute=function(t){return this._attributes.has(t)},r.prototype.getAttribute=function(t){var e=this._attributes.get(t);if(void 0===e)throw new Error("attribute not found: "+t);return e},r.prototype.getUniform=function(t){var e=this._uniforms.get(t);if(void 0===e)throw new Error("uniform not found: "+t);return e},r.prototype._getAttribAndLocation=function(t,e){var n=i.default.getContext();if(!this._program)throw new Error("shader program not initialised");n.useProgram(this._program);for(var r=0;r<t.length;++r){if((o=n.getAttribLocation(this._program,t[r]))<0)throw new Error("attribute not found => "+t[r]);this._attributes.set(t[r],o)}for(var o,r=0;r<e.length;++r){if(null===(o=n.getUniformLocation(this._program,e[r])))throw new Error("uniform not found => "+e[r]);this._uniforms.set(e[r],o)}n.useProgram(null)},r.prototype._getShader=function(t,e){var n=i.default.getContext(),e=n.createShader(e);if(!e)throw new Error("could not create a shader");if(n.shaderSource(e,t),n.compileShader(e),n.getShaderParameter(e,n.COMPILE_STATUS))return e;e=(e=n.getShaderInfoLog(e))||"failed to compile a shader";throw new Error(e)},r);function r(t){this._attributes=new Map,this._uniforms=new Map;var e=i.default.getContext(),n=this._getShader(t.vertexSrc,e.VERTEX_SHADER),r=this._getShader(t.fragmentSrc,e.FRAGMENT_SHADER);if(this._program=e.createProgram(),!this._program)throw new Error("could not create a shader program");if(e.attachShader(this._program,n),e.attachShader(this._program,r),e.linkProgram(this._program),e.deleteShader(n),e.deleteShader(r),!e.getProgramParameter(this._program,e.LINK_STATUS)){e=e.getProgramInfoLog(this._program);throw new Error("Failed to initialised shaders, Error linking:"+e)}this._getAttribAndLocation(t.attributes,t.uniforms)}n.default=t},{"./WebGLContext":31}],30:[function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},l=this&&this.__generator||function(n,r){var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(n,"__esModule",{value:!0});var h=t("./WebGLContext"),t=(o.prototype.load=function(c,f){return void 0===f&&(f=!1),r(this,void 0,void 0,function(){var o,i,a,u,e,s=this;return l(this,function(t){return o=h.default.getContext(),this._texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this._texture),i=o.RGBA,0,a=o.RGBA,u=o.UNSIGNED_BYTE,e=new Uint8Array([0,0,255,255]),o.texImage2D(o.TEXTURE_2D,0,i,1,1,0,a,u,e),[2,new Promise(function(e,n){var r=new Image;r.onerror=function(t){n(t)},r.onload=function(){s._width=r.width,s._height=r.height,o.bindTexture(o.TEXTURE_2D,s._texture),o.texImage2D(o.TEXTURE_2D,0,i,a,u,r),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE);var t=f?o.NEAREST:o.LINEAR;o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t),o.bindTexture(o.TEXTURE_2D,null),e()},r.src=c})]})})},o.prototype.getWidth=function(){if(!this._texture)throw new Error("texture not initialised");return this._width},o.prototype.getHeight=function(){if(!this._texture)throw new Error("texture not initialised");return this._height},o.prototype.bind=function(){if(!this._texture)throw new Error("texture not initialised");var t=h.default.getContext();t.bindTexture(t.TEXTURE_2D,this._texture)},o.unbind=function(){var t=h.default.getContext();t.bindTexture(t.TEXTURE_2D,null)},o);function o(){this._width=0,this._height=0,this._texture=null}n.default=t},{"./WebGLContext":31}],31:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=(o.initialise=function(t){if(!(o._gl=t.getContext("webgl",{alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!0,stencil:!1})))throw new Error("could not create webgl context");o._extensionVAO=o._gl.getExtension("OES_vertex_array_object")||o._gl.getExtension("MOZ_OES_vertex_array_object")||o._gl.getExtension("WEBKIT_OES_vertex_array_object"),o._extensionLoseContext=o._gl.getExtension("WEBGL_lose_context"),o._extensionInstancing=o._gl.getExtension("ANGLE_instanced_arrays"),o._viewportSize[0]=t.clientWidth,o._viewportSize[1]=t.clientHeight},o.getContext=function(){if(!o._gl)throw new Error("webgl context not initialised");return o._gl},o.getExtensionVao=function(){return o._extensionVAO},o.getExtensionLoseContext=function(){return o._extensionLoseContext},o.getExtensionInstancing=function(){return o._extensionInstancing},o.getExtensionVaoStrict=function(){if(!o._extensionVAO)throw new Error("vao extension not available");return o._extensionVAO},o.getExtensionLoseContextStrict=function(){if(!o._extensionLoseContext)throw new Error("lose context extension not available");return o._extensionLoseContext},o.getExtensionInstancingStrict=function(){if(!o._extensionInstancing)throw new Error("instancing extension not available");return o._extensionInstancing},o.getViewportSize=function(){return o._viewportSize},o._gl=null,o._extensionVAO=null,o._extensionLoseContext=null,o._extensionInstancing=null,o._viewportSize=[0,0],o);function o(){}n.default=r},{}],32:[function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,a,u,s){return new(u=u||Promise)(function(n,e){function r(t){try{i(s.next(t))}catch(t){e(t)}}function o(t){try{i(s.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,o)}i((s=s.apply(t,a||[])).next())})},o=this&&this.__generator||function(n,r){var o,i,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=2&e[0]?i.return:e[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,e[1])).done)return a;switch(i=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,i=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],i=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(n,"__esModule",{value:!0}),window.onerror=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];alert(JSON.stringify(t))};var i=t("./experiment/WebGLExperiment");r(void 0,void 0,void 0,function(){var e,n;return o(this,function(t){switch(t.label){case 0:return[4,(e=new i.default).init()];case 1:if(t.sent(),e.start(),(n=document.getElementById("touch_id"))&&("ontouchstart"in window?n.innerHTML+="Supported":n.innerHTML+="Not Supported"),!(n=document.getElementById("gui_toggle_start")))throw new Error("gui_toggle_start not found");return n.addEventListener("click",function(){console.log("toggle_start"),e.isRunning()?e.stop():e.start()}),[2]}})})},{"./experiment/WebGLExperiment":14}]},{},[32]);