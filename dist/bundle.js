!function n(i,o,a){function s(e,t){if(!o[e]){if(!i[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(u)return u(e,!0);throw(r=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",r}r=o[e]={exports:{}},i[e][0].call(r.exports,function(t){return s(i[e][1][t]||t)},r,r.exports,n,i,o,a)}return o[e].exports}for(var u="function"==typeof require&&require,t=0;t<a.length;t++)s(a[t]);return s}({1:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setMatrixArrayType=function(t){r.ARRAY_TYPE=i=t},r.toRadian=function(t){return t*a},r.equals=function(t,e){return Math.abs(t-e)<=n*Math.max(1,Math.abs(t),Math.abs(e))},r.RANDOM=r.ARRAY_TYPE=r.EPSILON=void 0;var n=1e-6;r.EPSILON=n;var i="undefined"!=typeof Float32Array?Float32Array:Array;r.ARRAY_TYPE=i;var o=Math.random;r.RANDOM=o;var a=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},{}],2:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.vec4=r.vec3=r.vec2=r.quat2=r.quat=r.mat4=r.mat3=r.mat2d=r.mat2=r.glMatrix=void 0;var n=i(t("./common.js"));r.glMatrix=n;n=i(t("./mat2.js"));r.mat2=n;n=i(t("./mat2d.js"));r.mat2d=n;n=i(t("./mat3.js"));r.mat3=n;n=i(t("./mat4.js"));r.mat4=n;n=i(t("./quat.js"));r.quat=n;n=i(t("./quat2.js"));r.quat2=n;n=i(t("./vec2.js"));r.vec2=n;n=i(t("./vec3.js"));r.vec3=n;t=i(t("./vec4.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function i(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&((n=o?Object.getOwnPropertyDescriptor(t,r):null)&&(n.get||n.set)?Object.defineProperty(i,r,n):i[r]=t[r]);return i.default=t,e&&e.set(t,i),i}r.vec4=t},{"./common.js":1,"./mat2.js":3,"./mat2d.js":4,"./mat3.js":5,"./mat4.js":6,"./quat.js":7,"./quat2.js":8,"./vec2.js":9,"./vec3.js":10,"./vec4.js":11}],3:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new u.ARRAY_TYPE(4);u.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0);return t[0]=1,t[3]=1,t},r.clone=function(t){var e=new u.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.fromValues=function(t,e,r,n){var i=new u.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i},r.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},r.transpose=function(t,e){{var r;t===e?(r=e[1],t[1]=e[2],t[2]=r):(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3])}return t},r.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],e=r*o-i*n;return e?(e=1/e,t[0]=o*e,t[1]=-n*e,t[2]=-i*e,t[3]=r*e,t):null},r.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=n,r.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r+o*e,t[1]=i*r+a*e,t[2]=n*-e+o*r,t[3]=i*-e+a*r,t},r.scale=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],e=r[0],r=r[1];return t[0]=n*e,t[1]=i*e,t[2]=o*r,t[3]=a*r,t},r.fromRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},r.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},r.subtract=i,r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],s=e[1],t=e[2],e=e[3];return Math.abs(r-a)<=u.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=u.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-t)<=u.EPSILON*Math.max(1,Math.abs(i),Math.abs(t))&&Math.abs(o-e)<=u.EPSILON*Math.max(1,Math.abs(o),Math.abs(e))},r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},r.sub=r.mul=void 0;var u=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=i?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=r[0],u=r[1],e=r[2],r=r[3];return t[0]=n*s+o*u,t[1]=i*s+a*u,t[2]=n*e+o*r,t[3]=i*e+a*r,t}function i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}r.mul=n,r.sub=i},{"./common.js":1}],4:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new l.ARRAY_TYPE(6);l.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0);return t[0]=1,t[3]=1,t},r.clone=function(t){var e=new l.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.fromValues=function(t,e,r,n,i,o){var a=new l.ARRAY_TYPE(6);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a[4]=i,a[5]=o,a},r.set=function(t,e,r,n,i,o,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=a,t},r.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],e=r*o-n*i;return e?(e=1/e,t[0]=o*e,t[1]=-n*e,t[2]=-i*e,t[3]=r*e,t[4]=(i*s-o*a)*e,t[5]=(n*a-r*s)*e,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=n,r.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r+o*e,t[1]=i*r+a*e,t[2]=n*-e+o*r,t[3]=i*-e+a*r,t[4]=s,t[5]=u,t},r.scale=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],e=r[0],r=r[1];return t[0]=n*e,t[1]=i*e,t[2]=o*r,t[3]=a*r,t[4]=s,t[5]=u,t},r.translate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],e=r[0],r=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=n*e+o*r+s,t[5]=i*e+a*r+u,t},r.fromRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},r.subtract=i,r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},r.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=e[0],c=e[1],h=e[2],f=e[3],t=e[4],e=e[5];return Math.abs(r-u)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-h)<=l.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-f)<=l.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-t)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(t))&&Math.abs(s-e)<=l.EPSILON*Math.max(1,Math.abs(s),Math.abs(e))},r.sub=r.mul=void 0;var l=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=i?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=r[0],h=r[1],f=r[2],l=r[3],e=r[4],r=r[5];return t[0]=n*c+o*h,t[1]=i*c+a*h,t[2]=n*f+o*l,t[3]=i*f+a*l,t[4]=n*e+o*r+s,t[5]=i*e+a*r+u,t}function i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}r.mul=n,r.sub=i},{"./common.js":1}],5:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new g.ARRAY_TYPE(9);g.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0);return t[0]=1,t[4]=1,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new g.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromValues=function(t,e,r,n,i,o,a,s,u){var c=new g.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c[8]=u,c},r.set=function(t,e,r,n,i,o,a,s,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){{var r,n,i;t===e?(r=e[1],n=e[2],i=e[5],t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i):(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8])}return t},r.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=h*a-s*c,l=-h*o+s*u,d=c*o-a*u,e=r*f+n*l+i*d;return e?(e=1/e,t[0]=f*e,t[1]=(-h*n+i*c)*e,t[2]=(s*n-i*a)*e,t[3]=l*e,t[4]=(h*r-i*u)*e,t[5]=(-s*r+i*o)*e,t[6]=d*e,t[7]=(-c*r+n*u)*e,t[8]=(a*r-n*o)*e,t):null},r.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],e=e[8];return t[0]=a*e-s*c,t[1]=i*c-n*e,t[2]=n*s-i*a,t[3]=s*u-o*e,t[4]=r*e-i*u,t[5]=i*o-r*s,t[6]=o*c-a*u,t[7]=n*u-r*c,t[8]=r*a-n*o,t},r.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],t=t[8];return e*(t*o-a*u)+r*(-t*i+a*s)+n*(u*i-o*s)},r.multiply=n,r.translate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],e=r[0],r=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=e*n+r*a+c,t[7]=e*i+r*s+h,t[8]=e*o+r*u+f,t},r.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],e=Math.sin(r),r=Math.cos(r);return t[0]=r*n+e*a,t[1]=r*i+e*s,t[2]=r*o+e*u,t[3]=r*a-e*n,t[4]=r*s-e*i,t[5]=r*u-e*o,t[6]=c,t[7]=h,t[8]=f,t},r.scale=function(t,e,r){var n=r[0],r=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,s=n+n,u=i+i,c=r*a,h=n*a,e=n*s,r=i*a,n=i*s,i=i*u,a=o*a,s=o*s,u=o*u;return t[0]=1-e-i,t[3]=h-u,t[6]=r+s,t[1]=h+u,t[4]=1-c-i,t[7]=n-a,t[2]=r-s,t[5]=n+a,t[8]=1-c-e,t},r.normalFromMat4=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],m=e[12],_=e[13],v=e[14],p=e[15],g=r*s-n*a,M=r*u-i*a,b=r*c-o*a,y=n*u-i*s,x=n*c-o*s,P=i*c-o*u,w=h*_-f*m,E=h*v-l*m,e=h*p-d*m,h=f*v-l*_,f=f*p-d*_,l=l*p-d*v,d=g*l-M*f+b*h+y*e-x*E+P*w;return d?(d=1/d,t[0]=(s*l-u*f+c*h)*d,t[1]=(u*e-a*l-c*E)*d,t[2]=(a*f-s*e+c*w)*d,t[3]=(i*f-n*l-o*h)*d,t[4]=(r*l-i*e+o*E)*d,t[5]=(n*e-r*f-o*w)*d,t[6]=(_*P-v*x+p*y)*d,t[7]=(v*b-m*P-p*M)*d,t[8]=(m*x-_*b+p*g)*d,t):null},r.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},r.subtract=i,r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},r.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=t[8],f=e[0],l=e[1],d=e[2],m=e[3],_=e[4],v=e[5],p=e[6],t=e[7],e=e[8];return Math.abs(r-f)<=g.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-l)<=g.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-d)<=g.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-m)<=g.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-_)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(s-v)<=g.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-p)<=g.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(c-t)<=g.EPSILON*Math.max(1,Math.abs(c),Math.abs(t))&&Math.abs(h-e)<=g.EPSILON*Math.max(1,Math.abs(h),Math.abs(e))},r.sub=r.mul=void 0;var g=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=i?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=r[0],d=r[1],m=r[2],_=r[3],v=r[4],p=r[5],g=r[6],e=r[7],r=r[8];return t[0]=l*n+d*a+m*c,t[1]=l*i+d*s+m*h,t[2]=l*o+d*u+m*f,t[3]=_*n+v*a+p*c,t[4]=_*i+v*s+p*h,t[5]=_*o+v*u+p*f,t[6]=g*n+e*a+r*c,t[7]=g*i+e*s+r*h,t[8]=g*o+e*u+r*f,t}function i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}r.mul=n,r.sub=i},{"./common.js":1}],6:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new T.ARRAY_TYPE(16);T.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},r.clone=function(t){var e=new T.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.fromValues=function(t,e,r,n,i,o,a,s,u,c,h,f,l,d,m,_){var v=new T.ARRAY_TYPE(16);return v[0]=t,v[1]=e,v[2]=r,v[3]=n,v[4]=i,v[5]=o,v[6]=a,v[7]=s,v[8]=u,v[9]=c,v[10]=h,v[11]=f,v[12]=l,v[13]=d,v[14]=m,v[15]=_,v},r.set=function(t,e,r,n,i,o,a,s,u,c,h,f,l,d,m,_,v){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=h,t[10]=f,t[11]=l,t[12]=d,t[13]=m,t[14]=_,t[15]=v,t},r.identity=m,r.transpose=function(t,e){{var r,n,i,o,a,s;t===e?(r=e[1],n=e[2],i=e[3],o=e[6],a=e[7],s=e[11],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s):(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15])}return t},r.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],m=e[12],_=e[13],v=e[14],p=e[15],g=r*s-n*a,M=r*u-i*a,b=r*c-o*a,y=n*u-i*s,x=n*c-o*s,P=i*c-o*u,w=h*_-f*m,E=h*v-l*m,S=h*p-d*m,k=f*v-l*_,R=f*p-d*_,A=l*p-d*v,e=g*A-M*R+b*k+y*S-x*E+P*w;return e?(e=1/e,t[0]=(s*A-u*R+c*k)*e,t[1]=(i*R-n*A-o*k)*e,t[2]=(_*P-v*x+p*y)*e,t[3]=(l*x-f*P-d*y)*e,t[4]=(u*S-a*A-c*E)*e,t[5]=(r*A-i*S+o*E)*e,t[6]=(v*b-m*P-p*M)*e,t[7]=(h*P-l*b+d*M)*e,t[8]=(a*R-s*S+c*w)*e,t[9]=(n*S-r*R-o*w)*e,t[10]=(m*x-_*b+p*g)*e,t[11]=(f*b-h*x-d*g)*e,t[12]=(s*E-a*k-u*w)*e,t[13]=(r*k-n*E+i*w)*e,t[14]=(_*M-m*y-v*g)*e,t[15]=(h*y-f*M+l*g)*e,t):null},r.adjoint=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],m=e[12],_=e[13],v=e[14],e=e[15];return t[0]=s*(l*e-d*v)-f*(u*e-c*v)+_*(u*d-c*l),t[1]=-(n*(l*e-d*v)-f*(i*e-o*v)+_*(i*d-o*l)),t[2]=n*(u*e-c*v)-s*(i*e-o*v)+_*(i*c-o*u),t[3]=-(n*(u*d-c*l)-s*(i*d-o*l)+f*(i*c-o*u)),t[4]=-(a*(l*e-d*v)-h*(u*e-c*v)+m*(u*d-c*l)),t[5]=r*(l*e-d*v)-h*(i*e-o*v)+m*(i*d-o*l),t[6]=-(r*(u*e-c*v)-a*(i*e-o*v)+m*(i*c-o*u)),t[7]=r*(u*d-c*l)-a*(i*d-o*l)+h*(i*c-o*u),t[8]=a*(f*e-d*_)-h*(s*e-c*_)+m*(s*d-c*f),t[9]=-(r*(f*e-d*_)-h*(n*e-o*_)+m*(n*d-o*f)),t[10]=r*(s*e-c*_)-a*(n*e-o*_)+m*(n*c-o*s),t[11]=-(r*(s*d-c*f)-a*(n*d-o*f)+h*(n*c-o*s)),t[12]=-(a*(f*v-l*_)-h*(s*v-u*_)+m*(s*l-u*f)),t[13]=r*(f*v-l*_)-h*(n*v-i*_)+m*(n*l-i*f),t[14]=-(r*(s*v-u*_)-a*(n*v-i*_)+m*(n*u-i*s)),t[15]=r*(s*l-u*f)-a*(n*l-i*f)+h*(n*u-i*s),t},r.determinant=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],h=t[9],f=t[10],l=t[11],d=t[12],m=t[13],_=t[14],t=t[15];return(e*a-r*o)*(f*t-l*_)-(e*s-n*o)*(h*t-l*m)+(e*u-i*o)*(h*_-f*m)+(r*s-n*a)*(c*t-l*d)-(r*u-i*a)*(c*_-f*d)+(n*u-i*s)*(c*m-h*d)},r.multiply=n,r.translate=function(t,e,r){var n,i,o,a,s,u,c,h,f,l,d,m=r[0],_=r[1],v=r[2];e===t?(t[12]=e[0]*m+e[4]*_+e[8]*v+e[12],t[13]=e[1]*m+e[5]*_+e[9]*v+e[13],t[14]=e[2]*m+e[6]*_+e[10]*v+e[14],t[15]=e[3]*m+e[7]*_+e[11]*v+e[15]):(n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],d=e[10],r=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=f,t[9]=l,t[10]=d,t[11]=r,t[12]=n*m+s*_+f*v+e[12],t[13]=i*m+u*_+l*v+e[13],t[14]=o*m+c*_+d*v+e[14],t[15]=a*m+h*_+r*v+e[15]);return t},r.scale=function(t,e,r){var n=r[0],i=r[1],r=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.rotate=function(t,e,r,n){var i,o,a,s,u,c,h,f,l,d,m,_,v,p,g,M,b,y,x,P=n[0],w=n[1],E=n[2],S=Math.hypot(P,w,E);if(S<T.EPSILON)return null;P*=S=1/S,w*=S,E*=S,y=Math.sin(r),x=Math.cos(r),i=1-x,o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],h=e[5],f=e[6],l=e[7],d=e[8],m=e[9],_=e[10],v=e[11],p=P*P*i+x,g=w*P*i+E*y,M=E*P*i-w*y,b=P*w*i-E*y,n=w*w*i+x,S=E*w*i+P*y,r=P*E*i+w*y,y=w*E*i-P*y,x=E*E*i+x,t[0]=o*p+c*g+d*M,t[1]=a*p+h*g+m*M,t[2]=s*p+f*g+_*M,t[3]=u*p+l*g+v*M,t[4]=o*b+c*n+d*S,t[5]=a*b+h*n+m*S,t[6]=s*b+f*n+_*S,t[7]=u*b+l*n+v*S,t[8]=o*r+c*y+d*x,t[9]=a*r+h*y+m*x,t[10]=s*r+f*y+_*x,t[11]=u*r+l*y+v*x,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},r.rotateX=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],h=e[9],f=e[10],r=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=o*i+c*n,t[5]=a*i+h*n,t[6]=s*i+f*n,t[7]=u*i+r*n,t[8]=c*i-o*n,t[9]=h*i-a*n,t[10]=f*i-s*n,t[11]=r*i-u*n,t},r.rotateY=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],h=e[9],f=e[10],r=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i-c*n,t[1]=a*i-h*n,t[2]=s*i-f*n,t[3]=u*i-r*n,t[8]=o*n+c*i,t[9]=a*n+h*i,t[10]=s*n+f*i,t[11]=u*n+r*i,t},r.rotateZ=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],h=e[5],f=e[6],r=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i+c*n,t[1]=a*i+h*n,t[2]=s*i+f*n,t[3]=u*i+r*n,t[4]=c*i-o*n,t[5]=h*i-a*n,t[6]=f*i-s*n,t[7]=r*i-u*n,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,r){var n=r[0],i=r[1],o=r[2],a=Math.hypot(n,i,o);if(a<T.EPSILON)return null;return n*=a=1/a,i*=a,o*=a,r=Math.sin(e),a=Math.cos(e),e=1-a,t[0]=n*n*e+a,t[1]=i*n*e+o*r,t[2]=o*n*e-i*r,t[3]=0,t[4]=n*i*e-o*r,t[5]=i*i*e+a,t[6]=o*i*e+n*r,t[7]=0,t[8]=n*o*e+i*r,t[9]=i*o*e-n*r,t[10]=o*o*e+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromXRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var r=Math.sin(e),e=Math.cos(e);return t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=l,r.fromQuat2=function(t,e){var r=new T.ARRAY_TYPE(3),n=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=n*n+i*i+o*o+a*a;0<f?(r[0]=2*(s*a+h*n+u*o-c*i)/f,r[1]=2*(u*a+h*i+c*n-s*o)/f,r[2]=2*(c*a+h*o+s*i-u*n)/f):(r[0]=2*(s*a+h*n+u*o-c*i),r[1]=2*(u*a+h*i+c*n-s*o),r[2]=2*(c*a+h*o+s*i-u*n));return l(t,e,r),t},r.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},r.getScaling=d,r.getRotation=function(t,e){var r=new T.ARRAY_TYPE(3);d(r,e);var n=1/r[0],i=1/r[1],o=1/r[2],a=e[0]*n,s=e[1]*i,u=e[2]*o,c=e[4]*n,h=e[5]*i,f=e[6]*o,r=e[8]*n,n=e[9]*i,i=e[10]*o,e=a+h+i,o=0;0<e?(o=2*Math.sqrt(1+e),t[3]=.25*o,t[0]=(f-n)/o,t[1]=(r-u)/o,t[2]=(s-c)/o):h<a&&i<a?(o=2*Math.sqrt(1+a-h-i),t[3]=(f-n)/o,t[0]=.25*o,t[1]=(s+c)/o,t[2]=(r+u)/o):i<h?(o=2*Math.sqrt(1+h-a-i),t[3]=(r-u)/o,t[0]=(s+c)/o,t[1]=.25*o,t[2]=(f+n)/o):(o=2*Math.sqrt(1+i-a-h),t[3]=(s-c)/o,t[0]=(r+u)/o,t[1]=(f+n)/o,t[2]=.25*o);return t},r.fromRotationTranslationScale=function(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,h=a+a,f=i*u,l=i*c,d=i*h,e=o*c,i=o*h,o=a*h,a=s*u,u=s*c,c=s*h,s=n[0],h=n[1],n=n[2];return t[0]=(1-(e+o))*s,t[1]=(l+c)*s,t[2]=(d-u)*s,t[3]=0,t[4]=(l-c)*h,t[5]=(1-(f+o))*h,t[6]=(i+a)*h,t[7]=0,t[8]=(d+u)*n,t[9]=(i-a)*n,t[10]=(1-(f+e))*n,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,r,n,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,h=a+a,f=s+s,l=o*c,d=o*h,m=o*f,_=a*h,v=a*f,p=s*f,g=u*c,e=u*h,o=u*f,a=n[0],s=n[1],c=n[2],h=i[0],u=i[1],f=i[2],n=(1-(_+p))*a,i=(d+o)*a,a=(m-e)*a,o=(d-o)*s,p=(1-(l+p))*s,s=(v+g)*s,e=(m+e)*c,g=(v-g)*c,c=(1-(l+_))*c;return t[0]=n,t[1]=i,t[2]=a,t[3]=0,t[4]=o,t[5]=p,t[6]=s,t[7]=0,t[8]=e,t[9]=g,t[10]=c,t[11]=0,t[12]=r[0]+h-(n*h+o*u+e*f),t[13]=r[1]+u-(i*h+p*u+g*f),t[14]=r[2]+f-(a*h+s*u+c*f),t[15]=1,t},r.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r+r,s=n+n,u=i+i,c=r*a,h=n*a,e=n*s,r=i*a,n=i*s,i=i*u,a=o*a,s=o*s,u=o*u;return t[0]=1-e-i,t[1]=h+u,t[2]=r-s,t[3]=0,t[4]=h-u,t[5]=1-c-i,t[6]=n+a,t[7]=0,t[8]=r+s,t[9]=n-a,t[10]=1-c-e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,r,n,i,o,a){var s=1/(r-e),u=1/(i-n),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t},r.perspective=function(t,e,r,n,i){e=1/Math.tan(e/2);t[0]=e/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(e=1/(n-i),t[10]=(i+n)*e,t[14]=2*i*n*e):(t[10]=-1,t[14]=-2*n);return t},r.perspectiveFromFieldOfView=function(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),e=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*e*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},r.ortho=function(t,e,r,n,i,o,a){var s=1/(e-r),u=1/(n-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*u,t[14]=(a+o)*c,t[15]=1,t},r.lookAt=function(t,e,r,n){var i,o=e[0],a=e[1],s=e[2],u=n[0],c=n[1],h=n[2],f=r[0],l=r[1],d=r[2];if(Math.abs(o-f)<T.EPSILON&&Math.abs(a-l)<T.EPSILON&&Math.abs(s-d)<T.EPSILON)return m(t);i=o-f,e=a-l,n=s-d,r=1/Math.hypot(i,e,n),f=c*(n*=r)-h*(e*=r),l=h*(i*=r)-u*n,d=u*e-c*i,(r=Math.hypot(f,l,d))?(f*=r=1/r,l*=r,d*=r):d=l=f=0;h=e*d-n*l,u=n*f-i*d,c=i*l-e*f,(r=Math.hypot(h,u,c))?(h*=r=1/r,u*=r,c*=r):c=u=h=0;return t[0]=f,t[1]=h,t[2]=i,t[3]=0,t[4]=l,t[5]=u,t[6]=e,t[7]=0,t[8]=d,t[9]=c,t[10]=n,t[11]=0,t[12]=-(f*o+l*a+d*s),t[13]=-(h*o+u*a+c*s),t[14]=-(i*o+e*a+n*s),t[15]=1,t},r.targetTo=function(t,e,r,n){var i=e[0],o=e[1],a=e[2],s=n[0],u=n[1],c=n[2],h=i-r[0],f=o-r[1],e=a-r[2],n=h*h+f*f+e*e;0<n&&(n=1/Math.sqrt(n),h*=n,f*=n,e*=n);r=u*e-c*f,c=c*h-s*e,u=s*f-u*h;0<(n=r*r+c*c+u*u)&&(n=1/Math.sqrt(n),r*=n,c*=n,u*=n);return t[0]=r,t[1]=c,t[2]=u,t[3]=0,t[4]=f*u-e*c,t[5]=e*r-h*u,t[6]=h*c-f*r,t[7]=0,t[8]=h,t[9]=f,t[10]=e,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},r.subtract=i,r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},r.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=t[8],f=t[9],l=t[10],d=t[11],m=t[12],_=t[13],v=t[14],p=t[15],g=e[0],M=e[1],b=e[2],y=e[3],x=e[4],P=e[5],w=e[6],E=e[7],S=e[8],k=e[9],R=e[10],A=e[11],C=e[12],O=e[13],t=e[14],e=e[15];return Math.abs(r-g)<=T.EPSILON*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-M)<=T.EPSILON*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(i-b)<=T.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(o-y)<=T.EPSILON*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-x)<=T.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(s-P)<=T.EPSILON*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(u-w)<=T.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(c-E)<=T.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(h-S)<=T.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(f-k)<=T.EPSILON*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(l-R)<=T.EPSILON*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(d-A)<=T.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(m-C)<=T.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(_-O)<=T.EPSILON*Math.max(1,Math.abs(_),Math.abs(O))&&Math.abs(v-t)<=T.EPSILON*Math.max(1,Math.abs(v),Math.abs(t))&&Math.abs(p-e)<=T.EPSILON*Math.max(1,Math.abs(p),Math.abs(e))},r.sub=r.mul=void 0;var T=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=i?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function m(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function n(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],d=e[10],m=e[11],_=e[12],v=e[13],p=e[14],g=e[15],M=r[0],b=r[1],y=r[2],e=r[3];return t[0]=M*n+b*s+y*f+e*_,t[1]=M*i+b*u+y*l+e*v,t[2]=M*o+b*c+y*d+e*p,t[3]=M*a+b*h+y*m+e*g,M=r[4],b=r[5],y=r[6],e=r[7],t[4]=M*n+b*s+y*f+e*_,t[5]=M*i+b*u+y*l+e*v,t[6]=M*o+b*c+y*d+e*p,t[7]=M*a+b*h+y*m+e*g,M=r[8],b=r[9],y=r[10],e=r[11],t[8]=M*n+b*s+y*f+e*_,t[9]=M*i+b*u+y*l+e*v,t[10]=M*o+b*c+y*d+e*p,t[11]=M*a+b*h+y*m+e*g,M=r[12],b=r[13],y=r[14],e=r[15],t[12]=M*n+b*s+y*f+e*_,t[13]=M*i+b*u+y*l+e*v,t[14]=M*o+b*c+y*d+e*p,t[15]=M*a+b*h+y*m+e*g,t}function l(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=n+n,u=i+i,c=o+o,h=n*s,f=n*u,e=n*c,n=i*u,i=i*c,o=o*c,s=a*s,u=a*u,c=a*c;return t[0]=1-(n+o),t[1]=f+c,t[2]=e-u,t[3]=0,t[4]=f-c,t[5]=1-(h+o),t[6]=i+s,t[7]=0,t[8]=e+u,t[9]=i-s,t[10]=1-(h+n),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function d(t,e){var r=e[0],n=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],e=e[10];return t[0]=Math.hypot(r,n,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,c,e),t}function i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}r.mul=n,r.sub=i},{"./common.js":1}],7:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=c,r.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},r.setAxisAngle=h,r.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);n>d.EPSILON?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0);return r},r.getAngle=function(t,e){e=g(t,e);return Math.acos(2*e*e-1)},r.multiply=f,r.rotateX=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r+a*e,t[1]=i*r+o*e,t[2]=o*r-i*e,t[3]=a*r-n*e,t},r.rotateY=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r-o*e,t[1]=i*r+a*e,t[2]=o*r+n*e,t[3]=a*r-i*e,t},r.rotateZ=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],a=e[3],e=Math.sin(r),r=Math.cos(r);return t[0]=n*r+i*e,t[1]=i*r-n*e,t[2]=o*r+a*e,t[3]=a*r-o*e,t},r.calculateW=function(t,e){var r=e[0],n=e[1],e=e[2];return t[0]=r,t[1]=n,t[2]=e,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-e*e)),t},r.exp=l,r.ln=m,r.pow=function(t,e,r){return m(t,e),p(t,t,r),l(t,t),t},r.slerp=_,r.random=function(t){var e=d.RANDOM(),r=d.RANDOM(),n=d.RANDOM(),i=Math.sqrt(1-e),e=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=e*Math.sin(2*Math.PI*n),t[3]=e*Math.cos(2*Math.PI*n),t},r.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],e=r*r+n*n+i*i+o*o,e=e?1/e:0;return t[0]=-r*e,t[1]=-n*e,t[2]=-i*e,t[3]=o*e,t},r.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},r.fromMat3=v,r.fromEuler=function(t,e,r,n){var i=.5*Math.PI/180;e*=i,r*=i,n*=i;var o=Math.sin(e),a=Math.cos(e),i=Math.sin(r),e=Math.cos(r),r=Math.sin(n),n=Math.cos(n);return t[0]=o*e*n-a*i*r,t[1]=a*i*n+o*e*r,t[2]=a*e*r-o*i*n,t[3]=a*e*n+o*i*r,t},r.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.setAxes=r.sqlerp=r.rotationTo=r.equals=r.exactEquals=r.normalize=r.sqrLen=r.squaredLength=r.len=r.length=r.lerp=r.dot=r.scale=r.mul=r.add=r.set=r.copy=r.fromValues=r.clone=void 0;var d=u(t("./common.js")),n=u(t("./mat3.js")),i=u(t("./vec3.js")),o=u(t("./vec4.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function u(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&((n=o?Object.getOwnPropertyDescriptor(t,r):null)&&(n.get||n.set)?Object.defineProperty(i,r,n):i[r]=t[r]);return i.default=t,e&&e.set(t,i),i}function c(){var t=new d.ARRAY_TYPE(4);return d.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function h(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function f(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=r[0],u=r[1],e=r[2],r=r[3];return t[0]=n*r+a*s+i*e-o*u,t[1]=i*r+a*u+o*s-n*e,t[2]=o*r+a*e+n*u-i*s,t[3]=a*r-n*s-i*u-o*e,t}function l(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=Math.sqrt(r*r+n*n+i*i),e=Math.exp(o),o=0<a?e*Math.sin(a)/a:0;return t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=e*Math.cos(a),t}function m(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],e=Math.sqrt(r*r+n*n+i*i),e=0<e?Math.atan2(e,o)/e:0;return t[0]=r*e,t[1]=n*e,t[2]=i*e,t[3]=.5*Math.log(r*r+n*n+i*i+o*o),t}function _(t,e,r,n){var i,o=e[0],a=e[1],s=e[2],u=e[3],c=r[0],h=r[1],f=r[2],l=r[3],e=o*c+a*h+s*f+u*l;return e<0&&(e=-e,c=-c,h=-h,f=-f,l=-l),n=1-e>d.EPSILON?(r=Math.acos(e),e=Math.sin(r),i=Math.sin((1-n)*r)/e,Math.sin(n*r)/e):(i=1-n,n),t[0]=i*o+n*c,t[1]=i*a+n*h,t[2]=i*s+n*f,t[3]=i*u+n*l,t}function v(t,e){var r,n,i,o=e[0]+e[4]+e[8];return 0<o?(i=Math.sqrt(o+1),t[3]=.5*i,t[0]=(e[5]-e[7])*(i=.5/i),t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i):(e[4]>e[r=0]&&(r=1),n=((r=e[8]>e[3*r+r]?2:r)+1)%3,o=(r+2)%3,i=Math.sqrt(e[3*r+r]-e[3*n+n]-e[3*o+o]+1),t[r]=.5*i,t[3]=(e[3*n+o]-e[3*o+n])*(i=.5/i),t[n]=(e[3*n+r]+e[3*r+n])*i,t[o]=(e[3*o+r]+e[3*r+o])*i),t}t=o.clone;r.clone=t;t=o.fromValues;r.fromValues=t;t=o.copy;r.copy=t;t=o.set;r.set=t;t=o.add;r.add=t,r.mul=f;var p=o.scale;r.scale=p;var g=o.dot;r.dot=g;t=o.lerp;r.lerp=t;t=o.length;r.length=t,r.len=t;t=o.squaredLength;r.squaredLength=t,r.sqrLen=t;var M=o.normalize;r.normalize=M;t=o.exactEquals;r.exactEquals=t;o=o.equals;r.equals=o;var b,y,x,o=(b=i.create(),y=i.fromValues(1,0,0),x=i.fromValues(0,1,0),function(t,e,r){var n=i.dot(e,r);return n<-.999999?(i.cross(b,y,e),i.len(b)<1e-6&&i.cross(b,x,e),i.normalize(b,b),h(t,b,Math.PI),t):.999999<n?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(i.cross(b,e,r),t[0]=b[0],t[1]=b[1],t[2]=b[2],t[3]=1+n,M(t,t))});r.rotationTo=o;var P,w,o=(P=c(),w=c(),function(t,e,r,n,i,o){return _(P,e,i,o),_(w,r,n,o),_(t,P,w,2*o*(1-o)),t});r.sqlerp=o;var E,n=(E=n.create(),function(t,e,r,n){return E[0]=r[0],E[3]=r[1],E[6]=r[2],E[1]=n[0],E[4]=n[1],E[7]=n[2],E[2]=-e[0],E[5]=-e[1],E[8]=-e[2],M(t,v(t,E))});r.setAxes=n},{"./common.js":1,"./mat3.js":5,"./vec3.js":10,"./vec4.js":11}],8:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new v.ARRAY_TYPE(8);v.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0);return t[3]=1,t},r.clone=function(t){var e=new v.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},r.fromValues=function(t,e,r,n,i,o,a,s){var u=new v.ARRAY_TYPE(8);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=i,u[5]=o,u[6]=a,u[7]=s,u},r.fromRotationTranslationValues=function(t,e,r,n,i,o,a){var s=new v.ARRAY_TYPE(8);s[0]=t,s[1]=e,s[2]=r,s[3]=n;i*=.5,o*=.5,a*=.5;return s[4]=i*n+o*r-a*e,s[5]=o*n+a*t-i*r,s[6]=a*n+i*e-o*t,s[7]=-i*t-o*e-a*r,s},r.fromRotationTranslation=o,r.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},r.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},r.fromMat4=function(t,e){var r=m.create();i.getRotation(r,e);var n=new v.ARRAY_TYPE(3);return i.getTranslation(n,e),o(t,r,n),t},r.copy=h,r.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},r.set=function(t,e,r,n,i,o,a,s,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t},r.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},r.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},r.getTranslation=function(t,e){var r=e[4],n=e[5],i=e[6],o=e[7],a=-e[0],s=-e[1],u=-e[2],e=e[3];return t[0]=2*(r*e+o*a+n*u-i*s),t[1]=2*(n*e+o*s+i*a-r*u),t[2]=2*(i*e+o*u+r*s-n*a),t},r.translate=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=.5*r[0],u=.5*r[1],c=.5*r[2],h=e[4],f=e[5],r=e[6],e=e[7];return t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=a*s+i*c-o*u+h,t[5]=a*u+o*s-n*c+f,t[6]=a*c+n*u-i*s+r,t[7]=-n*s-i*u-o*c+e,t},r.rotateX=function(t,e,r){var n=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=s*a+h*n+u*o-c*i,l=u*a+h*i+c*n-s*o,d=c*a+h*o+s*i-u*n,c=h*a-s*n-u*i-c*o;return m.rotateX(t,e,r),n=t[0],i=t[1],o=t[2],a=t[3],t[4]=f*a+c*n+l*o-d*i,t[5]=l*a+c*i+d*n-f*o,t[6]=d*a+c*o+f*i-l*n,t[7]=c*a-f*n-l*i-d*o,t},r.rotateY=function(t,e,r){var n=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=s*a+h*n+u*o-c*i,l=u*a+h*i+c*n-s*o,d=c*a+h*o+s*i-u*n,c=h*a-s*n-u*i-c*o;return m.rotateY(t,e,r),n=t[0],i=t[1],o=t[2],a=t[3],t[4]=f*a+c*n+l*o-d*i,t[5]=l*a+c*i+d*n-f*o,t[6]=d*a+c*o+f*i-l*n,t[7]=c*a-f*n-l*i-d*o,t},r.rotateZ=function(t,e,r){var n=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=s*a+h*n+u*o-c*i,l=u*a+h*i+c*n-s*o,d=c*a+h*o+s*i-u*n,c=h*a-s*n-u*i-c*o;return m.rotateZ(t,e,r),n=t[0],i=t[1],o=t[2],a=t[3],t[4]=f*a+c*n+l*o-d*i,t[5]=l*a+c*i+d*n-f*o,t[6]=d*a+c*o+f*i-l*n,t[7]=c*a-f*n-l*i-d*o,t},r.rotateByQuatAppend=function(t,e,r){var n=r[0],i=r[1],o=r[2],a=r[3],s=e[0],u=e[1],c=e[2],r=e[3];return t[0]=s*a+r*n+u*o-c*i,t[1]=u*a+r*i+c*n-s*o,t[2]=c*a+r*o+s*i-u*n,t[3]=r*a-s*n-u*i-c*o,s=e[4],u=e[5],c=e[6],r=e[7],t[4]=s*a+r*n+u*o-c*i,t[5]=u*a+r*i+c*n-s*o,t[6]=c*a+r*o+s*i-u*n,t[7]=r*a-s*n-u*i-c*o,t},r.rotateByQuatPrepend=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=r[0],u=r[1],c=r[2],e=r[3];return t[0]=n*e+a*s+i*c-o*u,t[1]=i*e+a*u+o*s-n*c,t[2]=o*e+a*c+n*u-i*s,t[3]=a*e-n*s-i*u-o*c,s=r[4],u=r[5],c=r[6],e=r[7],t[4]=n*e+a*s+i*c-o*u,t[5]=i*e+a*u+o*s-n*c,t[6]=o*e+a*c+n*u-i*s,t[7]=a*e-n*s-i*u-o*c,t},r.rotateAroundAxis=function(t,e,r,n){if(Math.abs(n)<v.EPSILON)return h(t,e);var i=Math.hypot(r[0],r[1],r[2]);n*=.5;var o=Math.sin(n),a=o*r[0]/i,s=o*r[1]/i,u=o*r[2]/i,c=Math.cos(n),o=e[0],r=e[1],i=e[2],n=e[3];t[0]=o*c+n*a+r*u-i*s,t[1]=r*c+n*s+i*a-o*u,t[2]=i*c+n*u+o*s-r*a,t[3]=n*c-o*a-r*s-i*u;o=e[4],r=e[5],i=e[6],e=e[7];return t[4]=o*c+e*a+r*u-i*s,t[5]=r*c+e*s+i*a-o*u,t[6]=i*c+e*u+o*s-r*a,t[7]=e*c-o*a-r*s-i*u,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t},r.multiply=u,r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t},r.lerp=function(t,e,r,n){var i=1-n;c(e,r)<0&&(n=-n);return t[0]=e[0]*i+r[0]*n,t[1]=e[1]*i+r[1]*n,t[2]=e[2]*i+r[2]*n,t[3]=e[3]*i+r[3]*n,t[4]=e[4]*i+r[4]*n,t[5]=e[5]*i+r[5]*n,t[6]=e[6]*i+r[6]*n,t[7]=e[7]*i+r[7]*n,t},r.invert=function(t,e){var r=f(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t},r.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},r.normalize=function(t,e){var r=f(e);{var n,i,o,a,s,u,c,h;0<r&&(r=Math.sqrt(r),n=e[0]/r,i=e[1]/r,o=e[2]/r,a=e[3]/r,s=e[4],u=e[5],c=e[6],h=e[7],e=n*s+i*u+o*c+a*h,t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=(s-n*e)/r,t[5]=(u-i*e)/r,t[6]=(c-o*e)/r,t[7]=(h-a*e)/r)}return t},r.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},r.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=e[0],f=e[1],l=e[2],d=e[3],m=e[4],_=e[5],t=e[6],e=e[7];return Math.abs(r-h)<=v.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-f)<=v.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-l)<=v.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-d)<=v.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-m)<=v.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-_)<=v.EPSILON*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(u-t)<=v.EPSILON*Math.max(1,Math.abs(u),Math.abs(t))&&Math.abs(c-e)<=v.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))},r.sqrLen=r.squaredLength=r.len=r.length=r.dot=r.mul=r.setReal=r.getReal=void 0;var v=n(t("./common.js")),m=n(t("./quat.js")),i=n(t("./mat4.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n,i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&((n=o?Object.getOwnPropertyDescriptor(t,r):null)&&(n.get||n.set)?Object.defineProperty(i,r,n):i[r]=t[r]);return i.default=t,e&&e.set(t,i),i}function o(t,e,r){var n=.5*r[0],i=.5*r[1],o=.5*r[2],a=e[0],s=e[1],r=e[2],e=e[3];return t[0]=a,t[1]=s,t[2]=r,t[3]=e,t[4]=n*e+i*r-o*s,t[5]=i*e+o*a-n*r,t[6]=o*e+n*s-i*a,t[7]=-n*a-i*s-o*r,t}function h(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}t=m.copy;r.getReal=t;t=m.copy;function u(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=r[4],u=r[5],c=r[6],h=r[7],f=e[4],l=e[5],d=e[6],m=e[7],_=r[0],v=r[1],e=r[2],r=r[3];return t[0]=n*r+a*_+i*e-o*v,t[1]=i*r+a*v+o*_-n*e,t[2]=o*r+a*e+n*v-i*_,t[3]=a*r-n*_-i*v-o*e,t[4]=n*h+a*s+i*c-o*u+f*r+m*_+l*e-d*v,t[5]=i*h+a*u+o*s-n*c+l*r+m*v+d*_-f*e,t[6]=o*h+a*c+n*u-i*s+d*r+m*e+f*v-l*_,t[7]=a*h-n*s-i*u-o*c+m*r-f*_-l*v-d*e,t}r.setReal=t,r.mul=u;var c=m.dot;r.dot=c;t=m.length;r.length=t,r.len=t;var f=m.squaredLength;r.squaredLength=f,r.sqrLen=f},{"./common.js":1,"./mat4.js":6,"./quat.js":7}],9:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.clone=function(t){var e=new i.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var r=new i.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,r){return t[0]=e,t[1]=r,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},r.subtract=o,r.multiply=u,r.divide=c,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},r.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},r.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},r.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},r.distance=h,r.squaredDistance=f,r.length=l,r.squaredLength=d,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var r=e[0],n=e[1],n=r*r+n*n;0<n&&(n=1/Math.sqrt(n));return t[0]=e[0]*n,t[1]=e[1]*n,t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,r){r=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=r,t},r.lerp=function(t,e,r,n){var i=e[0],e=e[1];return t[0]=i+n*(r[0]-i),t[1]=e+n*(r[1]-e),t},r.random=function(t,e){e=e||1;var r=2*i.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},r.transformMat2=function(t,e,r){var n=e[0],e=e[1];return t[0]=r[0]*n+r[2]*e,t[1]=r[1]*n+r[3]*e,t},r.transformMat2d=function(t,e,r){var n=e[0],e=e[1];return t[0]=r[0]*n+r[2]*e+r[4],t[1]=r[1]*n+r[3]*e+r[5],t},r.transformMat3=function(t,e,r){var n=e[0],e=e[1];return t[0]=r[0]*n+r[3]*e+r[6],t[1]=r[1]*n+r[4]*e+r[7],t},r.transformMat4=function(t,e,r){var n=e[0],e=e[1];return t[0]=r[0]*n+r[4]*e+r[12],t[1]=r[1]*n+r[5]*e+r[13],t},r.rotate=function(t,e,r,n){var i=e[0]-r[0],o=e[1]-r[1],e=Math.sin(n),n=Math.cos(n);return t[0]=i*n-o*e+r[0],t[1]=i*e+o*n+r[1],t},r.angle=function(t,e){var r=t[0],n=t[1],i=e[0],t=e[1],e=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+t*t),e=e&&(r*i+n*t)/e;return Math.acos(Math.min(Math.max(e,-1),1))},r.zero=function(t){return t[0]=0,t[1]=0,t},r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},r.equals=function(t,e){var r=t[0],n=t[1],t=e[0],e=e[1];return Math.abs(r-t)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(t))&&Math.abs(n-e)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))},r.forEach=r.sqrLen=r.sqrDist=r.dist=r.div=r.mul=r.sub=r.len=void 0;var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=i?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(){var t=new i.ARRAY_TYPE(2);return i.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function o(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function u(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function c(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function h(t,e){var r=e[0]-t[0],t=e[1]-t[1];return Math.hypot(r,t)}function f(t,e){var r=e[0]-t[0],t=e[1]-t[1];return r*r+t*t}function l(t){var e=t[0],t=t[1];return Math.hypot(e,t)}function d(t){var e=t[0],t=t[1];return e*e+t*t}r.len=l,r.sub=o,r.mul=u,r.div=c,r.dist=h,r.sqrDist=f,r.sqrLen=d;var m,t=(m=n(),function(t,e,r,n,i,o){var a,s;for(e=e||2,r=r||0,s=n?Math.min(n*e+r,t.length):t.length,a=r;a<s;a+=e)m[0]=t[a],m[1]=t[a+1],i(m,m,o),t[a]=m[0],t[a+1]=m[1];return t});r.forEach=t},{"./common.js":1}],10:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.clone=function(t){var e=new s.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.length=i,r.fromValues=function(t,e,r){var n=new s.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},r.subtract=o,r.multiply=c,r.divide=h,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},r.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},r.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},r.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},r.distance=f,r.squaredDistance=l,r.squaredLength=d,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],i=r*r+n*n+i*i;0<i&&(i=1/Math.sqrt(i));return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},r.dot=m,r.cross=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],e=r[1],r=r[2];return t[0]=i*r-o*e,t[1]=o*a-n*r,t[2]=n*e-i*a,t},r.lerp=function(t,e,r,n){var i=e[0],o=e[1],e=e[2];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=e+n*(r[2]-e),t},r.hermite=function(t,e,r,n,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),o=a*(3-2*o);return t[0]=e[0]*s+r[0]*u+n[0]*c+i[0]*o,t[1]=e[1]*s+r[1]*u+n[1]*c+i[1]*o,t[2]=e[2]*s+r[2]*u+n[2]*c+i[2]*o,t},r.bezier=function(t,e,r,n,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,s=3*o*s,a=3*u*a,o=u*o;return t[0]=e[0]*c+r[0]*s+n[0]*a+i[0]*o,t[1]=e[1]*c+r[1]*s+n[1]*a+i[1]*o,t[2]=e[2]*c+r[2]*s+n[2]*a+i[2]*o,t},r.random=function(t,e){e=e||1;var r=2*s.RANDOM()*Math.PI,n=2*s.RANDOM()-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t},r.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2],e=r[3]*n+r[7]*i+r[11]*o+r[15];return e=e||1,t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/e,t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/e,t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/e,t},r.transformMat3=function(t,e,r){var n=e[0],i=e[1],e=e[2];return t[0]=n*r[0]+i*r[3]+e*r[6],t[1]=n*r[1]+i*r[4]+e*r[7],t[2]=n*r[2]+i*r[5]+e*r[8],t},r.transformQuat=function(t,e,r){var n=r[0],i=r[1],o=r[2],a=r[3],s=e[0],u=e[1],c=e[2],h=i*c-o*u,f=o*s-n*c,r=n*u-i*s,e=i*r-o*f,o=o*h-n*r,i=n*f-i*h,a=2*a;return h*=a,f*=a,r*=a,e*=2,o*=2,i*=2,t[0]=s+h+e,t[1]=u+f+o,t[2]=c+r+i,t},r.rotateX=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},r.rotateY=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},r.rotateZ=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},r.angle=function(t,e){var r=t[0],n=t[1],i=t[2],o=e[0],a=e[1],s=e[2],i=Math.sqrt(r*r+n*n+i*i),s=Math.sqrt(o*o+a*a+s*s),s=i*s,s=s&&m(t,e)/s;return Math.acos(Math.min(Math.max(s,-1),1))},r.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},r.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=e[0],t=e[1],e=e[2];return Math.abs(r-o)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-t)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(t))&&Math.abs(i-e)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(e))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var s=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=i?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function n(){var t=new s.ARRAY_TYPE(3);return s.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function i(t){var e=t[0],r=t[1],t=t[2];return Math.hypot(e,r,t)}function o(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function c(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function h(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function f(t,e){var r=e[0]-t[0],n=e[1]-t[1],t=e[2]-t[2];return Math.hypot(r,n,t)}function l(t,e){var r=e[0]-t[0],n=e[1]-t[1],t=e[2]-t[2];return r*r+n*n+t*t}function d(t){var e=t[0],r=t[1],t=t[2];return e*e+r*r+t*t}function m(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}r.sub=o,r.mul=c,r.div=h,r.dist=f,r.sqrDist=l,r.len=i,r.sqrLen=d;var _,t=(_=n(),function(t,e,r,n,i,o){var a,s;for(e=e||3,r=r||0,s=n?Math.min(n*e+r,t.length):t.length,a=r;a<s;a+=e)_[0]=t[a],_[1]=t[a+1],_[2]=t[a+2],i(_,_,o),t[a]=_[0],t[a+1]=_[1],t[a+2]=_[2];return t});r.forEach=t},{"./common.js":1}],11:[function(t,e,r){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.clone=function(t){var e=new c.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,r,n){var i=new c.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},r.subtract=i,r.multiply=o,r.divide=u,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},r.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},r.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},r.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},r.distance=h,r.squaredDistance=f,r.length=l,r.squaredLength=d,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],e=r*r+n*n+i*i+o*o;0<e&&(e=1/Math.sqrt(e));return t[0]=r*e,t[1]=n*e,t[2]=i*e,t[3]=o*e,t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.cross=function(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],u=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],h=e[0],r=e[1],n=e[2],e=e[3];return t[0]=r*c-n*u+e*s,t[1]=-h*c+n*a-e*o,t[2]=h*u-r*a+e*i,t[3]=-h*s+r*o-n*i,t},r.lerp=function(t,e,r,n){var i=e[0],o=e[1],a=e[2],e=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=a+n*(r[2]-a),t[3]=e+n*(r[3]-e),t},r.random=function(t,e){var r,n,i,o,a,s;e=e||1;for(;r=2*c.RANDOM()-1,n=2*c.RANDOM()-1,a=r*r+n*n,1<=a;);for(;i=2*c.RANDOM()-1,o=2*c.RANDOM()-1,s=i*i+o*o,1<=s;);var u=Math.sqrt((1-a)/s);return t[0]=e*r,t[1]=e*n,t[2]=e*i*u,t[3]=e*o*u,t},r.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2],e=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*e,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*e,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*e,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*e,t},r.transformQuat=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[0],s=r[1],u=r[2],c=r[3],h=c*n+s*o-u*i,f=c*i+u*n-a*o,r=c*o+a*i-s*n,o=-a*n-s*i-u*o;return t[0]=h*c+o*-a+f*-u-r*-s,t[1]=f*c+o*-s+r*-a-h*-u,t[2]=r*c+o*-u+h*-s-f*-a,t[3]=e[3],t},r.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],s=e[1],t=e[2],e=e[3];return Math.abs(r-a)<=c.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=c.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-t)<=c.EPSILON*Math.max(1,Math.abs(i),Math.abs(t))&&Math.abs(o-e)<=c.EPSILON*Math.max(1,Math.abs(o),Math.abs(e))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var c=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==a(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var r,n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in t){var o;Object.prototype.hasOwnProperty.call(t,r)&&((o=i?Object.getOwnPropertyDescriptor(t,r):null)&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=t[r])}n.default=t,e&&e.set(t,n);return n}(t("./common.js"));function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function n(){var t=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function o(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function u(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function h(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],t=e[3]-t[3];return Math.hypot(r,n,i,t)}function f(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],t=e[3]-t[3];return r*r+n*n+i*i+t*t}function l(t){var e=t[0],r=t[1],n=t[2],t=t[3];return Math.hypot(e,r,n,t)}function d(t){var e=t[0],r=t[1],n=t[2],t=t[3];return e*e+r*r+n*n+t*t}r.sub=i,r.mul=o,r.div=u,r.dist=h,r.sqrDist=f,r.len=l,r.sqrLen=d;var m,t=(m=n(),function(t,e,r,n,i,o){var a,s;for(e=e||4,r=r||0,s=n?Math.min(n*e+r,t.length):t.length,a=r;a<s;a+=e)m[0]=t[a],m[1]=t[a+1],m[2]=t[a+2],m[3]=t[a+3],i(m,m,o),t[a]=m[0],t[a+1]=m[1],t[a+2]=m[2],t[a+3]=m[3];return t});r.forEach=t},{"./common.js":1}],12:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.noiseAmplitude=r.noiseFrequency=r.noiseOctaves=r.workerBufferSize=r.workerTotal=r.workerFile=r.controllerKeyboardSensivity=r.controllerMouseSensivity=r.controllerMovingSpeed=r.chunkRange=r.chunkLimit=r.chunkSize=void 0,r.chunkSize=15,r.chunkLimit=0,r.chunkRange=3,r.controllerMovingSpeed=16,r.controllerMouseSensivity=.2,r.controllerKeyboardSensivity=80,r.workerFile="./dist/worker.js",r.workerTotal=2,r.workerBufferSize=5e5,r.noiseOctaves=1,r.noiseFrequency=1,r.noiseAmplitude=.5},{}],13:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const c=t("../configuration"),i=t("./generation/ChunkGenerator"),o=t("./webGLRenderer/WebGLRenderer");r.default=class{constructor(){this._touches=[],this._chunksCreated=0,this._chunksDiscarded=0,this._currFrameTime=-1,this._framesDuration=[];const n=document.getElementById("main-canvas");if(!n)throw new Error("main-canvas not found");this._renderer=new o.default({canvasDomElement:n,chunkSize:c.chunkSize,mouseSensivity:c.controllerMouseSensivity,movingSpeed:c.controllerMovingSpeed,keyboardSensivity:c.controllerKeyboardSensivity}),this._renderer.getFreeFlyCamera().setPosition(c.chunkSize/4*3,c.chunkSize/4*3,0),this._chunkGenerator=new i.default({chunkSize:c.chunkSize,chunkRange:c.chunkRange,workerTotal:c.workerTotal,workerFile:c.workerFile,workerBufferSize:c.workerBufferSize,chunkIsVisible:t=>this._renderer.chunkIsVisible(t),pointIsVisible:t=>this._renderer.pointIsVisible(t),addGeometry:t=>this._renderer.addGeometry(t),updateGeometry:(t,e)=>{this._renderer.updateGeometry(t,e)},onChunkCreated:()=>{++this._chunksCreated},onChunkDiscarded:()=>{++this._chunksDiscarded}});var t=t=>{var e=t.targetTouches,r=this._renderer.getSize();for(let t=this._touches.length=0;t<e.length;++t)this._touches.push({id:e[t].identifier,x:e[t].pageX,y:r[1]-e[t].pageY})};n.addEventListener("touchstart",t),n.addEventListener("touchend",t),n.addEventListener("touchmove",t);const e=document.getElementById("gui_fullscreen");if(!e)throw new Error("guiFullscreen not found");e.addEventListener("click",()=>{n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.msRequestFullscreen&&n.msRequestFullscreen()});t=()=>{let t=null,e=null;var r=null!==document.fullscreenElement||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement;e=r?(n.style.position="absolute",t=window.innerWidth,window.innerHeight):(n.style.position="relative",t=800,600),n.style.left="0px",n.style.top="0px",n.width=t,n.height=e,this._renderer.resize(t,e)};document.addEventListener("fullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),document.addEventListener("webkitfullscreenchange",t,!1),document.addEventListener("msfullscreenchange",t,!1),this._running=!1,this._errorGraphicContext=!1,this._renderer.setOnContextLost(()=>{console.log("on_context_lost"),this._errorGraphicContext=!0,this.stop()}),this._renderer.setOnContextRestored(()=>{console.log("on_context_restored"),this._errorGraphicContext=!1,this.start()})}async init(){await this._renderer.init()}start(){this.isRunning()||(this._running=!0,this._chunkGenerator.start(),this._tick())}stop(){this._running=!1,this._chunkGenerator.stop()}isRunning(){return this._running&&!this._errorGraphicContext}_tick(){const t=()=>{this._running&&!this._errorGraphicContext&&(this._mainLoop(),window.requestAnimationFrame(t))};t()}_mainLoop(){var r=Date.now(),n=r-this._currFrameTime;this._currFrameTime=r,this._framesDuration.push(n/1e3);var i=this._renderer.getCameraPosition();this._chunkGenerator.update(i);r=this._chunkGenerator.getChunks();this._renderer.update(n/1e3,r),this._renderer.renderScene(r);{n=[Math.floor(i[0]/c.chunkSize),Math.floor(i[1]/c.chunkSize),Math.floor(i[2]/c.chunkSize)];let t=0;for(const s of r)s.visible&&++t;var e=[10,10],o=["Chunks:",`>Generated: ${this._chunksCreated}`,`>Discarded: ${this._chunksDiscarded}`,`>Live:      ${this._chunksCreated-this._chunksDiscarded}`,`>Visible:   ${t}`,"",`Coordinates: ${n[0]}/${n[1]}/${n[2]}`],a=this._renderer.getCharacterSize();for(let t=0;t<o.length;++t)this._renderer.pushText(o[t],[e[0],e[1]+a*(6-t)],1)}i=this._renderer.getFreeFlyCamera().getTimeImmobile();if(3<i){r=5<i?1:(i-3)/2;const t=this._renderer.getSize();t[0]=.75*t[0];const u=["         *---*         ","         |W/Z|         ","         *---*         ","                       ","   *---* *---* *---*   ","   |A/Q| | S | | D |   ","   *---* *---* *---*   ","","        *----*         ","        | UP |         ","        *----*         ","                       "," *----* *----* *-----* "," |LEFT| |DOWN| |RIGHT| "," *----* *----* *-----* ","","   *---------------*   ","   |MOUSE SUPPORTED|   ","   *---------------*   ","","*---------------------*","|TOUCHSCREEN SUPPORTED|","*---------------------*"];let e=0;u.forEach(t=>e=Math.max(e,t.length)),e*=this._renderer.getCharacterSize()*r;n=u.length*this._renderer.getCharacterSize()*r,i=u.join("\n"),n=[.5*t[0]-.5*e,.5*t[1]+.5*n];this._renderer.pushText(i,n,r)}this._renderer.renderHUD(this._chunkGenerator.getChunks(),this._chunkGenerator.getProcessingPositions(),this._touches,this._framesDuration),100<this._framesDuration.length&&this._framesDuration.splice(0,this._framesDuration.length-100)}}},{"../configuration":12,"./generation/ChunkGenerator":14,"./webGLRenderer/WebGLRenderer":15}],14:[function(t,e,r){"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),(i=n=n||{})[i.available=1]="available",i[i.working=2]="working";r.default=class{constructor(t){this._running=!1,this._chunks=[],this._chunkPositionQueue=[],this._geometriesPool=[],this._savedIndex=[999,999,999],this._workers=[],this._cameraPosition=[0,0,0],this._processingPositions=[],this._def=t;for(let t=0;t<this._def.workerTotal;++t)this._addWorker()}_addWorker(){const r={instance:new Worker(this._def.workerFile),float32buffer:new Float32Array(this._def.workerBufferSize),status:n.available};r.instance.addEventListener("message",t=>{var e=t.data.position;r.float32buffer=t.data.float32buffer,r.status=n.available;for(let t=0;t<this._processingPositions.length;++t)if(this._processingPositions[t][0]===e[0]&&this._processingPositions[t][1]===e[1]&&this._processingPositions[t][2]===e[2]){this._processingPositions.splice(t,1);break}if(this._running){let t=void 0;0==this._geometriesPool.length?t=this._def.addGeometry(r.float32buffer):(t=this._geometriesPool.pop(),t&&this._def.updateGeometry(t,r.float32buffer)),t?(this._chunks.push({position:e,geometry:t,coord2d:null,visible:!1}),this._def.onChunkCreated&&this._def.onChunkCreated(),this._launchWorker()):console.log("worker: processing the result -> invalid geometry")}},!1),this._workers.push(r)}start(){this._running=!0}stop(){this._running&&(this._running=!1,this._chunkPositionQueue.length=0,this._chunks.length=0,this._geometriesPool.length=0)}update(t){if(this._running){this._cameraPosition=t;var e=[Math.floor(t[0]/this._def.chunkSize),Math.floor(t[1]/this._def.chunkSize),Math.floor(t[2]/this._def.chunkSize)];if(0==this._chunks.length||e[0]!=this._savedIndex[0]||e[1]!=this._savedIndex[1]||e[2]!=this._savedIndex[2]){this._savedIndex[0]=e[0],this._savedIndex[1]=e[1],this._savedIndex[2]=e[2],this._chunkPositionQueue.length=0;var t=this._def.chunkRange,i=[Math.floor(e[0]-t),Math.floor(e[1]-t),Math.floor(e[2]-t)],o=[Math.floor(e[0]+t),Math.floor(e[1]+t),Math.floor(e[2]+t)];for(let t=0;t<this._chunks.length;++t){var r=[this._chunks[t].position[0]/this._def.chunkSize|0,this._chunks[t].position[1]/this._def.chunkSize|0,this._chunks[t].position[2]/this._def.chunkSize|0];(r[0]<i[0]||o[0]<r[0]||r[1]<i[1]||o[1]<r[1]||r[2]<i[2]||o[2]<r[2])&&(this._geometriesPool.push(this._chunks[t].geometry),this._chunks.splice(t,1),--t,this._def.onChunkDiscarded&&this._def.onChunkDiscarded())}for(let n=i[2];n<=o[2];++n)for(let r=i[1];r<=o[1];++r)for(let t=i[0];t<=o[0];++t){var a=[t*this._def.chunkSize,r*this._def.chunkSize,n*this._def.chunkSize];let e=!1;for(let t=0;t<this._chunks.length;++t){var s=this._chunks[t].position;if(s[0]===a[0]&&s[1]===a[1]&&s[2]===a[2]){e=!0;break}}e||this._chunkPositionQueue.push(a)}this._launchWorker()}}}_launchWorker(){const e=this._workers.find(t=>t.status==n.available);if(void 0!==e&&0!=this._chunkPositionQueue.length){let t=void 0;if(1==this._chunkPositionQueue.length)t=this._chunkPositionQueue.pop();else{let e=-1,r=999999,n=void 0;for(let t=0;t<this._chunkPositionQueue.length;++t){var i=this._chunkPositionQueue[t];-1!=e&&!this._def.chunkIsVisible(i)||(i=[this._cameraPosition[0]-i[0]-this._def.chunkSize/2,this._cameraPosition[1]-i[1]-this._def.chunkSize/2,this._cameraPosition[2]-i[2]-this._def.chunkSize/2],o=i,i=Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]),r<i||(e=t,r=i,n=this._chunkPositionQueue[e]))}this._chunkPositionQueue.splice(e,1),t=n}var o;void 0!==t&&(this._processingPositions.push(t),e.status=n.working,e.instance.postMessage({position:t,float32buffer:e.float32buffer},[e.float32buffer.buffer]))}}getChunks(){return this._chunks}getProcessingPositions(){return this._processingPositions}}},{}],15:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const k=t("./wrappers/WebGLContext"),h=t("./wrappers/ShaderProgram"),R=t("./wrappers/Texture"),f=t("./wrappers/Geometry"),n=t("./camera/FreeFlyCamera"),i=t("./camera/FrustumCulling"),a=t("./camera/sceneToScreenCoordinates"),l=t("./shaders/index"),d=t("./utils/generateWireframeCubeVertices"),m=t("./utils/generateWireframeFrustumVertices"),A=t("gl-matrix");r.default=class{constructor(t){this.onContextLost=null,this.onContextRestored=null,this._fpsmeterAngle=0,this._fpsmeterSpeed=0,this._touchesAngle=new Map,this._def=t,k.default.initialise(this._def.canvasDomElement),this._def.canvasDomElement.addEventListener("webglcontextlost",t=>{t.preventDefault(),console.log("context is lost"),this.onContextLost&&this.onContextLost()},!1),this._def.canvasDomElement.addEventListener("webglcontextrestored",()=>{console.log("context is restored"),k.default.initialise(this._def.canvasDomElement),this.onContextRestored&&this.onContextRestored()},!1);t=k.default.getViewportSize();this._freeFlyCamera=new n.default({targetElement:this._def.canvasDomElement,mouseSensivity:this._def.mouseSensivity,movingSpeed:this._def.movingSpeed,keyboardSensivity:this._def.keyboardSensivity}),this._freeFlyCamera.activate(),this._frustumCulling=new i.default,this._projectionMatrix=A.mat4.create(),this._modelviewMatrix=A.mat4.create(),this._aspectRatio=.75*t[0]/t[1],this._initialiseChunkRendering(),this._initialiseWireframeRendering(),this._initialiseTextRendering()}_initialiseChunkRendering(){var t=new h.default({vertexSrc:l.scene.vertex,fragmentSrc:l.scene.fragment,attributes:["a_vertexPosition","a_vertexColor","a_vertexNormal","a_vertexBCenter"],uniforms:["u_modelviewMatrix","u_projMatrix","u_cameraPos","u_sampler"]}),e={vbos:[{attrs:[{name:"a_vertexPosition",type:f.default.AttributeType.vec3f,index:0},{name:"a_vertexColor",type:f.default.AttributeType.vec3f,index:3},{name:"a_vertexNormal",type:f.default.AttributeType.vec3f,index:6},{name:"a_vertexBCenter",type:f.default.AttributeType.vec3f,index:9}],stride:48,instanced:!1}],primitiveType:f.default.PrimitiveType.triangles};this._chunkRendering={texture:new R.default,shader:t,geometryDefinition:e}}_initialiseWireframeRendering(){var t=new h.default({vertexSrc:l.color.vertex,fragmentSrc:l.color.fragment,attributes:["a_vertexPosition","a_vertexColor"],uniforms:["u_modelviewMatrix","u_projMatrix"]}),e={vbos:[{attrs:[{name:"a_vertexPosition",type:f.default.AttributeType.vec3f,index:0},{name:"a_vertexColor",type:f.default.AttributeType.vec3f,index:3}],stride:24,instanced:!1}],primitiveType:f.default.PrimitiveType.lines};let r=[];r.push(0,0,0,1,0,0,20,0,0,1,0,0),r.push(0,0,0,0,1,0,0,20,0,0,1,0),r.push(0,0,0,0,0,1,0,0,20,0,0,1);const n=new f.default.Geometry(t,e);n.updateBuffer(0,r),n.setPrimitiveCount(r.length/6),r.length=0;r.push(-5,0,0,1,1,1),r.push(25,0,0,1,1,1),r.push(0,-5,0,1,1,1),r.push(0,5,0,1,1,1),r.push(0,0,-5,1,1,1),r.push(0,0,5,1,1,1);const i=new f.default.Geometry(t,e);i.updateBuffer(0,r),i.setPrimitiveCount(r.length/6),r=d.default(this._def.chunkSize,[1,0,0]);const o=new f.default.Geometry(t,e);o.updateBuffer(0,r),o.setPrimitiveCount(r.length/6),r=d.default(this._def.chunkSize,[1,1,1]);const a=new f.default.Geometry(t,e);a.updateBuffer(0,r),a.setPrimitiveCount(r.length/6),r=d.default(this._def.chunkSize,[0,1,0]);const s=new f.default.Geometry(t,e);s.updateBuffer(0,r),s.setPrimitiveCount(r.length/6);var u=new f.default.Geometry(t,e);r=m.default(70,this._aspectRatio,.1,40);const c=new f.default.Geometry(t,e);c.updateBuffer(0,r),c.setPrimitiveCount(r.length/6);e={vbos:[{attrs:[{name:"a_vertexPosition",type:f.default.AttributeType.vec3f,index:0},{name:"a_vertexColor",type:f.default.AttributeType.vec3f,index:3}],stride:24,instanced:!1}],primitiveType:f.default.PrimitiveType.triangles},e=new f.default.Geometry(t,e);this._wireframeRendering={shader:t,geometry_frustum:c,geometry_axis:n,geometry_cross:i,geometry_cubeR:o,geometry_cubeW:a,geometry_cubeG:s,geometry_wireframe_stack_rendering:u,geometry_thick_line_stack_rendering:e}}_initialiseTextRendering(){var t=new h.default({vertexSrc:l.text.vertex,fragmentSrc:l.text.fragment,attributes:["a_position","a_texCoord","a_offsetPosition","a_offsetTexCoord","a_offsetScale"],uniforms:["u_modelviewMatrix","u_projectionMatrix","u_texture"]}),e={vbos:[{attrs:[{name:"a_position",type:f.default.AttributeType.vec2f,index:0},{name:"a_texCoord",type:f.default.AttributeType.vec2f,index:2}],stride:16,instanced:!1},{attrs:[{name:"a_offsetPosition",type:f.default.AttributeType.vec2f,index:0},{name:"a_offsetTexCoord",type:f.default.AttributeType.vec2f,index:2},{name:"a_offsetScale",type:f.default.AttributeType.float,index:4}],stride:20,instanced:!0}],primitiveType:f.default.PrimitiveType.triangles};const r=new f.default.Geometry(t,e);var n=[256,256],e=[16,16],e=[n[0]/e[0],n[1]/e[1]],n=[e[0]/n[0],e[1]/n[1]],i=[[[+e[0],0],[n[0],n[1]]],[[0,0],[0,n[1]]],[[+e[0],+e[1]],[n[0],0]],[[0,+e[1]],[0,0]]];const o=[];for(const s of[1,0,2,1,3,2]){var a=i[s];o.push(a[0][0],a[0][1],a[1][0],a[1][1])}r.updateBuffer(0,o),r.setPrimitiveCount(o.length/4);n=new Map([[" ",[0*n[0],0*n[1]]],["!",[+n[0],0*n[1]]],['"',[2*n[0],0*n[1]]],["#",[3*n[0],0*n[1]]],["$",[4*n[0],0*n[1]]],["%",[5*n[0],0*n[1]]],["&",[6*n[0],0*n[1]]],["'",[7*n[0],0*n[1]]],["(",[8*n[0],0*n[1]]],[")",[9*n[0],0*n[1]]],["*",[10*n[0],0*n[1]]],["+",[11*n[0],0*n[1]]],[",",[12*n[0],0*n[1]]],["-",[13*n[0],0*n[1]]],[".",[14*n[0],0*n[1]]],["/",[15*n[0],0*n[1]]],["0",[0*n[0],+n[1]]],["1",[+n[0],+n[1]]],["2",[2*n[0],+n[1]]],["3",[3*n[0],+n[1]]],["4",[4*n[0],+n[1]]],["5",[5*n[0],+n[1]]],["6",[6*n[0],+n[1]]],["7",[7*n[0],+n[1]]],["8",[8*n[0],+n[1]]],["9",[9*n[0],+n[1]]],[":",[10*n[0],+n[1]]],[";",[11*n[0],+n[1]]],["<",[12*n[0],+n[1]]],["=",[13*n[0],+n[1]]],[">",[14*n[0],+n[1]]],["?",[15*n[0],+n[1]]],["@",[0*n[0],2*n[1]]],["A",[+n[0],2*n[1]]],["B",[2*n[0],2*n[1]]],["C",[3*n[0],2*n[1]]],["D",[4*n[0],2*n[1]]],["E",[5*n[0],2*n[1]]],["F",[6*n[0],2*n[1]]],["G",[7*n[0],2*n[1]]],["H",[8*n[0],2*n[1]]],["I",[9*n[0],2*n[1]]],["J",[10*n[0],2*n[1]]],["K",[11*n[0],2*n[1]]],["L",[12*n[0],2*n[1]]],["M",[13*n[0],2*n[1]]],["N",[14*n[0],2*n[1]]],["O",[15*n[0],2*n[1]]],["P",[0*n[0],3*n[1]]],["Q",[+n[0],3*n[1]]],["R",[2*n[0],3*n[1]]],["S",[3*n[0],3*n[1]]],["T",[4*n[0],3*n[1]]],["U",[5*n[0],3*n[1]]],["V",[6*n[0],3*n[1]]],["W",[7*n[0],3*n[1]]],["X",[8*n[0],3*n[1]]],["Y",[9*n[0],3*n[1]]],["Z",[10*n[0],3*n[1]]],["[",[11*n[0],3*n[1]]],["\\",[12*n[0],3*n[1]]],["]",[13*n[0],3*n[1]]],["^",[14*n[0],3*n[1]]],["_",[15*n[0],3*n[1]]],["`",[0*n[0],4*n[1]]],["a",[+n[0],4*n[1]]],["b",[2*n[0],4*n[1]]],["c",[3*n[0],4*n[1]]],["d",[4*n[0],4*n[1]]],["e",[5*n[0],4*n[1]]],["f",[6*n[0],4*n[1]]],["g",[7*n[0],4*n[1]]],["h",[8*n[0],4*n[1]]],["i",[9*n[0],4*n[1]]],["j",[10*n[0],4*n[1]]],["k",[11*n[0],4*n[1]]],["l",[12*n[0],4*n[1]]],["m",[13*n[0],4*n[1]]],["n",[14*n[0],4*n[1]]],["o",[15*n[0],4*n[1]]],["p",[0*n[0],5*n[1]]],["q",[+n[0],5*n[1]]],["r",[2*n[0],5*n[1]]],["s",[3*n[0],5*n[1]]],["t",[4*n[0],5*n[1]]],["u",[5*n[0],5*n[1]]],["v",[6*n[0],5*n[1]]],["w",[7*n[0],5*n[1]]],["x",[8*n[0],5*n[1]]],["y",[9*n[0],5*n[1]]],["z",[10*n[0],5*n[1]]],["{",[11*n[0],5*n[1]]],["|",[12*n[0],5*n[1]]],["}",[13*n[0],5*n[1]]],["~",[14*n[0],5*n[1]]]]);this._textRendering={characterSize:16,texture:new R.default,shader:t,geometry:r,TexCoordMap:n,stack_vertices:[]}}chunkIsVisible(t){var e=.5*this._def.chunkSize;return this._frustumCulling.cubeInFrustum(t[0]+e,t[1]+e,t[2]+e,e)}pointIsVisible(t){return this._frustumCulling.pointInFrustum(t[0],t[1],t[2])}addGeometry(t){const e=new f.default.Geometry(this._chunkRendering.shader,this._chunkRendering.geometryDefinition);return e.updateBuffer(0,t),e.setPrimitiveCount(t.length/12),e}updateGeometry(t,e){t.updateBuffer(0,e)}getCameraPosition(){return this._freeFlyCamera.getPosition()}getFreeFlyCamera(){return this._freeFlyCamera}getCharacterSize(){return this._textRendering.characterSize}resize(t,e){const r=k.default.getViewportSize();r[0]=t,r[1]=e,this._aspectRatio=.75*r[0]/r[1];e=m.default(70,this._aspectRatio,.1,40);this._wireframeRendering.geometry_frustum.updateBuffer(0,e),this._wireframeRendering.geometry_frustum.setPrimitiveCount(e.length/6)}toggleContextLoss(){const t=k.default.getContext(),e=k.default.getExtensionLoseContext();e&&(t.isContextLost()?e.restoreContext():e.loseContext())}contextIsLost(){const t=k.default.getContext();return t.isContextLost()}setOnContextLost(t){this.onContextLost=t}setOnContextRestored(t){this.onContextRestored=t}async init(){const t=k.default.getContext();t.clearColor(0,0,0,1),t.enable(t.DEPTH_TEST),t.activeTexture(t.TEXTURE0),await this._chunkRendering.texture.load("assets/texture.png"),await this._textRendering.texture.load("assets/ascii_font.png")}getSize(){var t=k.default.getViewportSize();return[t[0],t[1]]}update(t,e){var r=k.default.getViewportSize();this._freeFlyCamera.update(1/60),A.mat4.perspective(this._projectionMatrix,70,this._aspectRatio,.1,70),this._freeFlyCamera.updateViewMatrix(this._modelviewMatrix),this._frustumCulling.calculateFrustum(this._projectionMatrix,this._modelviewMatrix);var n,i=[0,0,.75*r[0],r[1]];for(const o of e)o.visible=this.chunkIsVisible(o.position),o.coord2d=null,!this.pointIsVisible(o.position)||(n=a.default(o.position,this._modelviewMatrix,this._projectionMatrix,i))&&(o.coord2d=n)}pushText(e,r,n){var t=[256,256],i=[this._textRendering.characterSize,this._textRendering.characterSize],o=[t[0]/i[0],t[1]/i[1]];const a=[r[0],r[1]];for(let t=0;t<e.length;++t){var s=e[t];if("\n"!=s){var u=this._textRendering.TexCoordMap.get(s);if(!u)throw new Error(`fail to find a letter, letter=${s}`);this._textRendering.stack_vertices.push(a[0],a[1],u[0],u[1],n),a[0]+=o[0]*n}else a[0]=r[0],a[1]-=o[1]*n}}renderScene(e){const r=k.default.getContext();var t=k.default.getViewportSize();r.viewport(0,0,.75*t[0],t[1]),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),this._chunkRendering.shader.bind(),this._chunkRendering.texture.bind(),r.uniform1i(this._chunkRendering.shader.getUniform("u_sampler"),0),r.uniformMatrix4fv(this._chunkRendering.shader.getUniform("u_modelviewMatrix"),!1,this._modelviewMatrix),r.uniformMatrix4fv(this._chunkRendering.shader.getUniform("u_projMatrix"),!1,this._projectionMatrix);t=this._freeFlyCamera.getPosition();r.uniform3f(this._chunkRendering.shader.getUniform("u_cameraPos"),t[0],t[1],t[2]);for(let t=0;t<e.length;++t)e[t].visible&&e[t].geometry.render();this._wireframeRendering.shader.bind(),r.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_projMatrix"),!1,this._projectionMatrix),r.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,this._modelviewMatrix);var n=A.mat4.create();for(let t=0;t<e.length;++t)e[t].visible&&(A.mat4.translate(n,this._modelviewMatrix,e[t].position),r.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,n),this._wireframeRendering.geometry_cubeW.render());h.default.unbind()}renderHUD(t,e,r,n){const i=k.default.getContext();var o=k.default.getViewportSize();this._wireframeRendering.shader.bind(),i.clear(i.DEPTH_BUFFER_BIT),this._renderMainHud(t,r,n,e),this._wireframeRendering.shader.bind();r=.25*o[0],n=.33*o[1],o=.75*o[0];this._renderSideHud(t,e,[o,0*n,r,n],[1,1.2,1],[0,0,1]),this._renderSideHud(t,e,[o,n,r,n],[0,1,0],[0,0,1]),this._renderSideHud(t,e,[o,2*n,r,n],[0,0,1],[0,1,0]),h.default.unbind()}_renderMainHud(t,e,r,n){const i=k.default.getContext();var o=k.default.getViewportSize(),a=.75*o[0],s=o[1];i.viewport(0,0,a,s);var u=A.mat4.create();A.mat4.ortho(u,.5*-a,.5*a,.5*-s,.5*+s,-200,200);var c=A.mat4.create();A.mat4.lookAt(c,[.5*a,.5*+s,1],[.5*a,.5*+s,0],[0,1,0]),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,c),i.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_projMatrix"),!1,u);var h=[100,50],f=[10,o[1]-10-h[1]];{const g=[];g.push(f[0],f[1],0,1,1,1),g.push(f[0]+h[0],f[1],0,1,1,1),g.push(f[0]+h[0],f[1],0,1,1,1),g.push(f[0]+h[0],f[1]+h[1],0,1,1,1),g.push(f[0]+h[0],f[1]+h[1],0,1,1,1),g.push(f[0],f[1]+h[1],0,1,1,1),g.push(f[0],f[1]+h[1],0,1,1,1),g.push(f[0],f[1],0,1,1,1);for(let t=1;t<r.length;++t){var l=(t-1)/r.length,d=t/r.length,m=Math.min(r[t-1],1/30)/(1/30),_=Math.min(r[t],1/30)/(1/30);g.push(f[0]+h[0]*l,f[1]+h[1]*m,0,1,1,1),g.push(f[0]+h[0]*d,f[1]+h[1]*_,0,1,1,1)}{let t=0;for(const b of r)t+=b;t/=r.length;const M=1/t;let e="999";M<999&&(e=M.toFixed(0).padStart(3," ")),this.pushText(`${e}fps`,[f[0],f[1]-this._textRendering.characterSize],1)}this._wireframeRendering.geometry_wireframe_stack_rendering.updateBuffer(0,g),this._wireframeRendering.geometry_wireframe_stack_rendering.setPrimitiveCount(g.length/6),this._wireframeRendering.geometry_wireframe_stack_rendering.render()}{const y=[];var v=(t,e,r,n,i=[1,1,1])=>{var o;[o,t,r,e=[1,1,1]]=[[t[0]-r*Math.cos(e),t[1]-r*Math.sin(e)],[t[0]+r*Math.cos(e),t[1]+r*Math.sin(e)],n,i],n=Math.atan2(t[1]-o[1],t[0]-o[0])+.5*Math.PI,i=Math.cos(n)*r*.5,r=Math.sin(n)*r*.5,r=[[o[0]-i,o[1]-r],[o[0]+i,o[1]+r],[t[0]-i,t[1]-r],[t[0]+i,t[1]+r]],y.push(r[0][0],r[0][1],0,e[0],e[1],e[2]),y.push(r[3][0],r[3][1],0,e[0],e[1],e[2]),y.push(r[2][0],r[2][1],0,e[0],e[1],e[2]),y.push(r[0][0],r[0][1],0,e[0],e[1],e[2]),y.push(r[1][0],r[1][1],0,e[0],e[1],e[2]),y.push(r[3][0],r[3][1],0,e[0],e[1],e[2])};0<n.length?(this._fpsmeterSpeed+=5e-4,.02<this._fpsmeterSpeed&&(this._fpsmeterSpeed=.02)):(this._fpsmeterSpeed-=5e-4,this._fpsmeterSpeed<0&&(this._fpsmeterSpeed=0)),this._fpsmeterAngle+=this._fpsmeterSpeed;a=[[f[0]+h[0]+.6*h[1],f[1]+.5*h[1]],[f[0]+h[0]+.6*h[1],f[1]+.5*h[1]],[f[0]+h[0]+1.3*h[1],f[1]+.5*h[1]],[f[0]+h[0]+1.3*h[1],f[1]+.5*h[1]]],s=[this._fpsmeterAngle,this._fpsmeterAngle+.5*Math.PI,-this._fpsmeterAngle+.25*Math.PI,-this._fpsmeterAngle+.75*Math.PI],o=.45*h[1],n=[1,1,1];v(a[0],s[0],o,10,n),v(a[1],s[1],o,10,n),v(a[2],s[2],o,10,n),v(a[3],s[3],o,10,n);{const x=new Set;for(const w of e){x.add(w.id);let t=this._touchesAngle.get(w.id);void 0===t&&(t=0,this._touchesAngle.set(w.id,t));var p=[1,0,0];const E=[t,t+.5*Math.PI];this._freeFlyCamera.getForceForward()&&(E.push(t+.25*Math.PI),E.push(t+.75*Math.PI));for(const S of E)v([w.x,w.y],S,150,15,p);t+=.1,this._touchesAngle.set(w.id,t)}const P=new Set;this._touchesAngle.forEach((t,e)=>{x.has(e)||P.add(e)}),P.forEach(t=>{this._touchesAngle.delete(t)})}this._wireframeRendering.geometry_thick_line_stack_rendering.updateBuffer(0,y),this._wireframeRendering.geometry_thick_line_stack_rendering.setPrimitiveCount(y.length/6),this._wireframeRendering.geometry_thick_line_stack_rendering.render()}this._textRendering.shader.bind(),this._textRendering.texture.bind(),i.uniformMatrix4fv(this._textRendering.shader.getUniform("u_modelviewMatrix"),!1,c),i.uniformMatrix4fv(this._textRendering.shader.getUniform("u_projectionMatrix"),!1,u),this._textRendering.geometry.updateBuffer(1,this._textRendering.stack_vertices,!0),this._textRendering.geometry.setInstancedCount(this._textRendering.stack_vertices.length/5),this._textRendering.geometry.render(),R.default.unbind(),this._textRendering.stack_vertices.length=0}_renderSideHud(e,r,t,n,i){const o=k.default.getContext();o.viewport(t[0],t[1],t[2],t[3]);var a=A.mat4.create(),t=t[2]/t[3];A.mat4.ortho(a,-65*t,65*t,-65,65,-200,200);var t=this._freeFlyCamera.getPosition(),s=A.mat4.create();A.mat4.lookAt(s,[t[0]+n[0],t[1]+n[1],t[2]+n[2]],t,i),o.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,s),o.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_projMatrix"),!1,a),this._wireframeRendering.geometry_axis.render();var u=A.mat4.create();for(let t=0;t<e.length;++t){var c=e[t].position;A.mat4.identity(u),e[t].visible?(A.mat4.translate(u,s,c),o.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,u),this._wireframeRendering.geometry_cubeW.render()):(c=[c[0]+.15*this._def.chunkSize,c[1]+.15*this._def.chunkSize,c[2]+.15*this._def.chunkSize],A.mat4.translate(u,s,c),A.mat4.scale(u,u,[.7,.7,.7]),o.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,u),this._wireframeRendering.geometry_cubeR.render())}if(0<r.length)for(let t=0;t<r.length;++t)A.mat4.translate(u,s,[r[t][0]+.2*this._def.chunkSize,r[t][1]+.2*this._def.chunkSize,r[t][2]+.2*this._def.chunkSize]),A.mat4.scale(u,u,[.6,.6,.6]),o.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,u),this._wireframeRendering.geometry_cubeG.render();A.mat4.translate(s,s,this._freeFlyCamera.getPosition()),A.mat4.rotate(s,s,this._freeFlyCamera.getTheta()*Math.PI/180,[0,0,1]),A.mat4.rotate(s,s,this._freeFlyCamera.getPhi()*Math.PI/180,[0,-1,0]),o.uniformMatrix4fv(this._wireframeRendering.shader.getUniform("u_modelviewMatrix"),!1,s),this._wireframeRendering.geometry_cross.render(),this._wireframeRendering.geometry_frustum.render()}}},{"./camera/FreeFlyCamera":16,"./camera/FrustumCulling":17,"./camera/sceneToScreenCoordinates":20,"./shaders/index":22,"./utils/generateWireframeCubeVertices":25,"./utils/generateWireframeFrustumVertices":26,"./wrappers/Geometry":27,"./wrappers/ShaderProgram":28,"./wrappers/Texture":29,"./wrappers/WebGLContext":30,"gl-matrix":2}],16:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=t("gl-matrix"),o=t("./helpers/KeyboardHandler"),a=t("./helpers/PointerLockSetup");var s;(t=s=s||{})[t.forward=1]="forward",t[t.backward=2]="backward",t[t.left=4]="left",t[t.right=8]="right";r.default=class{constructor(t){this._phi=0,this._theta=0,this._forward=[1,0,0],this._left=[0,0,0],this._position=[0,0,0],this._target=[0,0,0],this._movementFlag=0,this._keyboardHandler=new o.KeyboardHandler,this._forceForward=!1,this._timeImmobile=0,this._lastTime=0,this._movingSpeed=t.movingSpeed,this._mouseSensivity=t.mouseSensivity,this._keyboardSensivity=t.keyboardSensivity,this._lastTime=Date.now();const e=t=>{var e=t.movementX||t.mozMovementX||t.webkitMovementX||0,t=t.movementY||t.mozMovementY||t.webkitMovementY||0;this._theta-=e*this._mouseSensivity,this._phi-=t*this._mouseSensivity,this._timeImmobile=0};a.default({targetElement:t.targetElement,enabledCallback:()=>{t.targetElement.addEventListener("mousemove",e,!1)},disabledCallback:()=>{t.targetElement.removeEventListener("mousemove",e,!1)}});let n=null,i=null,r=Date.now();t.targetElement.addEventListener("touchstart",t=>{t.preventDefault(),n=null,i=null;var e=Date.now();1==t.targetTouches.length&&e-r<250&&(this._forceForward=!0),r=e}),t.targetElement.addEventListener("touchend",t=>{t.preventDefault(),n=null,i=null,this._forceForward=!1}),t.targetElement.addEventListener("touchmove",t=>{t.preventDefault();var e,r,t=t.targetTouches;0==t.length||2<t.length||(2==t.length?(r=t[0].pageX-t[1].pageX,e=t[0].pageY-t[1].pageY,r=Math.sqrt(r*r+e*e),i&&(r>i?this._movementFlag|=s.forward:this._movementFlag|=s.backward),i=r):(n&&(e=n.pageX-t[0].pageX,r=n.pageY-t[0].pageY,this._theta-=e/3,this._phi-=r/3),n=t[0]),this._timeImmobile=0)})}update(e){this._handleKeys(e);var t=Date.now();if(this._timeImmobile+=e,3e3<t-this._lastTime&&(this._timeImmobile=10),this._lastTime=t,this._forceForward&&(this._timeImmobile=0),this._movementFlag&s.forward||1==this._forceForward)for(let t=0;t<3;++t)this._position[t]+=this._forward[t]*e*this._movingSpeed;else if(this._movementFlag&s.backward)for(let t=0;t<3;++t)this._position[t]-=this._forward[t]*e*this._movingSpeed;if(this._movementFlag&s.left)for(let t=0;t<3;++t)this._position[t]-=this._left[t]*e*this._movingSpeed;else if(this._movementFlag&s.right)for(let t=0;t<3;++t)this._position[t]+=this._left[t]*e*this._movingSpeed;this._movementFlag=0;this._phi=Math.min(Math.max(this._phi,-89),89);const r=[0,0,1];t=Math.cos(3.14*(this._phi-90)/180);r[2]=Math.sin(3.14*(this._phi-90)/180),r[0]=t*Math.cos(3.14*this._theta/180),r[1]=t*Math.sin(3.14*this._theta/180);t=Math.cos(3.14*this._phi/180);this._forward[2]=Math.sin(3.14*this._phi/180),this._forward[0]=t*Math.cos(3.14*this._theta/180),this._forward[1]=t*Math.sin(3.14*this._theta/180),this._left[0]=r[1]*this._forward[2]-r[2]*this._forward[1],this._left[1]=r[2]*this._forward[0]-r[0]*this._forward[2],this._left[2]=r[0]*this._forward[1]-r[1]*this._forward[0],this._target[0]=this._position[0]+this._forward[0],this._target[1]=this._position[1]+this._forward[1],this._target[2]=this._position[2]+this._forward[2]}updateViewMatrix(t){n.mat4.lookAt(t,[this._position[0],this._position[1],this._position[2]],[this._target[0],this._target[1],this._target[2]],[0,0,1])}setPosition(t,e,r){this._position[0]=t,this._position[1]=e,this._position[2]=r}getPosition(){return[this._position[0],this._position[1],this._position[2]]}getTheta(){return this._theta}getPhi(){return this._phi}getForceForward(){return this._forceForward}getTimeImmobile(){return this._timeImmobile}activate(){this._keyboardHandler.activate()}deactivate(){this._keyboardHandler.deactivate()}_handleKeys(t){var e=this._movementFlag,r=this._phi,n=this._theta;(this._keyboardHandler.isPressed(o.keyCodes.KEY_Z)||this._keyboardHandler.isPressed(o.keyCodes.KEY_W))&&(this._movementFlag|=s.forward),this._keyboardHandler.isPressed(o.keyCodes.KEY_S)&&(this._movementFlag|=s.backward),(this._keyboardHandler.isPressed(o.keyCodes.KEY_A)||this._keyboardHandler.isPressed(o.keyCodes.KEY_Q))&&(this._movementFlag|=s.left),this._keyboardHandler.isPressed(o.keyCodes.KEY_D)&&(this._movementFlag|=s.right),this._keyboardHandler.isPressed(o.keyCodes.ARROW_UP)&&(this._phi+=this._keyboardSensivity*t),this._keyboardHandler.isPressed(o.keyCodes.ARROW_DOWN)&&(this._phi-=this._keyboardSensivity*t),this._keyboardHandler.isPressed(o.keyCodes.ARROW_LEFT)&&(this._theta+=this._keyboardSensivity*t),this._keyboardHandler.isPressed(o.keyCodes.ARROW_RIGHT)&&(this._theta-=this._keyboardSensivity*t),e==this._movementFlag&&r==this._phi&&n==this._theta||(this._timeImmobile=0)}}},{"./helpers/KeyboardHandler":18,"./helpers/PointerLockSetup":19,"gl-matrix":2}],17:[function(t,e,r){"use strict";var n,a,i;Object.defineProperty(r,"__esModule",{value:!0}),(i=n=n||{})[i.Right=0]="Right",i[i.Left=1]="Left",i[i.Bottom=2]="Bottom",i[i.Top=3]="Top",i[i.Back=4]="Back",i[i.Front=5]="Front",(i=a=a||{})[i.A=0]="A",i[i.B=1]="B",i[i.C=2]="C",i[i.D=3]="D";r.default=class{constructor(){this._frustum=new Float32Array(24)}normalizePlane(t){var e=4*t,t=Math.sqrt(this._frustum[e+a.A]*this._frustum[e+a.A]+this._frustum[e+a.B]*this._frustum[e+a.B]+this._frustum[e+a.C]*this._frustum[e+a.C]);this._frustum[e+a.A]/=t,this._frustum[e+a.B]/=t,this._frustum[e+a.C]/=t,this._frustum[e+a.D]/=t}calculateFrustum(t,e){const r=new Float32Array(16);r[0]=e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12],r[1]=e[0]*t[1]+e[1]*t[5]+e[2]*t[9]+e[3]*t[13],r[2]=e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+e[3]*t[14],r[3]=e[0]*t[3]+e[1]*t[7]+e[2]*t[11]+e[3]*t[15],r[4]=e[4]*t[0]+e[5]*t[4]+e[6]*t[8]+e[7]*t[12],r[5]=e[4]*t[1]+e[5]*t[5]+e[6]*t[9]+e[7]*t[13],r[6]=e[4]*t[2]+e[5]*t[6]+e[6]*t[10]+e[7]*t[14],r[7]=e[4]*t[3]+e[5]*t[7]+e[6]*t[11]+e[7]*t[15],r[8]=e[8]*t[0]+e[9]*t[4]+e[10]*t[8]+e[11]*t[12],r[9]=e[8]*t[1]+e[9]*t[5]+e[10]*t[9]+e[11]*t[13],r[10]=e[8]*t[2]+e[9]*t[6]+e[10]*t[10]+e[11]*t[14],r[11]=e[8]*t[3]+e[9]*t[7]+e[10]*t[11]+e[11]*t[15],r[12]=e[12]*t[0]+e[13]*t[4]+e[14]*t[8]+e[15]*t[12],r[13]=e[12]*t[1]+e[13]*t[5]+e[14]*t[9]+e[15]*t[13],r[14]=e[12]*t[2]+e[13]*t[6]+e[14]*t[10]+e[15]*t[14],r[15]=e[12]*t[3]+e[13]*t[7]+e[14]*t[11]+e[15]*t[15];t=4*n.Right;this._frustum[t+a.A]=r[3]-r[0],this._frustum[t+a.B]=r[7]-r[4],this._frustum[t+a.C]=r[11]-r[8],this._frustum[t+a.D]=r[15]-r[12],this.normalizePlane(n.Right),t=4*n.Left,this._frustum[t+a.A]=r[3]+r[0],this._frustum[t+a.B]=r[7]+r[4],this._frustum[t+a.C]=r[11]+r[8],this._frustum[t+a.D]=r[15]+r[12],this.normalizePlane(n.Left),t=4*n.Bottom,this._frustum[t+a.A]=r[3]+r[1],this._frustum[t+a.B]=r[7]+r[5],this._frustum[t+a.C]=r[11]+r[9],this._frustum[t+a.D]=r[15]+r[13],this.normalizePlane(n.Bottom),t=4*n.Top,this._frustum[t+a.A]=r[3]-r[1],this._frustum[t+a.B]=r[7]-r[5],this._frustum[t+a.C]=r[11]-r[9],this._frustum[t+a.D]=r[15]-r[13],this.normalizePlane(n.Top),t=4*n.Back,this._frustum[t+a.A]=r[3]-r[2],this._frustum[t+a.B]=r[7]-r[6],this._frustum[t+a.C]=r[11]-r[10],this._frustum[t+a.D]=r[15]-r[14],this.normalizePlane(n.Back),t=4*n.Front,this._frustum[t+a.A]=r[3]+r[2],this._frustum[t+a.B]=r[7]+r[6],this._frustum[t+a.C]=r[11]+r[10],this._frustum[t+a.D]=r[15]+r[14],this.normalizePlane(n.Front)}sphereInFrustum(e,r,n,i){for(let t=0;t<6;++t)if(this._frustum[4*t+a.A]*e+this._frustum[4*t+a.B]*r+this._frustum[4*t+a.C]*n+this._frustum[4*t+a.D]<=i)return!1;return!0}pointInFrustum(t,e,r){return this.sphereInFrustum(t,e,r,0)}cubeInFrustum(e,r,n,i){for(let t=0;t<6;++t){var o=4*t;if(!(0<this._frustum[o+a.A]*(e-i)+this._frustum[o+a.B]*(r-i)+this._frustum[o+a.C]*(n-i)+this._frustum[o+a.D])&&!(0<this._frustum[o+a.A]*(e+i)+this._frustum[o+a.B]*(r-i)+this._frustum[o+a.C]*(n-i)+this._frustum[o+a.D]||0<this._frustum[o+a.A]*(e-i)+this._frustum[o+a.B]*(r+i)+this._frustum[o+a.C]*(n-i)+this._frustum[o+a.D]||0<this._frustum[o+a.A]*(e+i)+this._frustum[o+a.B]*(r+i)+this._frustum[o+a.C]*(n-i)+this._frustum[o+a.D]||0<this._frustum[o+a.A]*(e-i)+this._frustum[o+a.B]*(r-i)+this._frustum[o+a.C]*(n+i)+this._frustum[o+a.D]||0<this._frustum[o+a.A]*(e+i)+this._frustum[o+a.B]*(r-i)+this._frustum[o+a.C]*(n+i)+this._frustum[o+a.D]||0<this._frustum[o+a.A]*(e-i)+this._frustum[o+a.B]*(r+i)+this._frustum[o+a.C]*(n+i)+this._frustum[o+a.D]||0<this._frustum[o+a.A]*(e+i)+this._frustum[o+a.B]*(r+i)+this._frustum[o+a.C]*(n+i)+this._frustum[o+a.D]))return!1}return!0}}},{}],18:[function(t,e,r){"use strict";var n,i;Object.defineProperty(r,"__esModule",{value:!0}),r.KeyboardHandler=r.keyCodes=void 0,(i=n=n||{}).KEY_Z="z",i.KEY_W="w",i.KEY_S="s",i.KEY_A="a",i.KEY_Q="q",i.KEY_D="d",i.ARROW_LEFT="ArrowLeft",i.ARROW_RIGHT="ArrowRight",i.ARROW_UP="ArrowUp",i.ARROW_DOWN="ArrowDown",r.keyCodes=n;r.KeyboardHandler=class{constructor(){this._pressedKeys=new Map,this._activated=!1;const e=[n.ARROW_LEFT,n.ARROW_RIGHT,n.ARROW_UP,n.ARROW_DOWN];this._activated=!1,this._handleKeyDown=(t=>{-1!=e.indexOf(t.key)&&t.preventDefault(),this._pressedKeys.set(t.key,!0)}).bind(this),this._handleKeyUp=(t=>{-1!=e.indexOf(t.key)&&t.preventDefault(),this._pressedKeys.set(t.key,!1)}).bind(this)}isPressed(t){return this._pressedKeys.get(t)||!1}activate(){this._activated||(document.addEventListener("keydown",this._handleKeyDown),document.addEventListener("keyup",this._handleKeyUp),this._activated=!0)}deactivate(){this._activated&&(document.removeEventListener("keydown",this._handleKeyDown),document.removeEventListener("keyup",this._handleKeyUp),this._activated=!1)}}},{}],19:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=e=>{e.targetElement.requestPointerLock=e.targetElement.requestPointerLock||e.targetElement.mozRequestPointerLock||e.targetElement.webkitRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,e.targetElement.onclick=()=>{e.targetElement.requestPointerLock&&e.targetElement.requestPointerLock()};var t=()=>{document.pointerLockElement===e.targetElement||document.mozPointerLockElement===e.targetElement||document.webkitPointerLockElement===e.targetElement?(console.log("The pointer lock status is now locked"),e.enabledCallback()):(console.log("The pointer lock status is now unlocked"),e.disabledCallback())},r=t=>{console.error("Pointer lock failed"),console.error(t),e.errorCallback&&e.errorCallback(t)};"onpointerlockchange"in document?document.addEventListener("pointerlockchange",t,!1):"onmozpointerlockchange"in document?document.addEventListener("mozpointerlockchange",t,!1):"onwebkitpointerlockchange"in document&&document.addEventListener("webkitpointerlockchange",t,!1),"onpointerlockerror"in document?document.addEventListener("pointerlockerror",r,!1):"onmozpointerlockerror"in document?document.addEventListener("mozpointerlockerror",r,!1):"onwebkitpointerlockerror"in document&&document.addEventListener("webkitpointerlockerror",r,!1)}},{}],20:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const a=t("gl-matrix");r.default=(t,e,r,n)=>{var i=a.vec4.fromValues(t[0],t[1],t[2],1),t=a.mat4.create();const o=a.vec4.create();return a.mat4.multiply(t,r,e),a.vec4.transformMat4(o,i,t),0===o[3]?null:(o[3]=1/o[3],o[0]*=o[3],o[1]*=o[3],o[2]*=o[3],[(.5*o[0]+.5)*n[2]+n[0],(.5*o[1]+.5)*n[3]+n[1]])}},{"gl-matrix":2}],21:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fragment=r.vertex=void 0;r.vertex=`

attribute vec3 a_vertexPosition;
attribute vec3 a_vertexColor;

varying vec4 v_color;

uniform mat4 u_modelviewMatrix;
uniform mat4 u_projMatrix;

void main(void)
{
    v_color = vec4(a_vertexColor,1.0);

    gl_Position = u_projMatrix * u_modelviewMatrix * vec4(a_vertexPosition, 1.0);
}
`;r.fragment=`

precision mediump float;

varying vec4 v_color;

void main(void)
{
    gl_FragColor = v_color;
}
`},{}],22:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.color=t("./color"),r.scene=t("./scene"),r.text=t("./text")},{"./color":21,"./scene":23,"./text":24}],23:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fragment=r.vertex=void 0;r.vertex=`

attribute vec3 a_vertexPosition;
attribute vec3 a_vertexColor;
attribute vec3 a_vertexNormal;
attribute vec3 a_vertexBCenter;

uniform mat4 u_modelviewMatrix;
uniform mat4 u_projMatrix;
uniform vec3 u_cameraPos;

varying vec3 v_color;

// lighting
varying vec3 v_normalInterp;
varying vec3 v_vertPos;
// lighting

// wireframe
varying float v_distanceToCamera;
varying vec3  v_baryCenter;
// wireframe

// texturing
varying vec3 v_pureVertexPos;
varying vec3 v_pureNormalInterp;
// texturing

const float k_rangeMin = 20.0;
const float k_rangeMax = 23.0;

void main(void)
{
    vec4 vertPos4 = u_modelviewMatrix * vec4(a_vertexPosition, 1.0);
    v_vertPos = vec3(vertPos4) / vertPos4.w;
    v_normalInterp = vec3(u_modelviewMatrix * vec4(a_vertexNormal, 0.0));

    v_pureVertexPos = a_vertexPosition;
    v_pureNormalInterp = a_vertexNormal;

    float distanceToCamera = length(a_vertexPosition - u_cameraPos);

    v_distanceToCamera = distanceToCamera;

    v_color = a_vertexColor;
    v_baryCenter = a_vertexBCenter;

    if (distanceToCamera < k_rangeMin ||
        distanceToCamera > k_rangeMax)
    {
        gl_Position = u_projMatrix * u_modelviewMatrix * vec4(a_vertexPosition, 1.0);
    }
    else
    {
        // bump effect -> bump in the direction of the normal

        gl_Position = u_projMatrix * u_modelviewMatrix * vec4(a_vertexPosition + a_vertexNormal, 1.0);
    }
}
`;r.fragment=`

precision mediump float;

uniform sampler2D u_sampler;

varying vec3 v_color;

// lighting
varying vec3 v_normalInterp;
varying vec3 v_vertPos;
// lighting

// wireframe
varying float v_distanceToCamera;
varying vec3  v_baryCenter;
// wireframe

// texturing
varying vec3 v_pureVertexPos;
varying vec3 v_pureNormalInterp;
// texturing

const vec3 k_lightPos = vec3(0.0,0.0,0.0);
const vec3 k_specColor = vec3(1.0, 1.0, 1.0);

const float k_rangeMin = 20.0;
const float k_rangeMax = 23.0;

void main(void)
{

    { // wireframe

        if (gl_FrontFacing)
        {
            // "bumped wireframe" effect on the front facing

            if (v_distanceToCamera > k_rangeMin &&
                v_distanceToCamera < k_rangeMax)
            {
                if (all(greaterThan(v_baryCenter, vec3(0.03))) &&
                    any(lessThan(v_baryCenter, vec3(0.08))))
                {
                    gl_FragColor = vec4(v_color, 1.0);
                    return;
                }
            }
        }
        else
        {
            // normal wireframe effect on the back facing

            if (any(lessThan(v_baryCenter, vec3(0.06))))
            {
                gl_FragColor = vec4(1);
                return;
            }
            else
            {
                // discard what is not part fo the wireframe
                discard;
            }
        }

    } // /wireframe

    vec3 currentColor = vec3(1);

    { // texture

        // current 3d texture coordinate
        vec3 flooredPos = vec3(
            v_pureVertexPos.x - floor(v_pureVertexPos.x),
            v_pureVertexPos.y - floor(v_pureVertexPos.y),
            v_pureVertexPos.z - floor(v_pureVertexPos.z)
        );

        vec3 blendWeights = abs( normalize( v_pureNormalInterp.xyz ) );
        blendWeights = max( ( blendWeights - 0.2 ) * 7.0, 0.0 );
        blendWeights /= ( blendWeights.x + blendWeights.y + blendWeights.z );

        // horizontal texture coordinates -> should be a wall
        vec2 texCoordX = vec2(flooredPos.y * 0.5 + 0.5, flooredPos.z * 0.5);
        vec2 texCoordY = vec2(flooredPos.x * 0.5 + 0.5, flooredPos.z * 0.5);

        // vertical texture coord -> should be green grass
        vec2 texCoordZ = vec2(flooredPos.x * 0.5, flooredPos.y * 0.5 + 0.5);

        if (v_pureNormalInterp.z < 0.0)
        {
            // switch the texture Y -> dirt on the ceilling instead of grass
            texCoordZ.y -= 0.5;
        }

        // horizontal color
        vec3 texColorX = texture2D( u_sampler, texCoordX ).rgb;
        vec3 texColorY = texture2D( u_sampler, texCoordY ).rgb;

        // vertical color
        vec3 texColorZ = texture2D( u_sampler, texCoordZ ).rgb;

        currentColor = texColorX * blendWeights.xxx +
                       texColorY * blendWeights.yyy +
                       texColorZ * blendWeights.zzz;

    } // texture

    { // lighting

        vec3 normal = normalize(v_normalInterp);
        vec3 lightDir = normalize(k_lightPos - v_vertPos);

        float lambertian = max(dot(lightDir,v_normalInterp.xyz), 0.0);
        float specular = 0.0;

        if (lambertian > 0.0)
        {
            // specular

            vec3 reflectDir = reflect(-lightDir, normal);
            vec3 viewDir = normalize(-v_vertPos);

            float specAngle = max(dot(reflectDir, viewDir), 0.0);
            specular = pow(specAngle, 16.0);
        }

        vec3 ambiantColor = currentColor.xyz * 0.05;
        vec3 diffuseColor = currentColor.xyz * lambertian;
        vec3 specularColor = k_specColor * specular;

        currentColor = ambiantColor + diffuseColor + specularColor;

    } // lighting

    gl_FragColor = vec4(currentColor, 1.0);
}
`},{}],24:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fragment=r.vertex=void 0;r.vertex=`

precision mediump float;

uniform mat4 u_modelviewMatrix;
uniform mat4 u_projectionMatrix;


attribute vec2 a_position;
attribute vec2 a_texCoord;
attribute vec2 a_offsetPosition;
attribute vec2 a_offsetTexCoord;
attribute float a_offsetScale;

varying vec2 v_texCoord;

void main(void)
{
    vec2 position = a_position * a_offsetScale + a_offsetPosition;

    gl_Position = u_projectionMatrix * u_modelviewMatrix * vec4(position, 0.0, 1.0);

    v_texCoord = a_texCoord + a_offsetTexCoord;
}
`;r.fragment=`

precision mediump float;

uniform sampler2D u_texture;

varying vec2 v_texCoord;

void main(void)
{
    gl_FragColor = texture2D(u_texture, v_texCoord);
}

`},{}],25:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=(t,e,r=!1)=>{var n=t/2,t=t/2.1,i=[n,n,n,-n,n,n,n,-n,n,-n,-n,n,n,n,-n,-n,n,-n,n,-n,-n,-n,-n,-n,t,t,t,-t,t,t,t,-t,t,-t,-t,t,t,t,-t,-t,t,-t,t,-t,-t,-t,-t,-t];const o=[0,1,1,3,3,2,2,0,4,5,5,7,7,6,6,4,0,4,1,5,3,7,2,6,8,9,9,11,11,10,10,8,12,13,13,15,15,14,14,12,8,12,9,13,11,15,10,14];r&&(o.length/=2);const a=[];for(let t=0;t<o.length;++t){var s=3*o[t];for(let t=0;t<3;++t)a.push(i[s+t]+n);for(let t=0;t<3;++t)a.push(e[t])}return a}},{}],26:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.default=(t,e,r,n)=>{var i=Math.tan(t/360*Math.PI)*r,o=i*e,a=-o,s=+o,o=+i,i=-i,t=n*Math.sin(t*Math.PI/180),e=t*e,u=[r,a,o,r,s,o,r,a,i,r,s,i,n,-e,+t,n,+e,+t,n,-e,-t,n,+e,-t,n,1.66*-e,-t,n,1.66*-e,+t],c=[0,1,1,3,3,2,2,0,0,4,1,5,2,6,3,7,4,5,5,7,7,6,6,4,8,9,7,8,5,9];const h=[];for(let t=0;t<c.length;++t){var f=3*c[t];for(let t=0;t<3;++t)h.push(u[f+t]);h.push(1,1,0)}return h}},{}],27:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const p=t("./WebGLContext");var n;!function(m){m.BytesPerPixel=4;let _;var t;(t=_=m.AttributeType||(m.AttributeType={}))[t.float=0]="float",t[t.vec2f=1]="vec2f",t[t.vec3f=2]="vec3f",t[t.vec4f=3]="vec4f",t[t.mat3f=4]="mat3f",t[t.mat4f=5]="mat4f";let v;(t=v=m.PrimitiveType||(m.PrimitiveType={}))[t.lines=0]="lines",t[t.triangles=1]="triangles";m.Geometry=class{constructor(t,e){this._primitiveStart=0,this._primitiveCount=0,this._instanceCount=0,this._isInstanced=!1;const i=p.default.getContext();if(0===e.vbos.length)throw new Error("empty vbo defintion");for(const n of e.vbos){if(0===n.attrs.length)throw new Error("empty vbo attribute defintion");for(const h of n.attrs)if(!t.hasAttribute(h.name))throw new Error(`attribute not found, name="${h.name}"`)}switch((this._def=e).primitiveType){case v.lines:this._primitiveType=i.LINES;break;case v.triangles:this._primitiveType=i.TRIANGLES;break;default:throw new Error("primitive type not found")}const r=p.default.getExtensionVaoStrict(),o=p.default.getExtensionInstancingStrict();e=r.createVertexArrayOES();if(!e)throw new Error("fail o create a vao unit");this._vao=e,r.bindVertexArrayOES(this._vao),this._vbos=[];for(const f of this._def.vbos){var a=i.createBuffer();if(!a)throw new Error("fail o create a vbo unit");this._vbos.push(a),i.bindBuffer(i.ARRAY_BUFFER,a);let n=f.stride||0;if(!n){for(const l of f.attrs)switch(l.type){case _.float:n+=1;break;case _.vec2f:n+=2;break;case _.vec3f:n+=3;break;case _.vec4f:n+=4;break;case _.mat3f:n+=9;break;case _.mat4f:n+=16}n*=m.BytesPerPixel}for(const d of f.attrs){let e=1,r=1;switch(d.type){case _.float:e=1,r=1;break;case _.vec2f:e=2,r=1;break;case _.vec3f:e=3,r=1;break;case _.vec4f:e=4,r=1;break;case _.mat3f:e=3,r=3;break;case _.mat4f:e=4,r=4}var s=t.getAttribute(d.name);for(let t=0;t<r;++t){var u=s+t,c=(d.index+t*e)*m.BytesPerPixel;i.enableVertexAttribArray(u),i.vertexAttribPointer(u,e,i.FLOAT,!1,n,c),!0===f.instanced&&(o.vertexAttribDivisorANGLE(u,1),this._isInstanced=!0)}}}r.bindVertexArrayOES(null)}dispose(){const e=p.default.getContext(),t=p.default.getExtensionVaoStrict();for(let t=0;t<this._vbos.length;++t)e.deleteBuffer(this._vbos[t]);t.deleteVertexArrayOES(this._vao)}updateBuffer(t,e,r=!1){if(t<0||t>=this._vbos.length)throw new Error("no buffer avaialble to tha index");const n=p.default.getContext();t=this._vbos[t],e=e instanceof Float32Array?e:new Float32Array(e),r=r?n.DYNAMIC_DRAW:n.STATIC_DRAW;n.bindBuffer(n.ARRAY_BUFFER,t),n.bufferData(n.ARRAY_BUFFER,e,r),n.bindBuffer(n.ARRAY_BUFFER,null)}render(){if(!(0==this._primitiveCount||this._isInstanced&&0==this._instanceCount)){const t=p.default.getContext(),e=p.default.getExtensionVaoStrict(),r=p.default.getExtensionInstancingStrict();e.bindVertexArrayOES(this._vao),!0===this._isInstanced?r.drawArraysInstancedANGLE(this._primitiveType,this._primitiveStart,this._primitiveCount,this._instanceCount):t.drawArrays(this._primitiveType,this._primitiveStart,this._primitiveCount),e.bindVertexArrayOES(null)}}setPrimitiveStart(t){this._primitiveStart=t}setPrimitiveCount(t){this._primitiveCount=t}setInstancedCount(t){this._instanceCount=t}}}(n=n||{}),r.default=n},{"./WebGLContext":30}],28:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const o=t("./WebGLContext");class a{constructor(t){this._attributes=new Map,this._uniforms=new Map;const e=o.default.getContext();var r=this._getShader(t.vertexSrc,e.VERTEX_SHADER),n=this._getShader(t.fragmentSrc,e.FRAGMENT_SHADER),i=e.createProgram();if(!i)throw new Error("could not create a shader program");if(e.attachShader(i,r),e.attachShader(i,n),e.linkProgram(i),e.deleteShader(r),e.deleteShader(n),!e.getProgramParameter(i,e.LINK_STATUS)){n=e.getProgramInfoLog(i);throw new Error("Failed to initialised shaders, Error linking:"+n)}this._program=i,this.bind(),this._getAttributes(t.attributes),this._getUniforms(t.uniforms),a.unbind()}bind(){const t=o.default.getContext();t.useProgram(this._program)}static unbind(){const t=o.default.getContext();t.useProgram(null)}hasAttribute(t){return this._attributes.has(t)}getAttribute(t){var e=this._attributes.get(t);if(void 0===e)throw new Error(`attribute not found: ${t}`);return e}getUniform(t){var e=this._uniforms.get(t);if(void 0===e)throw new Error(`uniform not found: ${t}`);return e}_getAttributes(e){const r=o.default.getContext();for(let t=0;t<e.length;++t){var n=r.getAttribLocation(this._program,e[t]);if(n<0)throw new Error(`attribute not found => ${e[t]}`);this._attributes.set(e[t],n)}}_getUniforms(e){const r=o.default.getContext();for(let t=0;t<e.length;++t){var n=r.getUniformLocation(this._program,e[t]);if(null===n)throw new Error(`uniform not found => ${e[t]}`);this._uniforms.set(e[t],n)}}_getShader(t,e){const r=o.default.getContext();e=r.createShader(e);if(!e)throw new Error("could not create a shader");if(r.shaderSource(e,t),r.compileShader(e),r.getShaderParameter(e,r.COMPILE_STATUS))return e;{let t=r.getShaderInfoLog(e);throw t=t||"failed to compile a shader",new Error(t)}}}r.default=a},{"./WebGLContext":30}],29:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});const n=t("./WebGLContext");r.default=class{constructor(){this._width=0,this._height=0,this._texture=null}async load(t,i=!1){const o=n.default.getContext();this._texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this._texture);const a=o.RGBA;const s=o.RGBA,u=o.UNSIGNED_BYTE;var e=new Uint8Array([0,0,255,255]);return o.texImage2D(o.TEXTURE_2D,0,a,1,1,0,s,u,e),o.bindTexture(o.TEXTURE_2D,null),new Promise((e,r)=>{const n=new Image;n.onerror=t=>{r(t)},n.onload=()=>{this._width=n.width,this._height=n.height,o.bindTexture(o.TEXTURE_2D,this._texture),o.texImage2D(o.TEXTURE_2D,0,a,s,u,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE);var t=i?o.NEAREST:o.LINEAR;o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t),o.bindTexture(o.TEXTURE_2D,null),e()},n.src=t})}getWidth(){if(!this._texture)throw new Error("texture not initialised");return this._width}getHeight(){if(!this._texture)throw new Error("texture not initialised");return this._height}bind(){if(!this._texture)throw new Error("texture not initialised");const t=n.default.getContext();t.bindTexture(t.TEXTURE_2D,this._texture)}static unbind(){const t=n.default.getContext();t.bindTexture(t.TEXTURE_2D,null)}}},{"./WebGLContext":30}],30:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});class n{static initialise(t){if(n._gl=t.getContext("webgl",{alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,powerPreference:"high-performance",premultipliedAlpha:!0,preserveDrawingBuffer:!0,stencil:!1}),!n._gl)throw new Error("could not create webgl context");n._extensionVAO=n._gl.getExtension("OES_vertex_array_object")||n._gl.getExtension("MOZ_OES_vertex_array_object")||n._gl.getExtension("WEBKIT_OES_vertex_array_object"),n._extensionLoseContext=n._gl.getExtension("WEBGL_lose_context"),n._extensionInstancing=n._gl.getExtension("ANGLE_instanced_arrays"),n._viewportSize[0]=t.clientWidth,n._viewportSize[1]=t.clientHeight}static getContext(){if(!n._gl)throw new Error("webgl context not initialised");return n._gl}static getExtensionVao(){return n._extensionVAO}static getExtensionLoseContext(){return n._extensionLoseContext}static getExtensionInstancing(){return n._extensionInstancing}static getExtensionVaoStrict(){if(!n._extensionVAO)throw new Error("vao extension not available");return n._extensionVAO}static getExtensionLoseContextStrict(){if(!n._extensionLoseContext)throw new Error("lose context extension not available");return n._extensionLoseContext}static getExtensionInstancingStrict(){if(!n._extensionInstancing)throw new Error("instancing extension not available");return n._extensionInstancing}static getViewportSize(){return n._viewportSize}}n._gl=null,n._extensionVAO=null,n._extensionLoseContext=null,n._extensionInstancing=null,n._viewportSize=[0,0],r.default=n},{}],31:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),window.onerror=(...t)=>{alert(JSON.stringify(t))};const n=t("./experiment/WebGLExperiment");(async()=>{const t=new n.default;await t.init(),t.start();{const e=document.getElementById("touch_id");e&&("ontouchstart"in window?e.innerHTML+="Supported":e.innerHTML+="Not Supported")}{const r=document.getElementById("gui_toggle_start");if(!r)throw new Error("gui_toggle_start not found");r.addEventListener("click",()=>{console.log("toggle_start"),t.isRunning()?t.stop():t.start()})}})()},{"./experiment/WebGLExperiment":13}]},{},[31]);